var rs=Object.defineProperty,ss=Object.defineProperties;var as=Object.getOwnPropertyDescriptors;var sn=Object.getOwnPropertySymbols;var os=Object.prototype.hasOwnProperty,ls=Object.prototype.propertyIsEnumerable;var an=(t,e,i)=>e in t?rs(t,e,{enumerable:!0,configurable:!0,writable:!0,value:i}):t[e]=i,z=(t,e)=>{for(var i in e||(e={}))os.call(e,i)&&an(t,i,e[i]);if(sn)for(var i of sn(e))ls.call(e,i)&&an(t,i,e[i]);return t},ee=(t,e)=>ss(t,as(e));import{S as it,i as tt,s as nt,e as we,c as Ee,a as ze,d as ue,b as de,g as je,E as li,M as us,v as Zn,N as Fe,t as jn,h as Gn,H as Pe,j as cs,D as Et,l as on,n as rt,o as ve,p as st,q as he,O as Hn,P as si,w as Gi,x as Hi,y as Bi,Q as ai,B as Wi,k as $t,m as Zt,R as wi,T as hs,U as Ui,V as ms,W as Bn,X as fs,Y as gs}from"../chunks/index-d2e8412a.js";import{w as ps}from"../chunks/index-019b6704.js";function ds(t){let e,i;return{c(){e=we("span"),this.h()},l(n){e=Ee(n,"SPAN",{class:!0,style:!0}),ze(e).forEach(ue),this.h()},h(){de(e,"class",t[1]),de(e,"style",i=t[0]?"border: none; outline: none; box-shadow: none;":"")},m(n,r){je(n,e,r),t[16](e)},p(n,[r]){r&2&&de(e,"class",n[1]),r&1&&i!==(i=n[0]?"border: none; outline: none; box-shadow: none;":"")&&de(e,"style",i)},i:li,o:li,d(n){n&&ue(e),t[16](null)}}}function bs(t,e,i){let n;const r=us();let s,{autofocus:u=!1}=e,{latex:o}=e,{noBorderOutline:a=!1}=e,{focused:l=u}=e,{class:h=""}=e,{config:d={}}=e,y;const N=()=>y==null?void 0:y.focus(),x=()=>y==null?void 0:y.blur(),k=()=>y==null?void 0:y.reflow(),M=()=>y==null?void 0:y.select(),P=()=>y==null?void 0:y.clearSelection(),I=C=>y==null?void 0:y.keystroke(C),D=C=>y==null?void 0:y.typedText(C);Zn(()=>{const C=globalThis.MathQuill.getInterface(2),j=$=>$==C.L?"L":"R";i(14,y=C.MathField(s,ee(z({},n),{substituteTextarea(){const $=document.createElement("textarea");return $.addEventListener("focus",()=>i(4,l=!0)),$.addEventListener("blur",()=>i(4,l=!1)),$.setAttribute("autocorrect","false"),$},handlers:{edit(){r("edit",y.latex()),i(3,o=y.latex())},upOutOf(){r("upOutOf"),r("outOf","U"),r("outOfOnly","U")},downOutOf(){r("downOutOf"),r("outOf","D"),r("outOfOnly","D")},moveOutOf($){r("moveOutOf",j($)),r("outOf",j($)),r("outOfOnly",j($))},selectOutOf($){r("selectOutOf",j($)),r("outOf",j($)),r("outOfOnly",j($))},deleteOutOf($){r("deleteOutOf",j($)),r("outOf",j($))},enter(){r("enter")}}}))),u&&y.focus()});function V(C){Fe[C?"unshift":"push"](()=>{s=C,i(2,s)})}return t.$$set=C=>{"autofocus"in C&&i(5,u=C.autofocus),"latex"in C&&i(3,o=C.latex),"noBorderOutline"in C&&i(0,a=C.noBorderOutline),"focused"in C&&i(4,l=C.focused),"class"in C&&i(1,h=C.class),"config"in C&&i(6,d=C.config)},t.$$.update=()=>{t.$$.dirty&64&&i(15,n=Object.fromEntries(Object.entries(d).filter(([C,j])=>j))),t.$$.dirty&16392&&y&&y.latex()!==o&&y.latex(o),t.$$.dirty&49216&&n&&y&&y.config(d)},[a,h,s,o,l,u,d,N,x,k,M,P,I,D,y,n,V]}class vs extends it{constructor(e){super(),tt(this,e,bs,ds,nt,{autofocus:5,latex:3,noBorderOutline:0,focused:4,class:1,config:6,focus:7,blur:8,reflow:9,select:10,clearSelection:11,keystroke:12,typedText:13})}get focus(){return this.$$.ctx[7]}get blur(){return this.$$.ctx[8]}get reflow(){return this.$$.ctx[9]}get select(){return this.$$.ctx[10]}get clearSelection(){return this.$$.ctx[11]}get keystroke(){return this.$$.ctx[12]}get typedText(){return this.$$.ctx[13]}}function ys(t){let e,i;return{c(){e=we("span"),i=jn(t[0])},l(n){e=Ee(n,"SPAN",{});var r=ze(e);i=Gn(r,t[0]),r.forEach(ue)},m(n,r){je(n,e,r),Pe(e,i),t[2](e)},p(n,[r]){r&1&&cs(i,n[0])},i:li,o:li,d(n){n&&ue(e),t[2](null)}}}function Ns(t,e,i){let n,r,s,{latex:u=""}=e;Zn(()=>{r=globalThis.MathQuill.getInterface(2),u&&o()});function o(){if(u==""){s==null||s.revert();return}s&&s.revert(),s=r==null?void 0:r.StaticMath(n)}function a(l){Fe[l?"unshift":"push"](()=>{n=l,i(1,n)})}return t.$$set=l=>{"latex"in l&&i(0,u=l.latex)},t.$$.update=()=>{t.$$.dirty&1&&u!==void 0&&Et().then(o)},[u,n,a]}class ln extends it{constructor(e){super(),tt(this,e,Ns,ys,nt,{latex:0})}}const xs=t=>{document.activeElement!==t&&t.focus()};function kt(t){return!("kind"in t)||t.kind==="symbol"}function Zi(t){return"kind"in t&&t.kind==="matchfix"}function ji(t){return"kind"in t&&t.kind==="infix"}function It(t){return"kind"in t&&t.kind==="prefix"}function At(t){return"kind"in t&&t.kind==="postfix"}function Wn(t){return"kind"in t&&t.kind==="environment"}var pt,_s=typeof globalThis!="undefined"?globalThis:typeof window!="undefined"?window:typeof global!="undefined"?global:typeof self!="undefined"?self:{},Q={exports:{}};pt=Q,function(t){var e,i,n,r,s=9e15,u=1e9,o="0123456789abcdef",a="2.3025850929940456840179914546843642076011014886287729760333279009675726096773524802359972050895982983419677840422862486334095254650828067566662873690987816894829072083255546808437998948262331985283935053089653777326288461633662222876982198867465436674744042432743651550489343149393914796194044002221051017141748003688084012647080685567743216228355220114804663715659121373450747856947683463616792101806445070648000277502684916746550586856935673420670581136429224554405758925724208241314695689016758940256776311356919292033376587141660230105703089634572075440370847469940168269282808481184289314848524948644871927809676271275775397027668605952496716674183485704422507197965004714951050492214776567636938662976979522110718264549734772662425709429322582798502585509785265383207606726317164309505995087807523710333101197857547331541421808427543863591778117054309827482385045648019095610299291824318237525357709750539565187697510374970888692180205189339507238539205144634197265287286965110862571492198849978748873771345686209167058",l="3.1415926535897932384626433832795028841971693993751058209749445923078164062862089986280348253421170679821480865132823066470938446095505822317253594081284811174502841027019385211055596446229489549303819644288109756659334461284756482337867831652712019091456485669234603486104543266482133936072602491412737245870066063155881748815209209628292540917153643678925903600113305305488204665213841469519415116094330572703657595919530921861173819326117931051185480744623799627495673518857527248912279381830119491298336733624406566430860213949463952247371907021798609437027705392171762931767523846748184676694051320005681271452635608277857713427577896091736371787214684409012249534301465495853710507922796892589235420199561121290219608640344181598136297747713099605187072113499999983729780499510597317328160963185950244594553469083026425223082533446850352619311881710100031378387528865875332083814206171776691473035982534904287554687311595628638823537875937519577818577805321712268066130019278766111959092164201989380952572010654858632789",h={precision:20,rounding:4,modulo:1,toExpNeg:-7,toExpPos:21,minE:-s,maxE:s,crypto:!1},d=!0,y="[DecimalError] ",N=y+"Invalid argument: ",x=y+"Precision limit exceeded",k=y+"crypto unavailable",M="[object Decimal]",P=Math.floor,I=Math.pow,D=/^0b([01]+(\.[01]*)?|\.[01]+)(p[+-]?\d+)?$/i,V=/^0x([0-9a-f]+(\.[0-9a-f]*)?|\.[0-9a-f]+)(p[+-]?\d+)?$/i,C=/^0o([0-7]+(\.[0-7]*)?|\.[0-7]+)(p[+-]?\d+)?$/i,j=/^(\d+(\.\d*)?|\.\d+)(e[+-]?\d+)?$/i,$=1e7,Mi=a.length-1,ot=l.length-1,F={toStringTag:M};function oe(c){var m,f,p,b=c.length-1,g="",v=c[0];if(b>0){for(g+=v,m=1;m<b;m++)(f=7-(p=c[m]+"").length)&&(g+=Ce(f)),g+=p;(f=7-(p=(v=c[m])+"").length)&&(g+=Ce(f))}else if(v===0)return"0";for(;v%10==0;)v/=10;return g+v}function me(c,m,f){if(c!==~~c||c<m||c>f)throw Error(N+c)}function hi(c,m,f,p){var b,g,v,_;for(g=c[0];g>=10;g/=10)--m;return--m<0?(m+=7,b=0):(b=Math.ceil((m+1)/7),m%=7),g=I(10,7-m),_=c[b]%g|0,p==null?m<3?(m==0?_=_/100|0:m==1&&(_=_/10|0),v=f<4&&_==99999||f>3&&_==49999||_==5e4||_==0):v=(f<4&&_+1==g||f>3&&_+1==g/2)&&(c[b+1]/g/100|0)==I(10,m-2)-1||(_==g/2||_==0)&&(c[b+1]/g/100|0)==0:m<4?(m==0?_=_/1e3|0:m==1?_=_/100|0:m==2&&(_=_/10|0),v=(p||f<4)&&_==9999||!p&&f>3&&_==4999):v=((p||f<4)&&_+1==g||!p&&f>3&&_+1==g/2)&&(c[b+1]/g/1e3|0)==I(10,m-3)-1,v}function Fi(c,m,f){for(var p,b,g=[0],v=0,_=c.length;v<_;){for(b=g.length;b--;)g[b]*=m;for(g[0]+=o.indexOf(c.charAt(v++)),p=0;p<g.length;p++)g[p]>f-1&&(g[p+1]===void 0&&(g[p+1]=0),g[p+1]+=g[p]/f|0,g[p]%=f)}return g.reverse()}F.absoluteValue=F.abs=function(){var c=new this.constructor(this);return c.s<0&&(c.s=1),L(c)},F.ceil=function(){return L(new this.constructor(this),this.e+1,2)},F.clampedTo=F.clamp=function(c,m){var f=this,p=f.constructor;if(c=new p(c),m=new p(m),!c.s||!m.s)return new p(NaN);if(c.gt(m))throw Error(N+m);return f.cmp(c)<0?c:f.cmp(m)>0?m:new p(f)},F.comparedTo=F.cmp=function(c){var m,f,p,b,g=this,v=g.d,_=(c=new g.constructor(c)).d,S=g.s,E=c.s;if(!v||!_)return S&&E?S!==E?S:v===_?0:!v^S<0?1:-1:NaN;if(!v[0]||!_[0])return v[0]?S:_[0]?-E:0;if(S!==E)return S;if(g.e!==c.e)return g.e>c.e^S<0?1:-1;for(m=0,f=(p=v.length)<(b=_.length)?p:b;m<f;++m)if(v[m]!==_[m])return v[m]>_[m]^S<0?1:-1;return p===b?0:p>b^S<0?1:-1},F.cosine=F.cos=function(){var c,m,f=this,p=f.constructor;return f.d?f.d[0]?(c=p.precision,m=p.rounding,p.precision=c+Math.max(f.e,f.sd())+7,p.rounding=1,f=function(b,g){var v,_,S;if(g.isZero())return g;(_=g.d.length)<32?S=""+1/Pi(4,v=Math.ceil(_/3)):(v=16,S="2.3283064365386962890625e-10"),b.precision+=v,g=We(b,1,g.times(S),new b(1));for(var E=v;E--;){var w=g.times(g);g=w.times(w).minus(w).times(8).plus(1)}return b.precision-=v,g}(p,tn(p,f)),p.precision=c,p.rounding=m,L(r==2||r==3?f.neg():f,c,m,!0)):new p(1):new p(NaN)},F.cubeRoot=F.cbrt=function(){var c,m,f,p,b,g,v,_,S,E,w=this,A=w.constructor;if(!w.isFinite()||w.isZero())return new A(w);for(d=!1,(g=w.s*I(w.s*w,1/3))&&Math.abs(g)!=1/0?p=new A(g.toString()):(f=oe(w.d),(g=((c=w.e)-f.length+1)%3)&&(f+=g==1||g==-2?"0":"00"),g=I(f,1/3),c=P((c+1)/3)-(c%3==(c<0?-1:2)),(p=new A(f=g==1/0?"5e"+c:(f=g.toExponential()).slice(0,f.indexOf("e")+1)+c)).s=w.s),v=(c=A.precision)+3;;)if(E=(S=(_=p).times(_).times(_)).plus(w),p=U(E.plus(w).times(_),E.plus(S),v+2,1),oe(_.d).slice(0,v)===(f=oe(p.d)).slice(0,v)){if((f=f.slice(v-3,v+1))!="9999"&&(b||f!="4999")){+f&&(+f.slice(1)||f.charAt(0)!="5")||(L(p,c+1,1),m=!p.times(p).times(p).eq(w));break}if(!b&&(L(_,c+1,0),_.times(_).times(_).eq(w))){p=_;break}v+=4,b=1}return d=!0,L(p,c,A.rounding,m)},F.decimalPlaces=F.dp=function(){var c,m=this.d,f=NaN;if(m){if(f=7*((c=m.length-1)-P(this.e/7)),c=m[c])for(;c%10==0;c/=10)f--;f<0&&(f=0)}return f},F.dividedBy=F.div=function(c){return U(this,new this.constructor(c))},F.dividedToIntegerBy=F.divToInt=function(c){var m=this.constructor;return L(U(this,new m(c),0,1,1),m.precision,m.rounding)},F.equals=F.eq=function(c){return this.cmp(c)===0},F.floor=function(){return L(new this.constructor(this),this.e+1,3)},F.greaterThan=F.gt=function(c){return this.cmp(c)>0},F.greaterThanOrEqualTo=F.gte=function(c){var m=this.cmp(c);return m==1||m===0},F.hyperbolicCosine=F.cosh=function(){var c,m,f,p,b,g=this,v=g.constructor,_=new v(1);if(!g.isFinite())return new v(g.s?1/0:NaN);if(g.isZero())return _;f=v.precision,p=v.rounding,v.precision=f+Math.max(g.e,g.sd())+4,v.rounding=1,(b=g.d.length)<32?m=""+1/Pi(4,c=Math.ceil(b/3)):(c=16,m="2.3283064365386962890625e-10"),g=We(v,1,g.times(m),new v(1),!0);for(var S,E=c,w=new v(8);E--;)S=g.times(g),g=_.minus(S.times(w.minus(S.times(w))));return L(g,v.precision=f,v.rounding=p,!0)},F.hyperbolicSine=F.sinh=function(){var c,m,f,p,b=this,g=b.constructor;if(!b.isFinite()||b.isZero())return new g(b);if(m=g.precision,f=g.rounding,g.precision=m+Math.max(b.e,b.sd())+4,g.rounding=1,(p=b.d.length)<3)b=We(g,2,b,b,!0);else{c=(c=1.4*Math.sqrt(p))>16?16:0|c,b=We(g,2,b=b.times(1/Pi(5,c)),b,!0);for(var v,_=new g(5),S=new g(16),E=new g(20);c--;)v=b.times(b),b=b.times(_.plus(v.times(S.times(v).plus(E))))}return g.precision=m,g.rounding=f,L(b,m,f,!0)},F.hyperbolicTangent=F.tanh=function(){var c,m,f=this,p=f.constructor;return f.isFinite()?f.isZero()?new p(f):(c=p.precision,m=p.rounding,p.precision=c+7,p.rounding=1,U(f.sinh(),f.cosh(),p.precision=c,p.rounding=m)):new p(f.s)},F.inverseCosine=F.acos=function(){var c,m=this,f=m.constructor,p=m.abs().cmp(1),b=f.precision,g=f.rounding;return p!==-1?p===0?m.isNeg()?Ne(f,b,g):new f(0):new f(NaN):m.isZero()?Ne(f,b+4,g).times(.5):(f.precision=b+6,f.rounding=1,m=m.asin(),c=Ne(f,b+4,g).times(.5),f.precision=b,f.rounding=g,c.minus(m))},F.inverseHyperbolicCosine=F.acosh=function(){var c,m,f=this,p=f.constructor;return f.lte(1)?new p(f.eq(1)?0:NaN):f.isFinite()?(c=p.precision,m=p.rounding,p.precision=c+Math.max(Math.abs(f.e),f.sd())+4,p.rounding=1,d=!1,f=f.times(f).minus(1).sqrt().plus(f),d=!0,p.precision=c,p.rounding=m,f.ln()):new p(f)},F.inverseHyperbolicSine=F.asinh=function(){var c,m,f=this,p=f.constructor;return!f.isFinite()||f.isZero()?new p(f):(c=p.precision,m=p.rounding,p.precision=c+2*Math.max(Math.abs(f.e),f.sd())+6,p.rounding=1,d=!1,f=f.times(f).plus(1).sqrt().plus(f),d=!0,p.precision=c,p.rounding=m,f.ln())},F.inverseHyperbolicTangent=F.atanh=function(){var c,m,f,p,b=this,g=b.constructor;return b.isFinite()?b.e>=0?new g(b.abs().eq(1)?b.s/0:b.isZero()?b:NaN):(c=g.precision,m=g.rounding,p=b.sd(),Math.max(p,c)<2*-b.e-1?L(new g(b),c,m,!0):(g.precision=f=p-b.e,b=U(b.plus(1),new g(1).minus(b),f+c,1),g.precision=c+4,g.rounding=1,b=b.ln(),g.precision=c,g.rounding=m,b.times(.5))):new g(NaN)},F.inverseSine=F.asin=function(){var c,m,f,p,b=this,g=b.constructor;return b.isZero()?new g(b):(m=b.abs().cmp(1),f=g.precision,p=g.rounding,m!==-1?m===0?((c=Ne(g,f+4,p).times(.5)).s=b.s,c):new g(NaN):(g.precision=f+6,g.rounding=1,b=b.div(new g(1).minus(b.times(b)).sqrt().plus(1)).atan(),g.precision=f,g.rounding=p,b.times(2)))},F.inverseTangent=F.atan=function(){var c,m,f,p,b,g,v,_,S,E=this,w=E.constructor,A=w.precision,O=w.rounding;if(E.isFinite()){if(E.isZero())return new w(E);if(E.abs().eq(1)&&A+4<=ot)return(v=Ne(w,A+4,O).times(.25)).s=E.s,v}else{if(!E.s)return new w(NaN);if(A+4<=ot)return(v=Ne(w,A+4,O).times(.5)).s=E.s,v}for(w.precision=_=A+10,w.rounding=1,c=f=Math.min(28,_/7+2|0);c;--c)E=E.div(E.times(E).plus(1).sqrt().plus(1));for(d=!1,m=Math.ceil(_/7),p=1,S=E.times(E),v=new w(E),b=E;c!==-1;)if(b=b.times(S),g=v.minus(b.div(p+=2)),b=b.times(S),(v=g.plus(b.div(p+=2))).d[m]!==void 0)for(c=m;v.d[c]===g.d[c]&&c--;);return f&&(v=v.times(2<<f-1)),d=!0,L(v,w.precision=A,w.rounding=O,!0)},F.isFinite=function(){return!!this.d},F.isInteger=F.isInt=function(){return!!this.d&&P(this.e/7)>this.d.length-2},F.isNaN=function(){return!this.s},F.isNegative=F.isNeg=function(){return this.s<0},F.isPositive=F.isPos=function(){return this.s>0},F.isZero=function(){return!!this.d&&this.d[0]===0},F.lessThan=F.lt=function(c){return this.cmp(c)<0},F.lessThanOrEqualTo=F.lte=function(c){return this.cmp(c)<1},F.logarithm=F.log=function(c){var m,f,p,b,g,v,_,S,E=this,w=E.constructor,A=w.precision,O=w.rounding;if(c==null)c=new w(10),m=!0;else{if(f=(c=new w(c)).d,c.s<0||!f||!f[0]||c.eq(1))return new w(NaN);m=c.eq(10)}if(f=E.d,E.s<0||!f||!f[0]||E.eq(1))return new w(f&&!f[0]?-1/0:E.s!=1?NaN:f?0:1/0);if(m)if(f.length>1)g=!0;else{for(b=f[0];b%10==0;)b/=10;g=b!==1}if(d=!1,v=De(E,_=A+5),p=m?qi(w,_+10):De(c,_),hi((S=U(v,p,_,1)).d,b=A,O))do if(v=De(E,_+=10),p=m?qi(w,_+10):De(c,_),S=U(v,p,_,1),!g){+oe(S.d).slice(b+1,b+15)+1==1e14&&(S=L(S,A+1,0));break}while(hi(S.d,b+=10,O));return d=!0,L(S,A,O)},F.minus=F.sub=function(c){var m,f,p,b,g,v,_,S,E,w,A,O,T=this,R=T.constructor;if(c=new R(c),!T.d||!c.d)return T.s&&c.s?T.d?c.s=-c.s:c=new R(c.d||T.s!==c.s?T:NaN):c=new R(NaN),c;if(T.s!=c.s)return c.s=-c.s,T.plus(c);if(E=T.d,O=c.d,_=R.precision,S=R.rounding,!E[0]||!O[0]){if(O[0])c.s=-c.s;else{if(!E[0])return new R(S===3?-0:0);c=new R(T)}return d?L(c,_,S):c}if(f=P(c.e/7),w=P(T.e/7),E=E.slice(),g=w-f){for((A=g<0)?(m=E,g=-g,v=O.length):(m=O,f=w,v=E.length),g>(p=Math.max(Math.ceil(_/7),v)+2)&&(g=p,m.length=1),m.reverse(),p=g;p--;)m.push(0);m.reverse()}else{for((A=(p=E.length)<(v=O.length))&&(v=p),p=0;p<v;p++)if(E[p]!=O[p]){A=E[p]<O[p];break}g=0}for(A&&(m=E,E=O,O=m,c.s=-c.s),v=E.length,p=O.length-v;p>0;--p)E[v++]=0;for(p=O.length;p>g;){if(E[--p]<O[p]){for(b=p;b&&E[--b]===0;)E[b]=$-1;--E[b],E[p]+=$}E[p]-=O[p]}for(;E[--v]===0;)E.pop();for(;E[0]===0;E.shift())--f;return E[0]?(c.d=E,c.e=Oi(E,f),d?L(c,_,S):c):new R(S===3?-0:0)},F.modulo=F.mod=function(c){var m,f=this,p=f.constructor;return c=new p(c),!f.d||!c.s||c.d&&!c.d[0]?new p(NaN):!c.d||f.d&&!f.d[0]?L(new p(f),p.precision,p.rounding):(d=!1,p.modulo==9?(m=U(f,c.abs(),0,3,1)).s*=c.s:m=U(f,c,0,p.modulo,1),m=m.times(c),d=!0,f.minus(m))},F.naturalExponential=F.exp=function(){return lt(this)},F.naturalLogarithm=F.ln=function(){return De(this)},F.negated=F.neg=function(){var c=new this.constructor(this);return c.s=-c.s,L(c)},F.plus=F.add=function(c){var m,f,p,b,g,v,_,S,E,w,A=this,O=A.constructor;if(c=new O(c),!A.d||!c.d)return A.s&&c.s?A.d||(c=new O(c.d||A.s===c.s?A:NaN)):c=new O(NaN),c;if(A.s!=c.s)return c.s=-c.s,A.minus(c);if(E=A.d,w=c.d,_=O.precision,S=O.rounding,!E[0]||!w[0])return w[0]||(c=new O(A)),d?L(c,_,S):c;if(g=P(A.e/7),p=P(c.e/7),E=E.slice(),b=g-p){for(b<0?(f=E,b=-b,v=w.length):(f=w,p=g,v=E.length),b>(v=(g=Math.ceil(_/7))>v?g+1:v+1)&&(b=v,f.length=1),f.reverse();b--;)f.push(0);f.reverse()}for((v=E.length)-(b=w.length)<0&&(b=v,f=w,w=E,E=f),m=0;b;)m=(E[--b]=E[b]+w[b]+m)/$|0,E[b]%=$;for(m&&(E.unshift(m),++p),v=E.length;E[--v]==0;)E.pop();return c.d=E,c.e=Oi(E,p),d?L(c,_,S):c},F.precision=F.sd=function(c){var m,f=this;if(c!==void 0&&c!==!!c&&c!==1&&c!==0)throw Error(N+c);return f.d?(m=Kt(f.d),c&&f.e+1>m&&(m=f.e+1)):m=NaN,m},F.round=function(){var c=this,m=c.constructor;return L(new m(c),c.e+1,m.rounding)},F.sine=F.sin=function(){var c,m,f=this,p=f.constructor;return f.isFinite()?f.isZero()?new p(f):(c=p.precision,m=p.rounding,p.precision=c+Math.max(f.e,f.sd())+7,p.rounding=1,f=function(b,g){var v,_=g.d.length;if(_<3)return g.isZero()?g:We(b,2,g,g);v=(v=1.4*Math.sqrt(_))>16?16:0|v,g=We(b,2,g=g.times(1/Pi(5,v)),g);for(var S,E=new b(5),w=new b(16),A=new b(20);v--;)S=g.times(g),g=g.times(E.plus(S.times(w.times(S).minus(A))));return g}(p,tn(p,f)),p.precision=c,p.rounding=m,L(r>2?f.neg():f,c,m,!0)):new p(NaN)},F.squareRoot=F.sqrt=function(){var c,m,f,p,b,g,v=this,_=v.d,S=v.e,E=v.s,w=v.constructor;if(E!==1||!_||!_[0])return new w(!E||E<0&&(!_||_[0])?NaN:_?v:1/0);for(d=!1,(E=Math.sqrt(+v))==0||E==1/0?(((m=oe(_)).length+S)%2==0&&(m+="0"),E=Math.sqrt(m),S=P((S+1)/2)-(S<0||S%2),p=new w(m=E==1/0?"5e"+S:(m=E.toExponential()).slice(0,m.indexOf("e")+1)+S)):p=new w(E.toString()),f=(S=w.precision)+3;;)if(p=(g=p).plus(U(v,g,f+2,1)).times(.5),oe(g.d).slice(0,f)===(m=oe(p.d)).slice(0,f)){if((m=m.slice(f-3,f+1))!="9999"&&(b||m!="4999")){+m&&(+m.slice(1)||m.charAt(0)!="5")||(L(p,S+1,1),c=!p.times(p).eq(v));break}if(!b&&(L(g,S+1,0),g.times(g).eq(v))){p=g;break}f+=4,b=1}return d=!0,L(p,S,w.rounding,c)},F.tangent=F.tan=function(){var c,m,f=this,p=f.constructor;return f.isFinite()?f.isZero()?new p(f):(c=p.precision,m=p.rounding,p.precision=c+10,p.rounding=1,(f=f.sin()).s=1,f=U(f,new p(1).minus(f.times(f)).sqrt(),c+10,0),p.precision=c,p.rounding=m,L(r==2||r==4?f.neg():f,c,m,!0)):new p(NaN)},F.times=F.mul=function(c){var m,f,p,b,g,v,_,S,E,w=this,A=w.constructor,O=w.d,T=(c=new A(c)).d;if(c.s*=w.s,!(O&&O[0]&&T&&T[0]))return new A(!c.s||O&&!O[0]&&!T||T&&!T[0]&&!O?NaN:O&&T?0*c.s:c.s/0);for(f=P(w.e/7)+P(c.e/7),(S=O.length)<(E=T.length)&&(g=O,O=T,T=g,v=S,S=E,E=v),g=[],p=v=S+E;p--;)g.push(0);for(p=E;--p>=0;){for(m=0,b=S+p;b>p;)_=g[b]+T[p]*O[b-p-1]+m,g[b--]=_%$|0,m=_/$|0;g[b]=(g[b]+m)%$|0}for(;!g[--v];)g.pop();return m?++f:g.shift(),c.d=g,c.e=Oi(g,f),d?L(c,A.precision,A.rounding):c},F.toBinary=function(c,m){return ct(this,2,c,m)},F.toDecimalPlaces=F.toDP=function(c,m){var f=this,p=f.constructor;return f=new p(f),c===void 0?f:(me(c,0,u),m===void 0?m=p.rounding:me(m,0,8),L(f,c+f.e+1,m))},F.toExponential=function(c,m){var f,p=this,b=p.constructor;return c===void 0?f=ke(p,!0):(me(c,0,u),m===void 0?m=b.rounding:me(m,0,8),f=ke(p=L(new b(p),c+1,m),!0,c+1)),p.isNeg()&&!p.isZero()?"-"+f:f},F.toFixed=function(c,m){var f,p,b=this,g=b.constructor;return c===void 0?f=ke(b):(me(c,0,u),m===void 0?m=g.rounding:me(m,0,8),f=ke(p=L(new g(b),c+b.e+1,m),!1,c+p.e+1)),b.isNeg()&&!b.isZero()?"-"+f:f},F.toFraction=function(c){var m,f,p,b,g,v,_,S,E,w,A,O,T=this,R=T.d,K=T.constructor;if(!R)return new K(T);if(E=f=new K(1),p=S=new K(0),v=(g=(m=new K(p)).e=Kt(R)-T.e-1)%7,m.d[0]=I(10,v<0?7+v:v),c==null)c=g>0?m:E;else{if(!(_=new K(c)).isInt()||_.lt(E))throw Error(N+_);c=_.gt(m)?g>0?m:E:_}for(d=!1,_=new K(oe(R)),w=K.precision,K.precision=g=7*R.length*2;A=U(_,m,0,1,1),(b=f.plus(A.times(p))).cmp(c)!=1;)f=p,p=b,b=E,E=S.plus(A.times(b)),S=b,b=m,m=_.minus(A.times(b)),_=b;return b=U(c.minus(f),p,0,1,1),S=S.plus(b.times(E)),f=f.plus(b.times(p)),S.s=E.s=T.s,O=U(E,p,g,1).minus(T).abs().cmp(U(S,f,g,1).minus(T).abs())<1?[E,p]:[S,f],K.precision=w,d=!0,O},F.toHexadecimal=F.toHex=function(c,m){return ct(this,16,c,m)},F.toNearest=function(c,m){var f=this,p=f.constructor;if(f=new p(f),c==null){if(!f.d)return f;c=new p(1),m=p.rounding}else{if(c=new p(c),m===void 0?m=p.rounding:me(m,0,8),!f.d)return c.s?f:c;if(!c.d)return c.s&&(c.s=f.s),c}return c.d[0]?(d=!1,f=U(f,c,0,m,1).times(c),d=!0,L(f)):(c.s=f.s,f=c),f},F.toNumber=function(){return+this},F.toOctal=function(c,m){return ct(this,8,c,m)},F.toPower=F.pow=function(c){var m,f,p,b,g,v,_=this,S=_.constructor,E=+(c=new S(c));if(!(_.d&&c.d&&_.d[0]&&c.d[0]))return new S(I(+_,E));if((_=new S(_)).eq(1))return _;if(p=S.precision,g=S.rounding,c.eq(1))return L(_,p,g);if((m=P(c.e/7))>=c.d.length-1&&(f=E<0?-E:E)<=9007199254740991)return b=Yt(S,_,f,p),c.s<0?new S(1).div(b):L(b,p,g);if((v=_.s)<0){if(m<c.d.length-1)return new S(NaN);if((1&c.d[m])==0&&(v=1),_.e==0&&_.d[0]==1&&_.d.length==1)return _.s=v,_}return(m=(f=I(+_,E))!=0&&isFinite(f)?new S(f+"").e:P(E*(Math.log("0."+oe(_.d))/Math.LN10+_.e+1)))>S.maxE+1||m<S.minE-1?new S(m>0?v/0:0):(d=!1,S.rounding=_.s=1,f=Math.min(12,(m+"").length),(b=lt(c.times(De(_,p+f)),p)).d&&hi((b=L(b,p+5,1)).d,p,g)&&(m=p+10,+oe((b=L(lt(c.times(De(_,m+f)),m),m+5,1)).d).slice(p+1,p+15)+1==1e14&&(b=L(b,p+1,0))),b.s=v,d=!0,S.rounding=g,L(b,p,g))},F.toPrecision=function(c,m){var f,p=this,b=p.constructor;return c===void 0?f=ke(p,p.e<=b.toExpNeg||p.e>=b.toExpPos):(me(c,1,u),m===void 0?m=b.rounding:me(m,0,8),f=ke(p=L(new b(p),c,m),c<=p.e||p.e<=b.toExpNeg,c)),p.isNeg()&&!p.isZero()?"-"+f:f},F.toSignificantDigits=F.toSD=function(c,m){var f=this.constructor;return c===void 0?(c=f.precision,m=f.rounding):(me(c,1,u),m===void 0?m=f.rounding:me(m,0,8)),L(new f(this),c,m)},F.toString=function(){var c=this,m=c.constructor,f=ke(c,c.e<=m.toExpNeg||c.e>=m.toExpPos);return c.isNeg()&&!c.isZero()?"-"+f:f},F.truncated=F.trunc=function(){return L(new this.constructor(this),this.e+1,1)},F.valueOf=F.toJSON=function(){var c=this,m=c.constructor,f=ke(c,c.e<=m.toExpNeg||c.e>=m.toExpPos);return c.isNeg()?"-"+f:f};var U=function(){function c(p,b,g){var v,_=0,S=p.length;for(p=p.slice();S--;)v=p[S]*b+_,p[S]=v%g|0,_=v/g|0;return _&&p.unshift(_),p}function m(p,b,g,v){var _,S;if(g!=v)S=g>v?1:-1;else for(_=S=0;_<g;_++)if(p[_]!=b[_]){S=p[_]>b[_]?1:-1;break}return S}function f(p,b,g,v){for(var _=0;g--;)p[g]-=_,_=p[g]<b[g]?1:0,p[g]=_*v+p[g]-b[g];for(;!p[0]&&p.length>1;)p.shift()}return function(p,b,g,v,_,S){var E,w,A,O,T,R,K,ie,Ie,ce,ae,fe,Vi,Le,ht,Ci,mi,mt,xe,ft,Di=p.constructor,gt=p.s==b.s?1:-1,le=p.d,Y=b.d;if(!(le&&le[0]&&Y&&Y[0]))return new Di(p.s&&b.s&&(le?!Y||le[0]!=Y[0]:Y)?le&&le[0]==0||!Y?0*gt:gt/0:NaN);for(S?(T=1,w=p.e-b.e):(S=$,T=7,w=P(p.e/T)-P(b.e/T)),xe=Y.length,mi=le.length,ce=(Ie=new Di(gt)).d=[],A=0;Y[A]==(le[A]||0);A++);if(Y[A]>(le[A]||0)&&w--,g==null?(Le=g=Di.precision,v=Di.rounding):Le=_?g+(p.e-b.e)+1:g,Le<0)ce.push(1),R=!0;else{if(Le=Le/T+2|0,A=0,xe==1){for(O=0,Y=Y[0],Le++;(A<mi||O)&&Le--;A++)ht=O*S+(le[A]||0),ce[A]=ht/Y|0,O=ht%Y|0;R=O||A<mi}else{for((O=S/(Y[0]+1)|0)>1&&(Y=c(Y,O,S),le=c(le,O,S),xe=Y.length,mi=le.length),Ci=xe,fe=(ae=le.slice(0,xe)).length;fe<xe;)ae[fe++]=0;(ft=Y.slice()).unshift(0),mt=Y[0],Y[1]>=S/2&&++mt;do O=0,(E=m(Y,ae,xe,fe))<0?(Vi=ae[0],xe!=fe&&(Vi=Vi*S+(ae[1]||0)),(O=Vi/mt|0)>1?(O>=S&&(O=S-1),(E=m(K=c(Y,O,S),ae,ie=K.length,fe=ae.length))==1&&(O--,f(K,xe<ie?ft:Y,ie,S))):(O==0&&(E=O=1),K=Y.slice()),(ie=K.length)<fe&&K.unshift(0),f(ae,K,fe,S),E==-1&&(E=m(Y,ae,xe,fe=ae.length))<1&&(O++,f(ae,xe<fe?ft:Y,fe,S)),fe=ae.length):E===0&&(O++,ae=[0]),ce[A++]=O,E&&ae[0]?ae[fe++]=le[Ci]||0:(ae=[le[Ci]],fe=1);while((Ci++<mi||ae[0]!==void 0)&&Le--);R=ae[0]!==void 0}ce[0]||ce.shift()}if(T==1)Ie.e=w,i=R;else{for(A=1,O=ce[0];O>=10;O/=10)A++;Ie.e=A+w*T-1,L(Ie,_?g+Ie.e+1:g,v,R)}return Ie}}();function L(c,m,f,p){var b,g,v,_,S,E,w,A,O,T=c.constructor;e:if(m!=null){if(!(A=c.d))return c;for(b=1,_=A[0];_>=10;_/=10)b++;if((g=m-b)<0)g+=7,v=m,S=(w=A[O=0])/I(10,b-v-1)%10|0;else if((O=Math.ceil((g+1)/7))>=(_=A.length)){if(!p)break e;for(;_++<=O;)A.push(0);w=S=0,b=1,v=(g%=7)-7+1}else{for(w=_=A[O],b=1;_>=10;_/=10)b++;S=(v=(g%=7)-7+b)<0?0:w/I(10,b-v-1)%10|0}if(p=p||m<0||A[O+1]!==void 0||(v<0?w:w%I(10,b-v-1)),E=f<4?(S||p)&&(f==0||f==(c.s<0?3:2)):S>5||S==5&&(f==4||p||f==6&&(g>0?v>0?w/I(10,b-v):0:A[O-1])%10&1||f==(c.s<0?8:7)),m<1||!A[0])return A.length=0,E?(m-=c.e+1,A[0]=I(10,(7-m%7)%7),c.e=-m||0):A[0]=c.e=0,c;if(g==0?(A.length=O,_=1,O--):(A.length=O+1,_=I(10,7-g),A[O]=v>0?(w/I(10,b-v)%I(10,v)|0)*_:0),E)for(;;){if(O==0){for(g=1,v=A[0];v>=10;v/=10)g++;for(v=A[0]+=_,_=1;v>=10;v/=10)_++;g!=_&&(c.e++,A[0]==$&&(A[0]=1));break}if(A[O]+=_,A[O]!=$)break;A[O--]=0,_=1}for(g=A.length;A[--g]===0;)A.pop()}return d&&(c.e>T.maxE?(c.d=null,c.e=NaN):c.e<T.minE&&(c.e=0,c.d=[0])),c}function ke(c,m,f){if(!c.isFinite())return en(c);var p,b=c.e,g=oe(c.d),v=g.length;return m?(f&&(p=f-v)>0?g=g.charAt(0)+"."+g.slice(1)+Ce(p):v>1&&(g=g.charAt(0)+"."+g.slice(1)),g=g+(c.e<0?"e":"e+")+c.e):b<0?(g="0."+Ce(-b-1)+g,f&&(p=f-v)>0&&(g+=Ce(p))):b>=v?(g+=Ce(b+1-v),f&&(p=f-b-1)>0&&(g=g+"."+Ce(p))):((p=b+1)<v&&(g=g.slice(0,p)+"."+g.slice(p)),f&&(p=f-v)>0&&(b+1===v&&(g+="."),g+=Ce(p))),g}function Oi(c,m){var f=c[0];for(m*=7;f>=10;f/=10)m++;return m}function qi(c,m,f){if(m>Mi)throw d=!0,f&&(c.precision=f),Error(x);return L(new c(a),m,1,!0)}function Ne(c,m,f){if(m>ot)throw Error(x);return L(new c(l),m,f,!0)}function Kt(c){var m=c.length-1,f=7*m+1;if(m=c[m]){for(;m%10==0;m/=10)f--;for(m=c[0];m>=10;m/=10)f++}return f}function Ce(c){for(var m="";c--;)m+="0";return m}function Yt(c,m,f,p){var b,g=new c(1),v=Math.ceil(p/7+4);for(d=!1;;){if(f%2&&nn((g=g.times(m)).d,v)&&(b=!0),(f=P(f/2))===0){f=g.d.length-1,b&&g.d[f]===0&&++g.d[f];break}nn((m=m.times(m)).d,v)}return d=!0,g}function Jt(c){return 1&c.d[c.d.length-1]}function Xt(c,m,f){for(var p,b=new c(m[0]),g=0;++g<m.length;){if(!(p=new c(m[g])).s){b=p;break}b[f](p)&&(b=p)}return b}function lt(c,m){var f,p,b,g,v,_,S,E=0,w=0,A=0,O=c.constructor,T=O.rounding,R=O.precision;if(!c.d||!c.d[0]||c.e>17)return new O(c.d?c.d[0]?c.s<0?0:1/0:1:c.s?c.s<0?0:c:NaN);for(m==null?(d=!1,S=R):S=m,_=new O(.03125);c.e>-2;)c=c.times(_),A+=5;for(S+=p=Math.log(I(2,A))/Math.LN10*2+5|0,f=g=v=new O(1),O.precision=S;;){if(g=L(g.times(c),S,1),f=f.times(++w),oe((_=v.plus(U(g,f,S,1))).d).slice(0,S)===oe(v.d).slice(0,S)){for(b=A;b--;)v=L(v.times(v),S,1);if(m!=null)return O.precision=R,v;if(!(E<3&&hi(v.d,S-p,T,E)))return L(v,O.precision=R,T,d=!0);O.precision=S+=10,f=g=_=new O(1),w=0,E++}v=_}}function De(c,m){var f,p,b,g,v,_,S,E,w,A,O,T=1,R=c,K=R.d,ie=R.constructor,Ie=ie.rounding,ce=ie.precision;if(R.s<0||!K||!K[0]||!R.e&&K[0]==1&&K.length==1)return new ie(K&&!K[0]?-1/0:R.s!=1?NaN:K?0:R);if(m==null?(d=!1,w=ce):w=m,ie.precision=w+=10,p=(f=oe(K)).charAt(0),!(Math.abs(g=R.e)<15e14))return E=qi(ie,w+2,ce).times(g+""),R=De(new ie(p+"."+f.slice(1)),w-10).plus(E),ie.precision=ce,m==null?L(R,ce,Ie,d=!0):R;for(;p<7&&p!=1||p==1&&f.charAt(1)>3;)p=(f=oe((R=R.times(c)).d)).charAt(0),T++;for(g=R.e,p>1?(R=new ie("0."+f),g++):R=new ie(p+"."+f.slice(1)),A=R,S=v=R=U(R.minus(1),R.plus(1),w,1),O=L(R.times(R),w,1),b=3;;){if(v=L(v.times(O),w,1),oe((E=S.plus(U(v,new ie(b),w,1))).d).slice(0,w)===oe(S.d).slice(0,w)){if(S=S.times(2),g!==0&&(S=S.plus(qi(ie,w+2,ce).times(g+""))),S=U(S,new ie(T),w,1),m!=null)return ie.precision=ce,S;if(!hi(S.d,w-10,Ie,_))return L(S,ie.precision=ce,Ie,d=!0);ie.precision=w+=10,E=v=R=U(A.minus(1),A.plus(1),w,1),O=L(R.times(R),w,1),b=_=1}S=E,b+=2}}function en(c){return c.s*c.s/0+""}function ut(c,m){var f,p,b;for((f=m.indexOf("."))>-1&&(m=m.replace(".","")),(p=m.search(/e/i))>0?(f<0&&(f=p),f+=+m.slice(p+1),m=m.substring(0,p)):f<0&&(f=m.length),p=0;m.charCodeAt(p)===48;p++);for(b=m.length;m.charCodeAt(b-1)===48;--b);if(m=m.slice(p,b)){if(b-=p,c.e=f=f-p-1,c.d=[],p=(f+1)%7,f<0&&(p+=7),p<b){for(p&&c.d.push(+m.slice(0,p)),b-=7;p<b;)c.d.push(+m.slice(p,p+=7));p=7-(m=m.slice(p)).length}else p-=b;for(;p--;)m+="0";c.d.push(+m),d&&(c.e>c.constructor.maxE?(c.d=null,c.e=NaN):c.e<c.constructor.minE&&(c.e=0,c.d=[0]))}else c.e=0,c.d=[0];return c}function vr(c,m){var f,p,b,g,v,_,S,E,w;if(m.indexOf("_")>-1){if(m=m.replace(/(\d)_(?=\d)/g,"$1"),j.test(m))return ut(c,m)}else if(m==="Infinity"||m==="NaN")return+m||(c.s=NaN),c.e=NaN,c.d=null,c;if(V.test(m))f=16,m=m.toLowerCase();else if(D.test(m))f=2;else{if(!C.test(m))throw Error(N+m);f=8}for((g=m.search(/p/i))>0?(S=+m.slice(g+1),m=m.substring(2,g)):m=m.slice(2),v=(g=m.indexOf("."))>=0,p=c.constructor,v&&(g=(_=(m=m.replace(".","")).length)-g,b=Yt(p,new p(f),g,2*g)),g=w=(E=Fi(m,f,$)).length-1;E[g]===0;--g)E.pop();return g<0?new p(0*c.s):(c.e=Oi(E,w),c.d=E,d=!1,v&&(c=U(c,b,4*_)),S&&(c=c.times(Math.abs(S)<54?I(2,S):e.pow(2,S))),d=!0,c)}function We(c,m,f,p,b){var g,v,_,S,E=c.precision,w=Math.ceil(E/7);for(d=!1,S=f.times(f),_=new c(p);;){if(v=U(_.times(S),new c(m++*m++),E,1),_=b?p.plus(v):p.minus(v),p=U(v.times(S),new c(m++*m++),E,1),(v=_.plus(p)).d[w]!==void 0){for(g=w;v.d[g]===_.d[g]&&g--;);if(g==-1)break}g=_,_=p,p=v,v=g}return d=!0,v.d.length=w+1,v}function Pi(c,m){for(var f=c;--m;)f*=c;return f}function tn(c,m){var f,p=m.s<0,b=Ne(c,c.precision,1),g=b.times(.5);if((m=m.abs()).lte(g))return r=p?4:1,m;if((f=m.divToInt(b)).isZero())r=p?3:2;else{if((m=m.minus(f.times(b))).lte(g))return r=Jt(f)?p?2:3:p?4:1,m;r=Jt(f)?p?1:4:p?3:2}return m.minus(b).abs()}function ct(c,m,f,p){var b,g,v,_,S,E,w,A,O,T=c.constructor,R=f!==void 0;if(R?(me(f,1,u),p===void 0?p=T.rounding:me(p,0,8)):(f=T.precision,p=T.rounding),c.isFinite()){for(R?(b=2,m==16?f=4*f-3:m==8&&(f=3*f-2)):b=m,(v=(w=ke(c)).indexOf("."))>=0&&(w=w.replace(".",""),(O=new T(1)).e=w.length-v,O.d=Fi(ke(O),10,b),O.e=O.d.length),g=S=(A=Fi(w,10,b)).length;A[--S]==0;)A.pop();if(A[0]){if(v<0?g--:((c=new T(c)).d=A,c.e=g,A=(c=U(c,O,f,p,0,b)).d,g=c.e,E=i),v=A[f],_=b/2,E=E||A[f+1]!==void 0,E=p<4?(v!==void 0||E)&&(p===0||p===(c.s<0?3:2)):v>_||v===_&&(p===4||E||p===6&&1&A[f-1]||p===(c.s<0?8:7)),A.length=f,E)for(;++A[--f]>b-1;)A[f]=0,f||(++g,A.unshift(1));for(S=A.length;!A[S-1];--S);for(v=0,w="";v<S;v++)w+=o.charAt(A[v]);if(R){if(S>1)if(m==16||m==8){for(v=m==16?4:3,--S;S%v;S++)w+="0";for(S=(A=Fi(w,b,m)).length;!A[S-1];--S);for(v=1,w="1.";v<S;v++)w+=o.charAt(A[v])}else w=w.charAt(0)+"."+w.slice(1);w=w+(g<0?"p":"p+")+g}else if(g<0){for(;++g;)w="0"+w;w="0."+w}else if(++g>S)for(g-=S;g--;)w+="0";else g<S&&(w=w.slice(0,g)+"."+w.slice(g))}else w=R?"0p+0":"0";w=(m==16?"0x":m==2?"0b":m==8?"0o":"")+w}else w=en(c);return c.s<0?"-"+w:w}function nn(c,m){if(c.length>m)return c.length=m,!0}function yr(c){return new this(c).abs()}function Nr(c){return new this(c).acos()}function xr(c){return new this(c).acosh()}function _r(c,m){return new this(c).plus(m)}function Sr(c){return new this(c).asin()}function wr(c){return new this(c).asinh()}function Er(c){return new this(c).atan()}function kr(c){return new this(c).atanh()}function Ir(c,m){c=new this(c),m=new this(m);var f,p=this.precision,b=this.rounding,g=p+4;return c.s&&m.s?c.d||m.d?!m.d||c.isZero()?(f=m.s<0?Ne(this,p,b):new this(0)).s=c.s:!c.d||m.isZero()?(f=Ne(this,g,1).times(.5)).s=c.s:m.s<0?(this.precision=g,this.rounding=1,f=this.atan(U(c,m,g,1)),m=Ne(this,g,1),this.precision=p,this.rounding=b,f=c.s<0?f.minus(m):f.plus(m)):f=this.atan(U(c,m,g,1)):(f=Ne(this,g,1).times(m.s>0?.25:.75)).s=c.s:f=new this(NaN),f}function Ar(c){return new this(c).cbrt()}function Mr(c){return L(c=new this(c),c.e+1,2)}function Fr(c,m,f){return new this(c).clamp(m,f)}function Or(c){if(!c||typeof c!="object")throw Error(y+"Object expected");var m,f,p,b=c.defaults===!0,g=["precision",1,u,"rounding",0,8,"toExpNeg",-s,0,"toExpPos",0,s,"maxE",0,s,"minE",-s,0,"modulo",0,9];for(m=0;m<g.length;m+=3)if(f=g[m],b&&(this[f]=h[f]),(p=c[f])!==void 0){if(!(P(p)===p&&p>=g[m+1]&&p<=g[m+2]))throw Error(N+f+": "+p);this[f]=p}if(f="crypto",b&&(this[f]=h[f]),(p=c[f])!==void 0){if(p!==!0&&p!==!1&&p!==0&&p!==1)throw Error(N+f+": "+p);if(p){if(typeof crypto=="undefined"||!crypto||!crypto.getRandomValues&&!crypto.randomBytes)throw Error(k);this[f]=!0}else this[f]=!1}return this}function qr(c){return new this(c).cos()}function Pr(c){return new this(c).cosh()}function Vr(c,m){return new this(c).div(m)}function Cr(c){return new this(c).exp()}function Dr(c){return L(c=new this(c),c.e+1,3)}function Lr(){var c,m,f=new this(0);for(d=!1,c=0;c<arguments.length;)if((m=new this(arguments[c++])).d)f.d&&(f=f.plus(m.times(m)));else{if(m.s)return d=!0,new this(1/0);f=m}return d=!0,f.sqrt()}function rn(c){return c instanceof e||c&&c.toStringTag===M||!1}function Tr(c){return new this(c).ln()}function Rr(c,m){return new this(c).log(m)}function zr(c){return new this(c).log(2)}function $r(c){return new this(c).log(10)}function Zr(){return Xt(this,arguments,"lt")}function jr(){return Xt(this,arguments,"gt")}function Gr(c,m){return new this(c).mod(m)}function Hr(c,m){return new this(c).mul(m)}function Br(c,m){return new this(c).pow(m)}function Wr(c){var m,f,p,b,g=0,v=new this(1),_=[];if(c===void 0?c=this.precision:me(c,1,u),p=Math.ceil(c/7),this.crypto)if(crypto.getRandomValues)for(m=crypto.getRandomValues(new Uint32Array(p));g<p;)(b=m[g])>=429e7?m[g]=crypto.getRandomValues(new Uint32Array(1))[0]:_[g++]=b%1e7;else{if(!crypto.randomBytes)throw Error(k);for(m=crypto.randomBytes(p*=4);g<p;)(b=m[g]+(m[g+1]<<8)+(m[g+2]<<16)+((127&m[g+3])<<24))>=214e7?crypto.randomBytes(4).copy(m,g):(_.push(b%1e7),g+=4);g=p/4}else for(;g<p;)_[g++]=1e7*Math.random()|0;for(c%=7,(p=_[--g])&&c&&(b=I(10,7-c),_[g]=(p/b|0)*b);_[g]===0;g--)_.pop();if(g<0)f=0,_=[0];else{for(f=-1;_[0]===0;f-=7)_.shift();for(p=1,b=_[0];b>=10;b/=10)p++;p<7&&(f-=7-p)}return v.e=f,v.d=_,v}function Ur(c){return L(c=new this(c),c.e+1,this.rounding)}function Qr(c){return(c=new this(c)).d?c.d[0]?c.s:0*c.s:c.s||NaN}function Kr(c){return new this(c).sin()}function Yr(c){return new this(c).sinh()}function Jr(c){return new this(c).sqrt()}function Xr(c,m){return new this(c).sub(m)}function es(){var c=0,m=arguments,f=new this(m[c]);for(d=!1;f.s&&++c<m.length;)f=f.plus(m[c]);return d=!0,L(f,this.precision,this.rounding)}function is(c){return new this(c).tan()}function ts(c){return new this(c).tanh()}function ns(c){return L(c=new this(c),c.e+1,1)}(e=function c(m){var f,p,b;function g(v){var _,S,E,w=this;if(!(w instanceof g))return new g(v);if(w.constructor=g,rn(v))return w.s=v.s,void(d?!v.d||v.e>g.maxE?(w.e=NaN,w.d=null):v.e<g.minE?(w.e=0,w.d=[0]):(w.e=v.e,w.d=v.d.slice()):(w.e=v.e,w.d=v.d?v.d.slice():v.d));if((E=typeof v)=="number"){if(v===0)return w.s=1/v<0?-1:1,w.e=0,void(w.d=[0]);if(v<0?(v=-v,w.s=-1):w.s=1,v===~~v&&v<1e7){for(_=0,S=v;S>=10;S/=10)_++;return void(d?_>g.maxE?(w.e=NaN,w.d=null):_<g.minE?(w.e=0,w.d=[0]):(w.e=_,w.d=[v]):(w.e=_,w.d=[v]))}return 0*v!=0?(v||(w.s=NaN),w.e=NaN,void(w.d=null)):ut(w,v.toString())}if(E!=="string")throw Error(N+v);return(S=v.charCodeAt(0))===45?(v=v.slice(1),w.s=-1):(S===43&&(v=v.slice(1)),w.s=1),j.test(v)?ut(w,v):vr(w,v)}if(g.prototype=F,g.ROUND_UP=0,g.ROUND_DOWN=1,g.ROUND_CEIL=2,g.ROUND_FLOOR=3,g.ROUND_HALF_UP=4,g.ROUND_HALF_DOWN=5,g.ROUND_HALF_EVEN=6,g.ROUND_HALF_CEIL=7,g.ROUND_HALF_FLOOR=8,g.EUCLID=9,g.config=g.set=Or,g.clone=c,g.isDecimal=rn,g.abs=yr,g.acos=Nr,g.acosh=xr,g.add=_r,g.asin=Sr,g.asinh=wr,g.atan=Er,g.atanh=kr,g.atan2=Ir,g.cbrt=Ar,g.ceil=Mr,g.clamp=Fr,g.cos=qr,g.cosh=Pr,g.div=Vr,g.exp=Cr,g.floor=Dr,g.hypot=Lr,g.ln=Tr,g.log=Rr,g.log10=$r,g.log2=zr,g.max=Zr,g.min=jr,g.mod=Gr,g.mul=Hr,g.pow=Br,g.random=Wr,g.round=Ur,g.sign=Qr,g.sin=Kr,g.sinh=Yr,g.sqrt=Jr,g.sub=Xr,g.sum=es,g.tan=is,g.tanh=ts,g.trunc=ns,m===void 0&&(m={}),m&&m.defaults!==!0)for(b=["precision","rounding","toExpNeg","toExpPos","maxE","minE","modulo","crypto"],f=0;f<b.length;)m.hasOwnProperty(p=b[f++])||(m[p]=this[p]);return g.config(m),g}(h)).prototype.constructor=e,e.default=e.Decimal=e,a=new e(a),l=new e(l),pt.exports?(typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"&&(F[Symbol.for("nodejs.util.inspect.custom")]=F.toString,F[Symbol.toStringTag]="Decimal"),pt.exports=e):(t||(t=typeof self!="undefined"&&self&&self.self==self?self:window),n=t.Decimal,e.noConflict=function(){return t.Decimal=n,e},t.Decimal=e)}(_s);var Ss=Q.exports,B={exports:{}};function un(t){return t===8205||t===65038||t===65039||t>=127995&&t<=128e3||t>=129456&&t<=129460||t>=917536&&t<=917632}function ws(t){return t>=127462&&t<=127487}(function(t,e){(function(i){var n=function(a){return .5*(Math.exp(a)+Math.exp(-a))},r=function(a){return .5*(Math.exp(a)-Math.exp(-a))},s=function(){throw SyntaxError("Invalid Param")};function u(a,l){var h=Math.abs(a),d=Math.abs(l);return a===0?Math.log(d):l===0?Math.log(h):h<3e3&&d<3e3?.5*Math.log(a*a+l*l):.5*Math.log((a/=2)*a+(l/=2)*l)+Math.LN2}function o(a,l){if(!(this instanceof o))return new o(a,l);var h=function(d,y){var N={re:0,im:0};if(d==null)N.re=N.im=0;else if(y!==void 0)N.re=d,N.im=y;else switch(typeof d){case"object":if("im"in d&&"re"in d)N.re=d.re,N.im=d.im;else if("abs"in d&&"arg"in d){if(!Number.isFinite(d.abs)&&Number.isFinite(d.arg))return o.INFINITY;N.re=d.abs*Math.cos(d.arg),N.im=d.abs*Math.sin(d.arg)}else if("r"in d&&"phi"in d){if(!Number.isFinite(d.r)&&Number.isFinite(d.phi))return o.INFINITY;N.re=d.r*Math.cos(d.phi),N.im=d.r*Math.sin(d.phi)}else d.length===2?(N.re=d[0],N.im=d[1]):s();break;case"string":N.im=N.re=0;var x=d.match(/\d+\.?\d*e[+-]?\d+|\d+\.?\d*|\.\d+|./g),k=1,M=0;x===null&&s();for(var P=0;P<x.length;P++){var I=x[P];I===" "||I==="	"||I===`
`||(I==="+"?k++:I==="-"?M++:I==="i"||I==="I"?(k+M===0&&s(),x[P+1]===" "||isNaN(x[P+1])?N.im+=parseFloat((M%2?"-":"")+"1"):(N.im+=parseFloat((M%2?"-":"")+x[P+1]),P++),k=M=0):((k+M===0||isNaN(I))&&s(),x[P+1]==="i"||x[P+1]==="I"?(N.im+=parseFloat((M%2?"-":"")+I),P++):N.re+=parseFloat((M%2?"-":"")+I),k=M=0))}k+M>0&&s();break;case"number":N.im=0,N.re=d;break;default:s()}return isNaN(N.re)||N.im,N}(a,l);this.re=h.re,this.im=h.im}o.prototype={re:0,im:0,sign:function(){var a=this.abs();return new o(this.re/a,this.im/a)},add:function(a,l){var h=new o(a,l);return this.isInfinite()&&h.isInfinite()?o.NAN:this.isInfinite()||h.isInfinite()?o.INFINITY:new o(this.re+h.re,this.im+h.im)},sub:function(a,l){var h=new o(a,l);return this.isInfinite()&&h.isInfinite()?o.NAN:this.isInfinite()||h.isInfinite()?o.INFINITY:new o(this.re-h.re,this.im-h.im)},mul:function(a,l){var h=new o(a,l);return this.isInfinite()&&h.isZero()||this.isZero()&&h.isInfinite()?o.NAN:this.isInfinite()||h.isInfinite()?o.INFINITY:h.im===0&&this.im===0?new o(this.re*h.re,0):new o(this.re*h.re-this.im*h.im,this.re*h.im+this.im*h.re)},div:function(a,l){var h=new o(a,l);if(this.isZero()&&h.isZero()||this.isInfinite()&&h.isInfinite())return o.NAN;if(this.isInfinite()||h.isZero())return o.INFINITY;if(this.isZero()||h.isInfinite())return o.ZERO;a=this.re,l=this.im;var d,y,N=h.re,x=h.im;return x===0?new o(a/N,l/N):Math.abs(N)<Math.abs(x)?new o((a*(y=N/x)+l)/(d=N*y+x),(l*y-a)/d):new o((a+l*(y=x/N))/(d=x*y+N),(l-a*y)/d)},pow:function(a,l){var h=new o(a,l);if(a=this.re,l=this.im,h.isZero())return o.ONE;if(h.im===0){if(l===0&&a>0)return new o(Math.pow(a,h.re),0);if(a===0)switch((h.re%4+4)%4){case 0:return new o(Math.pow(l,h.re),0);case 1:return new o(0,Math.pow(l,h.re));case 2:return new o(-Math.pow(l,h.re),0);case 3:return new o(0,-Math.pow(l,h.re))}}if(a===0&&l===0&&h.re>0&&h.im>=0)return o.ZERO;var d=Math.atan2(l,a),y=u(a,l);return a=Math.exp(h.re*y-h.im*d),l=h.im*y+h.re*d,new o(a*Math.cos(l),a*Math.sin(l))},sqrt:function(){var a,l,h=this.re,d=this.im,y=this.abs();if(h>=0){if(d===0)return new o(Math.sqrt(h),0);a=.5*Math.sqrt(2*(y+h))}else a=Math.abs(d)/Math.sqrt(2*(y-h));return l=h<=0?.5*Math.sqrt(2*(y-h)):Math.abs(d)/Math.sqrt(2*(y+h)),new o(a,d<0?-l:l)},exp:function(){var a=Math.exp(this.re);return this.im,new o(a*Math.cos(this.im),a*Math.sin(this.im))},expm1:function(){var a=this.re,l=this.im;return new o(Math.expm1(a)*Math.cos(l)+function(h){var d=Math.PI/4;if(-d>h||h>d)return Math.cos(h)-1;var y=h*h;return y*(y*(y*(y*(y*(y*(y*(y/20922789888e3-1/87178291200)+1/479001600)-1/3628800)+1/40320)-1/720)+1/24)-.5)}(l),Math.exp(a)*Math.sin(l))},log:function(){var a=this.re,l=this.im;return new o(u(a,l),Math.atan2(l,a))},abs:function(){return a=this.re,l=this.im,h=Math.abs(a),d=Math.abs(l),h<3e3&&d<3e3?Math.sqrt(h*h+d*d):(h<d?(h=d,d=a/l):d=l/a,h*Math.sqrt(1+d*d));var a,l,h,d},arg:function(){return Math.atan2(this.im,this.re)},sin:function(){var a=this.re,l=this.im;return new o(Math.sin(a)*n(l),Math.cos(a)*r(l))},cos:function(){var a=this.re,l=this.im;return new o(Math.cos(a)*n(l),-Math.sin(a)*r(l))},tan:function(){var a=2*this.re,l=2*this.im,h=Math.cos(a)+n(l);return new o(Math.sin(a)/h,r(l)/h)},cot:function(){var a=2*this.re,l=2*this.im,h=Math.cos(a)-n(l);return new o(-Math.sin(a)/h,r(l)/h)},sec:function(){var a=this.re,l=this.im,h=.5*n(2*l)+.5*Math.cos(2*a);return new o(Math.cos(a)*n(l)/h,Math.sin(a)*r(l)/h)},csc:function(){var a=this.re,l=this.im,h=.5*n(2*l)-.5*Math.cos(2*a);return new o(Math.sin(a)*n(l)/h,-Math.cos(a)*r(l)/h)},asin:function(){var a=this.re,l=this.im,h=new o(l*l-a*a+1,-2*a*l).sqrt(),d=new o(h.re-l,h.im+a).log();return new o(d.im,-d.re)},acos:function(){var a=this.re,l=this.im,h=new o(l*l-a*a+1,-2*a*l).sqrt(),d=new o(h.re-l,h.im+a).log();return new o(Math.PI/2-d.im,d.re)},atan:function(){var a=this.re,l=this.im;if(a===0){if(l===1)return new o(0,1/0);if(l===-1)return new o(0,-1/0)}var h=a*a+(1-l)*(1-l),d=new o((1-l*l-a*a)/h,-2*a/h).log();return new o(-.5*d.im,.5*d.re)},acot:function(){var a=this.re,l=this.im;if(l===0)return new o(Math.atan2(1,a),0);var h=a*a+l*l;return h!==0?new o(a/h,-l/h).atan():new o(a!==0?a/0:0,l!==0?-l/0:0).atan()},asec:function(){var a=this.re,l=this.im;if(a===0&&l===0)return new o(0,1/0);var h=a*a+l*l;return h!==0?new o(a/h,-l/h).acos():new o(a!==0?a/0:0,l!==0?-l/0:0).acos()},acsc:function(){var a=this.re,l=this.im;if(a===0&&l===0)return new o(Math.PI/2,1/0);var h=a*a+l*l;return h!==0?new o(a/h,-l/h).asin():new o(a!==0?a/0:0,l!==0?-l/0:0).asin()},sinh:function(){var a=this.re,l=this.im;return new o(r(a)*Math.cos(l),n(a)*Math.sin(l))},cosh:function(){var a=this.re,l=this.im;return new o(n(a)*Math.cos(l),r(a)*Math.sin(l))},tanh:function(){var a=2*this.re,l=2*this.im,h=n(a)+Math.cos(l);return new o(r(a)/h,Math.sin(l)/h)},coth:function(){var a=2*this.re,l=2*this.im,h=n(a)-Math.cos(l);return new o(r(a)/h,-Math.sin(l)/h)},csch:function(){var a=this.re,l=this.im,h=Math.cos(2*l)-n(2*a);return new o(-2*r(a)*Math.cos(l)/h,2*n(a)*Math.sin(l)/h)},sech:function(){var a=this.re,l=this.im,h=Math.cos(2*l)+n(2*a);return new o(2*n(a)*Math.cos(l)/h,-2*r(a)*Math.sin(l)/h)},asinh:function(){var a=this.im;this.im=-this.re,this.re=a;var l=this.asin();return this.re=-this.im,this.im=a,a=l.re,l.re=-l.im,l.im=a,l},acosh:function(){var a=this.acos();if(a.im<=0){var l=a.re;a.re=-a.im,a.im=l}else l=a.im,a.im=-a.re,a.re=l;return a},atanh:function(){var a=this.re,l=this.im,h=a>1&&l===0,d=1-a,y=1+a,N=d*d+l*l,x=N!==0?new o((y*d-l*l)/N,(l*d+y*l)/N):new o(a!==-1?a/0:0,l!==0?l/0:0),k=x.re;return x.re=u(x.re,x.im)/2,x.im=Math.atan2(x.im,k)/2,h&&(x.im=-x.im),x},acoth:function(){var a=this.re,l=this.im;if(a===0&&l===0)return new o(0,Math.PI/2);var h=a*a+l*l;return h!==0?new o(a/h,-l/h).atanh():new o(a!==0?a/0:0,l!==0?-l/0:0).atanh()},acsch:function(){var a=this.re,l=this.im;if(l===0)return new o(a!==0?Math.log(a+Math.sqrt(a*a+1)):1/0,0);var h=a*a+l*l;return h!==0?new o(a/h,-l/h).asinh():new o(a!==0?a/0:0,l!==0?-l/0:0).asinh()},asech:function(){var a=this.re,l=this.im;if(this.isZero())return o.INFINITY;var h=a*a+l*l;return h!==0?new o(a/h,-l/h).acosh():new o(a!==0?a/0:0,l!==0?-l/0:0).acosh()},inverse:function(){if(this.isZero())return o.INFINITY;if(this.isInfinite())return o.ZERO;var a=this.re,l=this.im,h=a*a+l*l;return new o(a/h,-l/h)},conjugate:function(){return new o(this.re,-this.im)},neg:function(){return new o(-this.re,-this.im)},ceil:function(a){return a=Math.pow(10,a||0),new o(Math.ceil(this.re*a)/a,Math.ceil(this.im*a)/a)},floor:function(a){return a=Math.pow(10,a||0),new o(Math.floor(this.re*a)/a,Math.floor(this.im*a)/a)},round:function(a){return a=Math.pow(10,a||0),new o(Math.round(this.re*a)/a,Math.round(this.im*a)/a)},equals:function(a,l){var h=new o(a,l);return Math.abs(h.re-this.re)<=o.EPSILON&&Math.abs(h.im-this.im)<=o.EPSILON},clone:function(){return new o(this.re,this.im)},toString:function(){var a=this.re,l=this.im,h="";return this.isNaN()?"NaN":this.isInfinite()?"Infinity":(Math.abs(a)<o.EPSILON&&(a=0),Math.abs(l)<o.EPSILON&&(l=0),l===0?h+a:(a!==0?(h+=a,h+=" ",l<0?(l=-l,h+="-"):h+="+",h+=" "):l<0&&(l=-l,h+="-"),l!==1&&(h+=l),h+"i"))},toVector:function(){return[this.re,this.im]},valueOf:function(){return this.im===0?this.re:null},isNaN:function(){return isNaN(this.re)||isNaN(this.im)},isZero:function(){return this.im===0&&this.re===0},isFinite:function(){return isFinite(this.re)&&isFinite(this.im)},isInfinite:function(){return!(this.isNaN()||this.isFinite())}},o.ZERO=new o(0,0),o.ONE=new o(1,0),o.I=new o(0,1),o.PI=new o(Math.PI,0),o.E=new o(Math.E,0),o.INFINITY=new o(1/0,1/0),o.NAN=new o(NaN,NaN),o.EPSILON=1e-15,Object.defineProperty(o,"__esModule",{value:!0}),o.default=o,o.Complex=o,t.exports=o})()})(B);class Es{constructor(e){this.obeyspaces=!1,this.s=function(i){if(/^[\u0020-\u00FF]*$/.test(i))return i;const n=[],r=function(u){const o=[];for(let a=0;a<u.length;a++){let l=u.charCodeAt(a);if(l>=55296&&l<=56319){const h=u.charCodeAt(a+1);h>=56320&&h<=57343&&(l=65536+1024*(l-55296)+(h-56320),a++)}o.push(l)}return o}(i);let s=0;for(;s<r.length;){const u=r[s++],o=r[s];if(o===8205){const a=s-1;for(s+=2;r[s]===8205;)s+=2;n.push(String.fromCodePoint(...r.slice(a,2*s-a+1)))}else if(un(o)){const a=s-1;for(;un(r[s]);)s+=r[s]===8205?2:1;n.push(String.fromCodePoint(...r.slice(a,2*s-a-1)))}else ws(u)?(s+=1,n.push(String.fromCodePoint(...r.slice(s-2,2)))):n.push(String.fromCodePoint(u))}return n}(e),this.pos=0}end(){return this.pos>=this.s.length}get(){return this.pos<this.s.length?this.s[this.pos++]:""}peek(){return this.s[this.pos]}match(e){let i;return i=typeof this.s=="string"?e.exec(this.s.slice(this.pos)):e.exec(this.s.slice(this.pos).join("")),i!=null&&i[0]?(this.pos+=i[0].length,i[0]):null}next(){if(this.end())return null;if(!this.obeyspaces&&this.match(/^[ \f\n\r\t\v\xA0\u2028\u2029]+/)||this.obeyspaces&&this.match(/^[ \f\n\r\t\v\xA0\u2028\u2029]/))return"<space>";const e=this.get();if(e==="\\"){if(!this.end()){let i=this.match(/^[a-zA-Z*]+/);if(i)this.match(/^[ \f\n\r\t\v\xA0\u2028\u2029]*/);else if(i=this.get(),i===" ")return"<space>";return"\\"+i}}else{if(e==="{")return"<{>";if(e==="}")return"<}>";if(e==="^"){if(this.peek()==="^"){this.get();const i=this.match(/^(\^(\^(\^(\^[0-9a-f])?[0-9a-f])?[0-9a-f])?[0-9a-f])?[0-9a-f][0-9a-f]/);if(i)return String.fromCodePoint(parseInt(i.slice(i.lastIndexOf("^")+1),16))}return e}if(e==="#"){if(!this.end()){let i=!1;if(/[0-9?]/.test(this.peek())&&(i=!0,this.pos+1<this.s.length)){const n=this.s[this.pos+1];i=/[^0-9A-Za-z]/.test(n)}return i?"#"+this.get():"#"}}else if(e==="$")return this.peek()==="$"?(this.get(),"<$$>"):"<$>"}return e}}function ks(t,e){var r,s,u,o;let i=[],n=t.next();if(n&&n!=="\\relax"){if(n==="\\noexpand")n=t.next(),n&&i.push(n);else if(n==="\\obeyspaces")t.obeyspaces=!0;else if(n==="\\space"||n==="~")i.push("<space>");else if(n==="\\bgroup")i.push("<{>");else if(n==="\\egroup")i.push("<}>");else if(n==="\\string")n=t.next(),n&&(n[0]==="\\"?Array.from(n).forEach(a=>i.push(a==="\\"?"\\backslash":a)):n==="<{>"?i.push("\\{"):n==="<space>"?i.push("~"):n==="<}>"&&i.push("\\}"));else if(n==="\\csname"){for(;t.peek()==="<space>";)t.next();let a="",l=!1,h=[];do h.length===0&&(/^#[0-9?]$/.test(t.peek())?(h=Qi((s=(r=e==null?void 0:e[t.get().slice(1)])!=null?r:e==null?void 0:e["?"])!=null?s:"\\placeholder{}",e),n=h[0]):(n=t.next(),h=n?[n]:[])),l=h.length===0,l||n!=="\\endcsname"||(l=!0,h.shift()),l||(l=n==="<$>"||n==="<$$>"||n==="<{>"||n==="<}>"||!!n&&n.length>1&&n[0]==="\\"),l||(a+=h.shift());while(!l);a&&i.push("\\"+a),i=i.concat(h)}else if(n!=="\\endcsname")if(n.length>1&&n[0]==="#"){const a=n.slice(1);i=i.concat(Qi((o=(u=e==null?void 0:e[a])!=null?u:e==null?void 0:e["?"])!=null?o:"\\placeholder{}",e))}else i.push(n)}return i}function Qi(t,e){const i=t.toString().split(/\r?\n/);let n="",r="";for(const o of i){n+=r,r=" ";const a=o.match(/((?:\\%)|[^%])*/);a!==null&&(n+=a[0])}const s=new Es(n),u=[];do u.push(...ks(s,e));while(!s.end());return u}function X(t){let e="",i="";for(const n of t)n&&(/[a-zA-Z*]/.test(n[0])&&(i+=e),e=/\\[a-zA-Z]+\*?$/.test(n)?" ":"",i+=n);return i}function Me(t){let e=[];if(Array.isArray(t))for(const i of t)Array.isArray(i)?e=[...e,...i]:e.push(i);else e=[t];return X(e.map(i=>{var n;return(n={"<space>":" ","<$$>":"$$","<$>":"$","<{>":"{","<}>":"}"}[i])!=null?n:i}))}function Ki(t){return t!==null&&typeof t=="object"&&"num"in t}function jt(t){return t!==null&&typeof t=="object"&&"sym"in t}function ci(t){return t!==null&&typeof t=="object"&&"fn"in t}function ui(t){return t===null?null:typeof t=="object"&&"str"in t?t.str:typeof t!="string"||t.length<2||t[0]!=="'"||t[t.length-1]!=="'"?null:t.substring(1,t.length-1)}function Z(t){return t===null?null:Array.isArray(t)?t[0]:ci(t)?t.fn[0]:null}function cn(t){const e=Z(t);return typeof e=="string"?e:""}function q(t,e){var i,n;return t===null?null:Array.isArray(t)?(i=t[e])!=null?i:null:ci(t)&&(n=t.fn[e])!=null?n:null}function Se(t){return Array.isArray(t)?Math.max(0,t.length-1):ci(t)?Math.max(0,t.fn.length-1):0}function Be(t){if(t===null)return null;const e=jt(t)?t.sym:t;return typeof e!="string"||e.length>=2&&e[0]==="'"&&e[e.length-1]==="'"?null:e}function bi(t){if(t===null)return null;const e=jt(t)?t.sym:t;return typeof e!="string"||e.length<2||e[0]!=="'"||e[e.length-1]!=="'"?null:e.slice(1,-1)}function hn(t){var i;const e=Z(t);if(e==="KeyValuePair"||e==="Tuple"||e==="Pair"){const n=bi(q(t,1));return n?[n,(i=q(t,2))!=null?i:"Nothing"]:null}return null}function Un(t){if(t===null)return null;if(typeof t=="object"&&"dict"in t)return t.dict;const e=hn(t);if(e)return{[e[0]]:e[1]};const i=Z(t);if(i==="List"||i==="Dictionary"){const n={};for(let r=1;r<Se(t);r++){const s=hn(q(t,r));s&&(n[s[0]]=s[1])}return n}return null}function W(t){if(t===null)return null;if(typeof t=="number")return t;if(Ki(t))return parseFloat(t.num);const e=Be(t);return e==="NaN"?NaN:e==="+Infinity"?1/0:e==="-Infinity"?-1/0:null}function Mt(t){var r,s,u,o,a,l,h,d,y,N,x;if(function(k){return k===null||!Array.isArray(k)&&(typeof k!="object"||!("fn"in k||"dic"in k))}(t))return[null,null];const e=Z(t);if(!e)return[null,null];let i=null,n=null;if(e==="Negate"&&([i,n]=Mt((r=q(t,1))!=null?r:"Missing"),i!==null&&n!==null))return[-i,n];if(e==="Rational")return[(u=W((s=q(t,1))!=null?s:NaN))!=null?u:NaN,(a=W((o=q(t,2))!=null?o:NaN))!=null?a:NaN];if(e==="Power"){const k=W(q(t,2));k===1?(i=(l=W(q(t,1)))!=null?l:null,n=1):k===-1&&(i=1,n=(h=W(q(t,1)))!=null?h:null)}return e==="Divide"&&(i=(d=W(q(t,1)))!=null?d:null,n=(y=W(q(t,2)))!=null?y:null),e==="Multiply"&&Z(q(t,2))==="Power"&&W(q(q(t,2),2))===-1&&(i=(N=W(q(t,1)))!=null?N:null,n=(x=W(q(q(t,2),1)))!=null?x:null),i===null||n===null?[null,null]:Number.isInteger(i)&&Number.isInteger(n)?[i,n]:[null,null]}function te(t){return Array.isArray(t)?t.slice(1):ci(t)?t.fn.slice(1):[]}function Qn(t,e){let i=null;if(Array.isArray(t)&&(i=t),ci(t)&&(i=t.fn),i===null)return[];let n=1;const r=[];for(;n<i.length;)r.push(e(i[n])),n+=1;return r}function Yi(t,e,i,n="both"){var u,o,a,l,h,d;if(n==="non")return[t,e,i];const r=Z(e),s=Z(i);return n==="left"?r===t?[t,...(u=te(e))!=null?u:[],i]:[t,e,i]:n==="right"?s===t?[t,e,...(o=te(i))!=null?o:[]]:[t,e,i]:r===t&&s===t?[t,...(a=te(e))!=null?a:[],...(l=te(i))!=null?l:[]]:r===t?[t,...(h=te(e))!=null?h:[],i]:s===t?[t,e,...(d=te(i))!=null?d:[]]:[t,e,i]}function Ft(t){var i,n;const e=Z(t);return t===null?null:(e==="Delimiter"&&(t=(i=q(t,1))!=null?i:null),t===null?null:e==="Sequence"?(n=te(t))!=null?n:[]:null)}function Xe(t,e){return e>2?"solidus":"radical"}function Kn(t,e){return e>3?"inline-solidus":"quotient"}function vi(t,e,i,n){return i===null?"\\sqrt{}":(n=n!=null?n:2,e==="solidus"?t.wrapShort(i)+"^{1\\/"+t.serialize(n)+"}":e==="quotient"?t.wrapShort(i)+"^{\\frac{1}{"+t.serialize(n)+"}}":W(n)===2?"\\sqrt{"+t.serialize(i)+"}":"\\sqrt["+t.serialize(n)+"]{"+t.serialize(i)+"}")}function mn(t,e){var s,u;if(e===null)return"";const i=(s=q(e,1))!=null?s:"Missing",n=(u=q(e,2))!=null?u:"Missing";if(Se(e)===1)return t.serialize(i);const r=Kn(0,t.level);if(r==="inline-solidus"||r==="nice-solidus"){const o=t.wrapShort(i),a=t.wrapShort(n);return r==="inline-solidus"?`${o}\\/${a}`:`^{${o}}\\!\\!/\\!_{${a}}`}return r==="reciprocal"?t.wrap(i)+t.wrap(n)+"^{-1}":r==="factor"?"\\frac{1}{"+t.serialize(n)+"}"+t.wrap(i):`\\frac{${t.serialize(i)}}{${t.serialize(n)}}`}function dt(t,e){var u,o,a;const i=Z(e),n=(u=q(e,1))!=null?u:"Missing",r=(o=q(e,2))!=null?o:"Missing";if(i==="Sqrt")return vi(t,Xe(0,t.level),n,2);if(i==="Root")return vi(t,Xe(0,t.level),n,r);const s=(a=W(r))!=null?a:1;if(s===-1)return t.serialize(["Divide","1",n]);if(s<0)return t.serialize(["Divide","1",["Power",n,-s]]);if(Z(r)==="Divide"||Z(r)==="Rational"){if(W(q(r,1))===1)return vi(t,Xe(0,t.level),n,q(r,2))}else if(Z(r)==="Power"&&W(q(r,2))===-1)return vi(t,Xe(0,t.level),n,q(r,1));return t.wrapShort(n)+"^{"+t.serialize(r)+"}"}const Is=[{name:"CatalanConstant",serialize:"G"},{name:"GoldenRatio",serialize:"\\varphi"},{name:"EulerGamma",serialize:"\\gamma"},{name:"Degrees",serialize:"\\frac{\\pi}{180}"},{trigger:["\\infty"],parse:{num:"+Infinity"}},{name:"ComplexInfinity",trigger:["\\tilde","\\infty"],serialize:"\\tilde\\infty"},{trigger:["\\tilde","<{>","\\infty","<}>"],parse:"ComplexInfinity"},{name:"Pi",trigger:["\\pi"]},{trigger:["\u03C0"],parse:"Pi"},{name:"ExponentialE",trigger:["e"],serialize:"e"},{trigger:["\\mathrm","<{>","e","<}>"],parse:"ExponentialE"},{trigger:["\\exponentialE"],parse:"ExponentialE"},{name:"ImaginaryUnit",trigger:["\\imaginaryI"]},{trigger:["i"],parse:"ImaginaryUnit"},{trigger:["\\mathrm","<{>","i","<}>"],parse:"ImaginaryUnit"},{name:"Add",trigger:["+"],kind:"infix",associativity:"both",precedence:275,parse:(t,e,i)=>{if(275<e.minPrec)return null;const n=t.matchExpression(ee(z({},e),{minPrec:275}));return n===null?null:Yi("Add",i,n)},serialize:function(t,e){var u,o;t.level-=1;const i=Z(e);let n="",r=q(e,1),s=!Number.isNaN((u=W(r))!=null?u:NaN);if(i==="Negate")n="-"+t.wrap(r,276);else if(i==="Add"){n=t.serialize(r);const a=Se(e)+1;for(let l=2;l<a;l++){r=q(e,l);const h=(o=W(r))!=null?o:NaN,d=!Number.isNaN(h);let y=!1;if(r!==null&&s){const[N,x]=Mt(r);N!==null&&x!==null&&isFinite(N)&&isFinite(x)&&x!==1&&(n+=t.options.invisiblePlus+t.serialize(r),y=!0)}if(!y)if(h<0)n+=t.serialize(r);else if(Z(r)==="Negate")n+=t.wrap(r,275);else{const N=t.wrap(r,275);N[0]==="-"||N[0]==="+"?n+=N:n=n+"+"+N}s=d}}else if(i==="Subtract"){const a=q(e,2);n=a!==null?t.wrap(r,275)+"-"+t.wrap(a,275):t.wrap(r,275)}return t.level+=1,n}},{kind:"prefix",trigger:["+"],precedence:275,parse:(t,e)=>275<e.minPrec?null:t.matchExpression(ee(z({},e),{minPrec:400}))},{name:"Complex",precedence:274,serialize:(t,e)=>{const i=W(q(e,1)),n=W(q(e,2));if(n===0)return t.serialize(q(e,1));const r=n===1?"\\imaginaryI":n===-1?"-\\imaginaryI":X([t.serialize(q(e,2)),"\\imaginaryI"]);return i===0?r:X(n!==null&&n<0?[t.serialize(q(e,1)),r]:[t.serialize(q(e,1)),"+",r])}},{name:"Divide",trigger:["\\frac"],requiredLatexArg:2,precedence:660,parse:function(t){var n,r,s,u;const e=(n=t.matchRequiredLatexArgument())!=null?n:"Missing",i=(r=t.matchRequiredLatexArgument())!=null?r:"Missing";if(Z(e)==="PartialDerivative"&&(Z(i)==="PartialDerivative"||Z(i)==="Multiply"&&Z(q(i,1))==="PartialDerivative")){const o=(s=q(e,3))!=null?s:"Missing";let a=q(e,1);a!==null&&a!=="Missing"||(a=(u=t.matchExpression())!=null?u:"Missing");let l=[];if(Z(i)==="Multiply"){for(const h of te(i))if(Z(h)==="PartialDerivative"){const d=q(h,2);d&&l.push(d)}}else{const h=q(i,2);h&&l.push(h)}return l.length>1&&(l=["List",...l]),["PartialDerivative",a,...l,o==="Missing"?1:o]}return["Divide",e,i]},serialize:mn},{trigger:["\\/"],kind:"infix",associativity:"non",precedence:660,parse:"Divide"},{trigger:["/"],kind:"infix",associativity:"non",precedence:660,parse:"Divide"},{trigger:["\\div"],kind:"infix",associativity:"non",precedence:660,parse:"Divide"},{name:"Exp",serialize:(t,e)=>{var i;return X(["\\exponentialE^{",t.serialize((i=q(e,1))!=null?i:"Missing"),"}"])}},{name:"Factorial",trigger:["!"],kind:"postfix",precedence:810},{name:"Factorial2",trigger:["!","!"],kind:"postfix",precedence:810},{trigger:"\\operatorname{floor}",parse:t=>{const e=t.matchArguments("enclosure");return e===null?null:["Floor",...e]}},{name:"Gcd",trigger:"\\operatorname{gcd}",parse:t=>{const e=t.matchArguments("enclosure");return e===null?null:["Gcd",...e]},serialize:(t,e)=>X(["\\operatorname{gcd}","\\left(",t.serialize(e),"\\right)"])},{name:"Half",serialize:"\\frac12"},{name:"Lcm",trigger:"\\operatorname{lcm}"},{name:"MinusPlus",trigger:["\\mp"],kind:"infix",associativity:"both",precedence:270},{name:"Multiply",trigger:["\\times"],kind:"infix",associativity:"both",precedence:390,serialize:function t(e,i){var h,d;if(i===null)return"";e.level-=1;let n="";const[r,s]=function(y){var M,P,I,D,V;if(Z(y)!=="Multiply")return[[],[]];const N=[],x=[],k=te(y);for(const C of k)if(Z(C)==="Power")if(Z(q(C,2))==="Negate"){const j=(M=q(C,1))!=null?M:"Missing",$=(P=q(q(C,2),1))!=null?P:"Missing";x.push(["Power",j,$])}else{const j=(I=W(q(C,2)))!=null?I:NaN;j===-1?x.push((D=q(C,1))!=null?D:"Missing"):j<0?x.push(["Power",(V=q(C,1))!=null?V:"Missing",-j]):N.push(C)}else N.push(C);return[N,x]}(i);if(s.length>0&&(n=s.length===1&&s[0]===1?r.length===0?"1":r.length===1?e.serialize(r[0]):t(e,["Multiply",...r]):e.serialize(["Divide",r.length===1?r[0]:["Multiply",...r],s.length===1?s[0]:["Multiply",...s]])),n)return e.level+=1,n;let u=!1,o=null;const a=Se(i)+1;let l=!1;for(let y=1;y<a;y++){if(o=q(i,y),o===null)continue;let N;if(typeof o=="number"||Ki(o))N=e.serialize(o),N!=="-1"||n?(N[0]==="-"&&(N=N.slice(1),u=!u),n=n?X([n,e.options.multiply,N]):N):n="-",l=!0;else{if(Z(o)==="Power"){const[x,k]=Mt((h=q(o,2))!=null?h:NaN);if(x===1&&k!==null){n+=vi(e,Xe(0,e.level),q(o,1),k),l=!1;continue}}if(Z(o)!=="Power"||isNaN((d=W(q(o,1)))!=null?d:NaN)){if(Z(o)==="Negate"&&(o=q(o,1),u=!u),N=e.wrap(o,390),n){const x=Z(o);n=!l||x!=="Divide"&&x!=="Rational"?e.options.invisibleMultiply?X([n,e.options.invisibleMultiply,N]):X([n,N]):X([n,e.options.multiply,N])}else n=N;l=!1}else N=e.serialize(o),n=n?X([n,e.options.multiply,N]):N,l=!0}}return e.level+=1,u?"-"+n:n}},{trigger:["\\cdot"],kind:"infix",associativity:"both",precedence:390,parse:(t,e,i)=>{if(391<e.minPrec)return null;const n=t.matchExpression(ee(z({},e),{minPrec:392}));return n===null?null:Yi("Multiply",i,n)}},{trigger:["*"],kind:"infix",associativity:"both",precedence:390,parse:(t,e,i)=>{if(391<e.minPrec)return null;const n=t.matchExpression(ee(z({},e),{minPrec:392}));return n===null?null:["Multiply",i,n]}},{name:"Negate",trigger:["-"],kind:"prefix",parse:(t,e)=>{if(276<e.minPrec)return null;const i=t.matchExpression(ee(z({},e),{minPrec:400}));return i===null?null:["Negate",i]},precedence:275},{name:"PlusMinus",trigger:["\\pm"],kind:"infix",associativity:"both",precedence:270},{name:"Power",trigger:["^"],kind:"infix",serialize:dt},{name:"Rational",precedence:660,serialize:mn},{name:"Root",serialize:dt},{name:"Round",trigger:"\\operatorname{round}"},{name:"Square",precedence:720,serialize:(t,e)=>t.wrapShort(q(e,1))+"^2"},{name:"Sign",trigger:"\\operatorname{sgn}"},{name:"Sqrt",trigger:["\\sqrt"],optionalLatexArg:1,requiredLatexArg:1,parse:function(t){const e=t.matchOptionalLatexArgument(),i=t.matchRequiredLatexArgument();return i===null?e!==null?["Root","Missing",e]:["Sqrt","Missing"]:e!==null?["Root",i,e]:["Sqrt",i]},serialize:dt},{name:"Subtract",trigger:["-"],kind:"infix",associativity:"both",precedence:275,parse:(t,e,i)=>{if(276<e.minPrec)return null;const n=t.matchExpression(ee(z({},e),{minPrec:277}));return n===null?null:["Subtract",i,n]}}];function fn(t=""){return(e,i)=>te(i).map(n=>e.serialize(n)).join(t)}function Ue(t,e){if(e===null)return"";const i=Z(e);if(i==="LatexString")return Jn(t,e);if(i==="LatexTokens")return Yn(t,e);const n=ui(e);if(n!==null)return`\\text{${n}}`;const r=W(e);return r!==null?r.toString():`\\text{${JSON.stringify(e)}}`}const As=[{name:"Missing",trigger:["\\placeholder"],requiredLatexArg:1,serialize:t=>{var e;return(e=t.options.missingSymbol)!=null?e:"\\placeholder{}"}},{name:"BaseForm",serialize:(t,e)=>{var n,r;const i=(n=W(q(e,2)))!=null?n:NaN;if(isFinite(i)&&i>=2&&i<=36){const s=(r=W(q(e,1)))!=null?r:NaN;if(isFinite(s)){let u=Number(s).toString(i),o=0;if(i===2||i===10?o=4:i===16?o=2:i>16&&(o=4),o>0){const a=u;u="";for(let l=0;l<a.length;l++)l>0&&l%o==0&&(u="\\, "+u),u=a[a.length-l-1]+u}return`(\\text{${u}}_{${i}}`}}return"\\operatorname{BaseForm}("+t.serialize(q(e,1))+", "+t.serialize(q(e,2))+")"}},{name:"Delimiter",serialize:(t,e)=>{var o,a,l,h,d,y;const i=Se(e);if(i===0)return"";if(i===1)return`\\left( ${t.serialize(q(e,1))} \\right)`;let n="",r="\\left(",s="\\left)";i===2?n=(o=Ue(t,q(e,2)))!=null?o:"":i===3?(r=(a=Ue(t,q(e,2)))!=null?a:"",s=(l=Ue(t,q(e,3)))!=null?l:""):(r=(h=Ue(t,q(e,2)))!=null?h:"",n=(d=Ue(t,q(e,3)))!=null?d:"",s=(y=Ue(t,q(e,4)))!=null?y:"");const u=q(e,1);return n&&Z(u)==="Sequence"?`${r} ${fn(n)(t,u)} ${s}`:`${r} ${t.serialize(u)} ${s}`}},{name:"Error",serialize:(t,e)=>{const i=q(e,1),n=Be(i)==="Nothing"?"":t.serialize(i);if(Se(e)>=3){const r=q(e,3);if(r&&Z(r)==="LatexForm"){const s=gn(ui(q(r,1)));if(s)return`${n!=null?n:""}\\texttt{\\textcolor{red}{${s}}}`}}return n!=null?n:""}},{name:"FromLatex",serialize:(t,e)=>`\\texttt{${gn(ui(q(e,1)))}}`},{name:"LatexForm",serialize:Jn},{name:"LatexTokens",serialize:Yn},{kind:"matchfix",openDelimiter:"(",closeDelimiter:")",parse:(t,e)=>e===null?null:Z(e)==="Sequence"?Se(e)===0?["Delimiter","Nothing"]:["Delimiter",...te(e)]:["Delimiter",e]},{name:"Sequence",trigger:[","],kind:"infix",precedence:20,parse:(t,e,i)=>{if(e.minPrec>=20)return null;i==="Missing"&&(i="Nothing");const n=["Sequence",i];let r=!1;for(;!r;){for(r=!0,t.skipSpace();t.match(",");)n.push("Nothing"),t.skipSpace();if(t.atTerminator(e))n.push("Nothing");else{const s=t.matchExpression(ee(z({},e),{minPrec:20}));n.push(s!=null?s:"Nothing"),r=s===null}r||(t.skipSpace(),r=!t.match(","))}return n},serialize:fn()},{trigger:[";"],kind:"infix",precedence:19,parse:(t,e,i)=>{var r,s;if(e.minPrec>=19)return null;i==="Missing"&&(i="Nothing");const n=["Sequence",...(r=Ft(i))!=null?r:["Sequence",i]];for(;;){for(t.skipSpace();t.match(",");)n.push("Nothing"),t.skipSpace();if(t.atEnd){n.push("Nothing");break}const u=t.matchExpression(ee(z({},e),{minPrec:19}));if(u===null){n.push("Nothing");break}if(n.push(...(s=Ft(u))!=null?s:["Sequence",u]),t.skipSpace(),!t.match(","))break}return n}},{name:"String",trigger:["\\text"],parse:t=>Ot(t),serialize:(t,e)=>{const i=te(e);return i===null||i.length===0?"\\text{}":X(["\\text{",i.map(n=>t.serialize(n)).join(""),"}"])}},{name:"Subscript",trigger:["_"],kind:"infix",serialize:(t,e)=>Se(e)===2?t.serialize(q(e,1))+"_{"+t.serialize(q(e,2))+"}":"_{"+t.serialize(q(e,1))+"}"},{name:"Superplus",trigger:["^","+"],kind:"postfix"},{name:"Subplus",trigger:["_","+"],kind:"postfix"},{name:"Superminus",trigger:["^","-"],kind:"postfix"},{name:"Subminus",trigger:["_","-"],kind:"postfix"},{trigger:["^","*"],kind:"postfix",parse:(t,e)=>["Superstar",e]},{name:"Superstar",trigger:["^","\\star"],kind:"postfix"},{trigger:["_","*"],kind:"postfix",parse:(t,e)=>["Substar",e]},{name:"Substar",trigger:["_","\\star"],kind:"postfix"},{name:"Superdagger",trigger:["^","\\dagger"],kind:"postfix"},{trigger:["^","\\dag"],kind:"postfix",parse:(t,e)=>["Superdagger",e]},{name:"Prime",trigger:["^","\\prime"],kind:"postfix"},{trigger:["^","\\doubleprime"],kind:"postfix",parse:(t,e)=>["Prime",e!=null?e:"Nothing",2]},{name:"Derivative",serialize:(t,e)=>{var r;const i=(r=W(q(e,1)))!=null?r:NaN;if(!isFinite(i))return"";const n=t.serialize(q(e,2));return i===1?n+"^{\\prime}":i===2?n+"^{\\doubleprime}":n+"^{("+Number(i).toString()+")}"}},{name:"Piecewise",trigger:"cases",kind:"environment",parse:t=>{var e;return["Piecewise",(e=t.matchTabular("cases"))!=null?e:"Nothing"]},serialize:(t,e)=>{if(Z(q(e,1))!=="List")return"";const i=te(q(e,1));let n="",r="";for(const s of i){n+=r;const u=q(s,1);if(u!==null){n+=t.serialize(u);const o=q(s,2);o!==null&&(n+="&"+t.serialize(o))}r="\\\\"}return"\\begin{cases}"+n+"\\end{cases}"}}];function Ot(t,e){var s,u,o;if(!t.match("<{>"))return"Nothing";const i=[];let n="",r=null;for(;!t.atEnd&&!t.match("<}>");)if(t.peek==="<{>")i.push(Ot(t));else if(t.match("\\textbf")&&t.match("<{>"))i.push(Ot(t,{"font-weight":"bold"}));else if(t.match("\\color")&&t.match("<{>")){const a=t.matchColor();a&&t.match("<}>")&&(r!==null&&n?i.push(["Style",n,{dict:r}]):n&&i.push(["String",n]),n="",r={color:a})}else if(t.match("<space>"))n+=" ";else if(t.match("<$>")){const a=t.index,l=(s=t.matchExpression())!=null?s:"Nothing";t.skipSpace(),t.match("<$>")?i.push(l):(n+="$",t.index=a)}else if(t.match("<$$>")){const a=t.index,l=(u=t.matchExpression())!=null?u:"Nothing";t.skipSpace(),t.match("<$$>")?i.push(l):(n+="$$",t.index=a)}else n+=(o=t.matchChar())!=null?o:"";return r!==null&&n?i.push(["Style",n,{dict:r}]):n&&i.push(["String",n]),e?["Style",["String",...i],{dict:e}]:["String",...i]}function Yn(t,e){return e===null?"":X(Qn(e,i=>{const n=ui(i);return n===null?t.serialize(i):n==="<{>"?"{":n==="<}>"?"}":n==="<$>"?"$":n==="<$$>"?"$$":n==="<space>"?" ":n}))}function Jn(t,e){return e===null?"":X(Qn(e,i=>{var n;return(n=ui(i))!=null?n:t.serialize(i)}))}function gn(t){return t===null?"":t.replace(/[{}\[\]\\:\-\$%]/g,e=>{var i;return(i={"{":"\\lbrace ","}":"\\rbrace ","[":"\\lbrack ","]":"\\rbrack ",":":"\\colon ","\\":"\\backslash "}[e])!=null?i:"\\"+e})}const Ms=[{name:"Overscript",trigger:["\\overset"],kind:"infix",precedence:700},{name:"Underscript",trigger:["\\underset"],kind:"infix",precedence:700},{name:"Increment",trigger:["+","+"],kind:"postfix",precedence:880},{name:"Decrement",trigger:["-","-"],kind:"postfix",precedence:880},{name:"PreIncrement",trigger:["+","+"],kind:"prefix",precedence:880},{name:"PreDecrement",trigger:["-","-"],kind:"prefix",precedence:880},{name:"Ring",trigger:["\\circ"],kind:"infix",precedence:265},{name:"Transpose",trigger:["^","T"],kind:"infix"},{name:"ConjugateTranspose",trigger:["^","H"],kind:"infix"},{name:"StringJoin",trigger:["\\lt","\\gt"],kind:"infix",precedence:780},{name:"Starstar",trigger:["\\star","\\star"],kind:"infix",precedence:780},{name:"PartialDerivative",trigger:["\\partial"],kind:"prefix",parse:t=>{var u,o;let e=!1,i="Nothing",n="Nothing";for(;!e;)t.skipSpace(),t.match("_")?n=t.matchRequiredLatexArgument():t.match("^")?i=t.matchRequiredLatexArgument():e=!0;const r=Ft(n);if(r&&(n=["List",...r]),!n||!i)return null;let s=(u=t.matchRequiredLatexArgument())!=null?u:"Nothing";return s!=="Nothing"&&(s=[s,...(o=t.matchArguments("enclosure"))!=null?o:"Nothing"]),["PartialDerivative",s,n,i]},serialize:(t,e)=>{let i="\\partial";const n=q(e,1),r=q(e,2),s=q(e,3);return r!==null&&r!=="Nothing"&&(Z(r)==="List"?i+="_{"+t.serialize(["Sequence",...te(r)])+"}":i+="_{"+t.serialize(r)+"}"),s!==null&&s!=="Nothing"&&(i+="^{"+t.serialize(s)+"}"),n!==null&&n!=="Nothing"&&(i+=t.serialize(n)),i},precedence:740},{name:"OverBar",trigger:["\\overline"],requiredLatexArg:1},{name:"UnderBar",trigger:["\\underline"],requiredLatexArg:1},{name:"OverVector",trigger:["\\vec"],requiredLatexArg:1},{name:"OverTilde",trigger:["\\tilde"],requiredLatexArg:1},{name:"OverHat",trigger:["\\hat"],requiredLatexArg:1},{name:"OverRightArrow",trigger:["\\overrightarrow"],requiredLatexArg:1},{name:"OverLeftArrow",trigger:["\\overleftarrow"],requiredLatexArg:1},{name:"OverRightDoubleArrow",trigger:["\\Overrightarrow"],requiredLatexArg:1},{name:"OverLeftHarpoon",trigger:["\\overleftharpoon"],requiredLatexArg:1},{name:"OverRightHarpoon",trigger:["\\overrightharpoon"],requiredLatexArg:1},{name:"OverLeftRightArrow",trigger:["\\overleftrightarrow"],requiredLatexArg:1},{name:"OverBrace",trigger:["\\overbrace"],requiredLatexArg:1},{name:"OverLineSegment",trigger:["\\overlinesegment"],requiredLatexArg:1},{name:"OverGroup",trigger:["\\overgroup"],requiredLatexArg:1},{trigger:["\\displaystyle"],parse:t=>{const e=t.matchArguments("group");return e===null?null:["Style",...e,["KeyValuePair","'display'","'block'"]]}},{trigger:["\\textstyle"],parse:t=>{const e=t.matchArguments("group");return e===null?null:["Style",...e,["KeyValuePair","'display'","'inline'"]]}},{trigger:["\\scriptstyle"],parse:t=>{const e=t.matchArguments("group");return e===null?null:["Style",...e,["KeyValuePair","'display'","'script'"]]}},{trigger:["\\scriptscriptstyle"],parse:t=>{const e=t.matchArguments("group");return e===null?null:["Style",...e,["KeyValuePair","'display'","'scriptscript'"]]}},{trigger:["\\tiny"],parse:t=>{const e=t.matchArguments("group");return e===null?null:["Style",...e,["KeyValuePair","'size'",1]]}},{trigger:["\\scriptsize"],parse:t=>{const e=t.matchArguments("group");return e===null?null:["Style",...e,["KeyValuePair","'size'",2]]}},{trigger:["\\footnotesize"],parse:t=>{const e=t.matchArguments("group");return e===null?null:["Style",...e,["KeyValuePair","'size'",3]]}},{trigger:["\\small"],parse:t=>{const e=t.matchArguments("group");return e===null?null:["Style",...e,["KeyValuePair","'size'",4]]}},{trigger:["\\normalsize"],parse:t=>{const e=t.matchArguments("group");return e===null?null:["Style",...e,["KeyValuePair","'size'",5]]}},{trigger:["\\large"],parse:t=>{const e=t.matchArguments("group");return e===null?null:["Style",...e,["KeyValuePair","'size'",6]]}},{trigger:["\\Large"],parse:t=>{const e=t.matchArguments("group");return e===null?null:["Style",...e,["KeyValuePair","'size'",7]]}},{trigger:["\\LARGE"],parse:t=>{const e=t.matchArguments("group");return e===null?null:["Style",...e,["KeyValuePair","'size'",8]]}},{trigger:["\\huge"],parse:t=>{const e=t.matchArguments("group");return e===null?null:["Style",...e,["KeyValuePair","'size'",9]]}},{trigger:["\\Huge"],parse:t=>{const e=t.matchArguments("group");return e===null?null:["Style",...e,["KeyValuePair","'size'",10]]}},{name:"Style",serialize:(t,e)=>{let i=t.serialize(q(e,1));const n=Un(q(e,2));if(n===null)return i;bi(n.display)==="block"?i=X(["{\\displaystyle",i,"}"]):bi(n.display)==="inline"?i=X(["{\\textstyle",i,"}"]):bi(n.display)==="script"?i=X(["{\\scriptstyle",i,"}"]):bi(n.display)==="scriptscript"&&(i=X(["{\\scriptscriptstyle",i,"}"]));const r=W(n.size);return r!==null&&r>=1&&r<=10&&(i=X(["{",{1:"\\tiny",2:"\\scriptsize",3:"\\footnotesize",4:"\\small",5:"\\normalsize",6:"\\large",7:"\\Large",8:"\\LARGE",9:"\\huge",10:"\\Huge"}[r],i,"}"])),i}},{trigger:["\\!"],parse:()=>["HorizontalSpacing","Nothing",-3]},{trigger:["\\ "],parse:()=>["HorizontalSpacing","Nothing",6]},{trigger:["\\:"],parse:()=>["HorizontalSpacing","Nothing",4]},{trigger:["\\enskip"],parse:()=>["HorizontalSpacing","Nothing",9]},{trigger:["\\quad"],parse:()=>["HorizontalSpacing","Nothing",18]},{trigger:["\\qquad"],parse:()=>["HorizontalSpacing","Nothing",36]},{trigger:["\\,"],parse:()=>["HorizontalSpacing","Nothing",3]},{trigger:["\\;"],parse:()=>["HorizontalSpacing","Nothing",5]},{trigger:["\\enspace"],parse:()=>["HorizontalSpacing","Nothing",9]},{name:"HorizontalSpacing",serialize:(t,e)=>{var i;if(Be(q(e,1))==="Nothing"){const n=W(q(e,2));return n===null?"":(i={"-3":"\\!",6:"\\ ",3:"\\,",4:"\\:",5:"\\;",9:"\\enspace",18:"\\quad",36:"\\qquad"}[n])!=null?i:""}return""}}];function H(t){return e=>{var u,o;let i=!1,n=0;if(e.skipSpace(),e.match("^")){if(e.skipSpace(),e.match("<{>")){e.skipSpace(),e.match("-")&&e.match("1")&&(i=!0);do e.match("\\doubleprime")&&(n+=2),e.match("\\prime")&&(n+=1),e.match("'")&&(n+=1);while(!e.match("<}>")&&!e.atEnd)}let a=!1;for(;!a;)e.skipSpace(),e.match("\\doubleprime")?n+=2:e.match("\\prime")||e.match("'")?n+=1:a=!0}let r=(o=(u={"\\arcsin":"Arcsin","\\arccos":"Arccos","\\arctan":"Arctan","\\arctg":"Arctan","\\arcctg":"Arctan","\\arcsec":"Arcsec","\\arccsc":" Arccsc","\\arsinh":"Arsinh","\\arcosh":"Arcosh","\\artanh":"Artanh","\\arcsech":"Arcsech","\\arccsch":"Arcsch","\\ch":"Cosh","\\cos":"Cos","\\cosec":"Csc","\\cosh":"Csch","\\cot":"Cot","\\cotg":"Cot","\\coth":"Coth","\\csc":"Csc","\\ctg":"Cot","\\cth":"Coth","\\sec":"Sec","\\sin":"Sin","\\sinh":"Sinh","\\sh":"Sinh","\\tan":"Tan","\\tanh":"Tanh","\\tg":"Tan","\\th":"Tanh"}[t!=null?t:""])!=null?u:t)!=null?o:"";i&&(r=["InverseFunction",r]),n>=1&&(r=["Derivative",n,r]);const s=e.matchArguments("implicit");return s===null?[r,"Nothing"]:[r,...s]}}const Fs=[{name:"Arcsin",trigger:["\\arcsin"],parse:H("Arcsin")},{name:"Arccos",trigger:["\\arccos"],parse:H("Arccos")},{name:"Arctan",trigger:["\\arctan"],parse:H("Arctan")},{trigger:["\\arctg"],parse:H("Arctan")},{name:"Arccot",trigger:["\\arcctg"],parse:H("Arccot")},{name:"Arcsec",trigger:["\\arcsec"],parse:H("Arcsec")},{name:"Arccsc",trigger:["\\arccsc"],parse:H("Arccsc")},{name:"Arsinh",trigger:["\\arsinh"],parse:H("Arsinh")},{name:"Arcosh",trigger:["\\arcosh"],parse:H("Arcosh")},{name:"Artanh",trigger:["\\artanh"],parse:H("Artanh")},{name:"Arsech",trigger:["\\arsech"],parse:H("Arsech")},{name:"Arcsch",trigger:["\\arcsch"],parse:H("Arcsch")},{trigger:["\\ch"],parse:H("Cosh")},{name:"Cosec",trigger:["\\cosec"],parse:H("Cosec")},{name:"Cosh",trigger:["\\cosh"],parse:H("Cosh")},{name:"Cot",trigger:["\\cot"],parse:H("Cot")},{trigger:["\\cotg"],parse:H("Cot")},{name:"Coth",trigger:["\\coth"],parse:H("Coth")},{name:"Csc",trigger:["\\csc"],parse:H("Csc")},{trigger:["\\ctg"],parse:H("Cot")},{trigger:["\\cth"],parse:H("Cotanh")},{name:"Sec",trigger:["\\sec"],parse:H("Sec")},{name:"Sinh",trigger:["\\sinh"],parse:H("Sinh")},{trigger:["\\sh"],parse:H("Sinh")},{name:"Tan",trigger:["\\tan"],parse:H("Tan")},{trigger:["\\tg"],parse:H("Tan")},{name:"Tanh",trigger:["\\tanh"],parse:H("Tanh")},{trigger:["\\th"],parse:H("Tanh")},{name:"Cos",trigger:["\\cos"],parse:H("Cos")},{name:"Sin",trigger:["\\sin"],parse:H("Sin")}],Os=[{name:"AlgebraicNumber",trigger:"\\bar\\Q"},{name:"ComplexNumber",trigger:["\\C"]},{trigger:"\\mathbb{C}",parse:"ComplexNumber"},{name:"ImaginaryNumber",trigger:["\\imaginaryI\\R"]},{name:"ExtendedComplexNumber",trigger:["\\bar\\C"]},{name:"EmptySet",trigger:["\\emptyset"]},{trigger:["\\varnothing"],parse:"EmptySet"},{name:"Integer",trigger:["\\Z"]},{trigger:"\\mathbb{Z}",parse:"Integer"},{name:"RationalNumber",trigger:["\\Q"]},{name:"RealNumber",trigger:["\\R"]},{name:"ExtendedRealNumber",trigger:["\\bar\\R"]},{name:"TranscendentalNumber",trigger:"\\R-\\bar\\Q"},{trigger:"\\R\\backslash\\bar\\Q",parse:"TranscendentalNumber"},{name:"NegativeNumber",trigger:"\\R^-"},{trigger:"\\R^{-}",parse:"NegativeNumber"},{trigger:"\\R_-",parse:"NegativeNumber"},{trigger:"\\R_{-}",parse:"NegativeNumber"},{trigger:"\\R^{\\lt}",parse:"NegativeNumber"},{name:"PositiveNumber",trigger:"\\R^+"},{trigger:"\\R^{+}",parse:"PositiveNumber"},{trigger:"\\R_+",parse:"PositiveNumber"},{trigger:"\\R_{+}",parse:"PositiveNumber"},{trigger:"\\R^{\\gt}",parse:"PositiveNumber"},{name:"NonPositiveNumber",trigger:"\\R^{0-}"},{trigger:"\\R^{-0}",parse:"NonPositiveNumber"},{trigger:"\\R^{\\leq}",parse:"NonPositiveNumber"},{name:"NegativeInteger",trigger:"\\Z^-"},{trigger:"\\Z^-",parse:"NegativeInteger"},{trigger:"\\Z^{-}",parse:"NegativeInteger"},{trigger:"\\Z_-",parse:"NegativeInteger"},{trigger:"\\Z_{-}",parse:"NegativeInteger"},{trigger:"\\Z^{\\lt}",parse:"NegativeInteger"},{name:"PositiveInteger",trigger:"\\Z^+"},{trigger:"\\Z^{+}",parse:"PositiveInteger"},{trigger:"\\Z_+",parse:"PositiveInteger"},{trigger:"\\Z_{+}",parse:"PositiveInteger"},{trigger:"\\Z^{\\gt}",parse:"PositiveInteger"},{trigger:"\\Z^{\\gt0}",parse:"PositiveInteger"},{trigger:"\\N^+",parse:"PositiveInteger"},{trigger:"\\N^{+}",parse:"PositiveInteger"},{trigger:"\\N^*",parse:"PositiveInteger"},{trigger:"\\N^{*}",parse:"PositiveInteger"},{trigger:"\\N^\\star",parse:"PositiveInteger"},{trigger:"\\N^{\\star}",parse:"PositiveInteger"},{trigger:"\\N_1",parse:"PositiveInteger"},{trigger:"\\N_{1}",parse:"PositiveInteger"},{name:"NonNegativeInteger",trigger:["\\N"]},{trigger:"\\Z^{+0}",parse:"NonNegativeInteger"},{trigger:"\\Z^{\\geq}",parse:"NonNegativeInteger"},{trigger:"\\Z^{\\geq0}",parse:"NonNegativeInteger"},{trigger:"\\Z^{0+}",parse:"NonNegativeInteger"},{trigger:"\\mathbb{N}",parse:"NonNegativeInteger"},{trigger:"\\N_0",parse:"NonNegativeInteger"},{trigger:"\\N_{0}",parse:"NonNegativeInteger"},{name:"CartesianProduct",trigger:["\\times"],kind:"infix",associativity:"right",precedence:390,parse:(t,e,i)=>{if(390<e.minPrec)return null;const n=t.computeEngine;if(!n||!n.box(i).valueDomain.isSubdomainOf("Set"))return null;const r=t.index,s=t.matchExpression(ee(z({},e),{minPrec:390}));return s===null||n.box(i).valueDomain.isSubdomainOf("Set")!==!0?(t.index=r,null):["CartesianProduct",i,s]}},{name:"Complement",trigger:["^","\\complement"],kind:"infix"},{name:"Intersection",trigger:["\\cap"],kind:"infix",precedence:350},{name:"Interval",serialize:bt},{name:"Multiple",serialize:bt},{name:"Union",trigger:["\\cup"],kind:"infix",precedence:350},{name:"Range",serialize:bt},{name:"SetMinus",trigger:["\\setminus"],kind:"infix",precedence:650},{name:"SymmetricDifference",trigger:["\\triangle"],kind:"infix",precedence:260},{trigger:["\\ni"],kind:"infix",associativity:"right",precedence:160,parse:(t,e,i)=>{const n=t.matchExpression(e);return n===null?null:["Element",n,i]}},{name:"Element",trigger:["\\in"],kind:"infix",precedence:240},{name:"NotElement",trigger:["\\notin"],kind:"infix",precedence:240},{name:"NotSubset",trigger:["\\nsubset"],kind:"infix",associativity:"right",precedence:240},{name:"NotSuperset",trigger:["\\nsupset"],kind:"infix",associativity:"right",precedence:240},{name:"NotSubsetNotEqual",trigger:["\\nsubseteq"],kind:"infix",associativity:"right",precedence:240},{name:"NotSupersetNotEqual",trigger:["\\nsupseteq"],kind:"infix",associativity:"right",precedence:240},{name:"SquareSubset",trigger:["\\sqsubset"],kind:"infix",associativity:"right",precedence:265},{name:"SquareSubsetEqual",trigger:["\\sqsubseteq"],kind:"infix",associativity:"right",precedence:265},{name:"SquareSuperset",trigger:["\\sqsupset"],kind:"infix",associativity:"right",precedence:265},{name:"SquareSupersetEqual",trigger:["\\sqsupseteq"],kind:"infix",associativity:"right",precedence:265},{name:"Subset",trigger:["\\subset"],kind:"infix",associativity:"right",precedence:240},{trigger:["\\subsetneq"],kind:"infix",associativity:"right",precedence:240,parse:"Subset"},{trigger:["\\varsubsetneqq"],kind:"infix",associativity:"right",precedence:240,parse:"Subset"},{name:"SubsetEqual",trigger:["\\subseteq"],kind:"infix",precedence:240},{name:"Superset",trigger:["\\supset"],kind:"infix",associativity:"right",precedence:240},{trigger:["\\supsetneq"],kind:"infix",associativity:"right",precedence:240,parse:"Superset"},{trigger:["\\varsupsetneq"],kind:"infix",associativity:"right",precedence:240,parse:"Superset"},{name:"SupersetEqual",trigger:["\\supseteq"],kind:"infix",associativity:"right",precedence:240}];function bt(t,e){if(e===null)return"";const i=Z(e);return i===null?"":i==="Set"?Se(e)===0?"\\emptyset":Se(e)===2&&Z(q(e,2))==="Condition"?X(["\\left\\lbrace",t.serialize(q(e,1)),"\\middle\\mid",t.serialize(q(e,2)),"\\right\\rbrace"]):X(["\\left\\lbrace",...te(e).map(n=>t.serialize(n)+" ,"),"\\right\\rbrace"]):(t.numericSetStyle(e,t.level),"")}const pn=[["Alpha","\\alpha",945],["Beta","\\beta",946],["Delta","\\delta",948],["Epsilon","\\epsilon",949],["EpsilonSymbol","\\varepsilon",1013],["Zeta","\\zeta",950],["Eta","\\eta",951],["Theta","\\theta",952],["ThetaSymbol","\\vartheta",977],["Iota","\\iota",953],["Kappa","\\kappa",954],["KappaSymbol","\\varkappa",1008],["Lambda","\\lambda",955],["Mu","\\mu",956],["Nu","\\nu",957],["Xi","\\xi",958],["Omicron","\\omicron",959],["PiSymbol","\\varpi",982],["Rho","\\rho",961],["RhoSymbol","\\varrho",1009],["Sigma","\\sigma",963],["FinalSigma","\\varsigma",962],["Tau","\\tau",964],["Phi","\\phi",981],["PhiLetter","\\varphi",966],["Upsilon","\\upsilon",965],["Chi","\\chi",967],["Psi","\\psi",968],["Omega","\\omega",969],["CapitalAlpha","\\Alpha",913],["CapitalBeta","\\Beta",914],["CapitalGamma","\\Gamma",915],["CapitalDelta","\\Delta",916],["CapitalEpsilon","\\Epsilon",917],["CapitalZeta","\\Zeta",918],["CapitalEta","\\Eta",919],["CapitalTheta","\\Theta",920],["CapitaIota","\\Iota",921],["CapitalKappa","\\Kappa",922],["CapitalLambda","\\Lambda",923],["CapitalMu","\\Mu",924],["CapitalNu","\\Nu",925],["CapitalXi","\\Xi",926],["CapitalOmicron","\\Omicron",927],["CapitalPi","\\Pi",928],["CapitalRho","\\Rho",929],["CapitalSigma","\\Sigma",931],["CapitalTau","\\Tau",932],["CapitalPhi","\\Phi",934],["CapitalUpsilon","\\Upsilon",933],["CapitalChi","\\Chi",935],["CapitalPsi","\\Psi",936],["CapitalOmega","\\Omega",937],["Digamma","\\digamma",989],["Alef","\\aleph",8501],["Bet","\\beth",8502],["Gimel","\\gimel",8503],["Dalet","\\daleth",8504],["TurnedCapitalF","\\Finv",8498],["TurnedCapitalG","\\Game",8513],["Weierstrass","\\wp",8472],["Eth","\\eth",240],["InvertedOhm","\\mho",8487],["BlackClubSuit","\\clubsuit",9827],["WhiteHeartSuit","\\heartsuit",9825],["BlackSpadeSuit","\\spadesuit",9824],["WhiteDiamondSuit","\\diamondsuit",9826],["Sharp","\\sharp",9839],["Flat","\\flat",9837],["Natural","\\natural",9838]],qs=[...pn.map(([t,e,i])=>({name:t,trigger:[e],parse:t})),...pn.map(([t,e,i])=>({trigger:[String.fromCodePoint(i)],parse:t}))],dn={"(":"(",")":")","[":"\\lbrack","]":"\\rbrack","{":"\\lbrace","}":"\\rbrace","<":"\\langle",">":"\\rangle","|":"\\vert","||":"\\Vert","\\lceil":"\\lceil","\\lfloor":"\\lfloor","\\rceil":"\\rceil","\\rfloor":"\\rfloor"};function Ps(t){return Array.isArray(t)?t.length:1}function Vs(t,e){var s,u,o,a,l,h,d,y,N;if(!function(x,k){var P,I;const M=(I=(P=x.name)!=null?P:x.trigger)!=null?I:x.openDelimiter;if(x.serialize!==void 0&&!x.name)return k({severity:"warning",message:["invalid-dictionary-entry",M,"Unexpected serialize property without a name property"]}),!1;if(Zi(x)){if(x.trigger)return k({severity:"warning",message:["invalid-dictionary-entry",M,`Unexpected 'trigger' "${x.trigger}". 'matchfix' operators use a 'openDelimiter' and 'closeDelimiter' instead of a trigger. `]}),!1;if(!x.openDelimiter||!x.closeDelimiter)return k({severity:"warning",message:["invalid-dictionary-entry",M,"Expected `openDelimiter` and a `closeDelimiter` for matchfix operator"]}),!1;if(typeof x.openDelimiter!=typeof x.closeDelimiter)return k({severity:"warning",message:["invalid-dictionary-entry",M,"Expected `openDelimiter` and `closeDelimiter` to both be strings or array of LatexToken"]}),!1}if(ji(x)||At(x)||It(x)){if(Array.isArray(x.trigger)&&(x.trigger[0]==="_"||x.trigger[0]==="^")||typeof x.trigger=="string"&&(x.trigger.startsWith("^")||x.trigger.startsWith("_"))){if(x.precedence!==void 0||x.associativity!==void 0)return k({severity:"warning",message:["invalid-dictionary-entry",M,'Unexpected "precedence" or "associativity" for superscript/subscript operator']}),!1}else if(x.precedence===void 0)return k({severity:"warning",message:["invalid-dictionary-entry",M,`Expected a "precedence" for ${x.kind} operator`]}),!1}else if(x.associativity!==void 0)return k({severity:"warning",message:["invalid-dictionary-entry",M,'Unexpected "associativity" operator']}),!1;return kt(x)||x.optionalLatexArg===void 0&&x.requiredLatexArg===void 0?Zi(x)||x.trigger||x.name?x.parse!==void 0||x.name!==void 0||(k({severity:"warning",message:["invalid-dictionary-entry",M,"Expected a 'parse' or 'name'"]}),!1):(k({severity:"warning",message:["invalid-dictionary-entry",M,"Expected at least a 'trigger' or a 'name'"]}),!1):(k({severity:"warning",message:["invalid-dictionary-entry",M,'Unexpected "optionalLatexArg" or "requiredLatexArg" for non-symbol']}),!1)}(t,e))return[null,null];const i={name:t.name,kind:"kind"in t?t.kind:"symbol"};if(i.kind==="matchfix"&&Zi(t)){if(i.openDelimiter=t.openDelimiter,i.closeDelimiter=t.closeDelimiter,typeof t.serialize=="function")i.serialize=t.serialize;else{const x=typeof i.openDelimiter=="string"?dn[i.openDelimiter]:Me(i.openDelimiter),k=typeof i.closeDelimiter=="string"?dn[i.closeDelimiter]:Me(i.closeDelimiter);i.serialize=(M,P)=>X([x,M.serialize(P),k])}if(typeof t.parse=="function")i.parse=t.parse;else{const x=(s=t.parse)!=null?s:t.name;i.parse=(k,M)=>[x,M]}return[null,i]}if(i.kind==="environment"&&Wn(t)){const x=t.trigger;return i.serialize=(k,M)=>`\\begin{${x}${k.serialize(q(M,1))}\\end{${x}`,i.parse=(u=t.parse)!=null?u:()=>null,[x,i]}const n=typeof t.trigger=="string"?Qi(t.trigger,[]):t.trigger,r=n?Me(n):"";if(t.trigger,i.kind==="symbol"&&kt(t)&&(i.precedence=(o=t.precedence)!=null?o:1e4,i.optionalLatexArg=(a=t.optionalLatexArg)!=null?a:0,i.requiredLatexArg=(l=t.requiredLatexArg)!=null?l:0),i.kind!=="infix"&&i.kind!=="prefix"&&i.kind!=="postfix"||!(ji(t)||It(t)||At(t))||(!n||n[0]!=="^"&&n[0]!=="_"?i.precedence=(h=t.precedence)!=null?h:1e4:i.precedence=720),i.kind==="infix"&&ji(t))if(i.associativity=(d=t.associativity)!=null?d:"non",typeof t.parse=="function")i.parse=t.parse;else if(!n||n[0]!=="^"&&n[0]!=="_"){const x=(y=t.parse)!=null?y:t.name,k=i.precedence,M=i.associativity;i.parse=(P,I,D)=>{if(k<I.minPrec)return null;const V=P.matchExpression(ee(z({},I),{minPrec:k}));return typeof x!="string"?[x,D,V!=null?V:"Missing"]:Yi(x,D,V!=null?V:"Missing",M)}}else{const x=(N=t.parse)!=null?N:t.name;i.parse=(k,M,P)=>{var I,D;return[x,(I=q(P,1))!=null?I:"Missing",(D=q(P,2))!=null?D:"Missing"]}}else if(typeof t.parse=="function")i.parse=t.parse;else if(t.parse!==void 0)i.parse=()=>t.parse;else if(t.parse===void 0&&t.name!==void 0){if(i.kind==="postfix")i.parse=(x,k)=>k?[t.name,k]:null;else if(i.kind==="prefix"){const x=i.precedence,k=t.name;i.parse=(M,P)=>{if(x<P.minPrec)return null;const I=M.matchExpression(ee(z({},P),{minPrec:x}));return I===null?null:[k,I]}}}return typeof t.serialize=="function"||typeof t.serialize=="string"?i.serialize=t.serialize:n&&(i.kind==="postfix"?i.serialize="#1"+r:i.kind==="prefix"?i.serialize=r+"#1":i.kind==="infix"?i.serialize="#1"+r+"#2":i.kind==="symbol"?i.serialize=r:i.serialize=""),[n!=null?n:null,i]}const fi={algebra:[{name:"To",trigger:["\\to"],kind:"infix",precedence:270}],arithmetic:Is,calculus:[{name:"Integral",trigger:["\\int"],parse:function(t){var r;let e="Nothing",i="Nothing",n=!1;for(;!n;)t.skipSpace(),t.match("_")?i=t.matchRequiredLatexArgument():t.match("^")?e=t.matchRequiredLatexArgument():n=!0;return["Integral",(r=t.matchExpression({tokens:["d"]}))!=null?r:"",e!=null?e:"Nothing",i!=null?i:"Nothing"]},serialize:function(t,e){return""}}],core:As,logic:[{name:"True",trigger:["\\mathrm","<{>","T","r","u","e","<}>"],serialize:"\\mathrm{True}"},{name:"False",trigger:["\\mathrm","<{>","F","a","l","s","e","<}>"],serialize:"\\mathrm{False}"},{name:"Maybe",trigger:["\\mathrm","<{>","M","a","y","b","e","<}>"],serialize:"\\mathrm{Maybe}"}],relop:[{trigger:["!","<"],kind:"infix",associativity:"right",precedence:246,parse:"NotLess"},{name:"NotLess",trigger:["\\nless"],kind:"infix",associativity:"right",precedence:246},{trigger:["<"],kind:"infix",associativity:"right",precedence:245,parse:"Less"},{name:"Less",trigger:["\\lt"],kind:"infix",associativity:"right",precedence:245},{trigger:["<","="],kind:"infix",associativity:"right",precedence:241,parse:"LessEqual"},{name:"LessEqual",trigger:["\\le"],kind:"infix",associativity:"right",precedence:241},{trigger:["\\leq"],kind:"infix",associativity:"right",precedence:241,parse:"Equal"},{trigger:["\\leqslant"],kind:"infix",associativity:"right",precedence:265,parse:"LessEqual"},{name:"LessNotEqual",trigger:["\\lneqq"],kind:"infix",associativity:"right",precedence:260},{name:"NotLessNotEqual",trigger:["\\nleqq"],kind:"infix",associativity:"right",precedence:260},{name:"LessOverEqual",trigger:["\\leqq"],kind:"infix",associativity:"right",precedence:265},{name:"GreaterOverEqual",trigger:["\\geqq"],kind:"infix",associativity:"right",precedence:265,parse:"GreaterEqual"},{name:"Equal",trigger:["="],kind:"infix",associativity:"right",precedence:260},{trigger:["*","="],kind:"infix",associativity:"right",precedence:260,parse:"StarEqual"},{name:"StarEqual",trigger:["\\star","="],kind:"infix",associativity:"right",precedence:260},{name:"PlusEqual",trigger:["+","="],kind:"infix",associativity:"right",precedence:260},{name:"MinusEqual",trigger:["-","="],kind:"infix",associativity:"right",precedence:260},{name:"SlashEqual",trigger:["/","="],kind:"infix",associativity:"right",precedence:260},{name:"EqualEqual",trigger:["=","="],kind:"infix",associativity:"right",precedence:260},{name:"EqualEqualEqual",trigger:["=","=","="],kind:"infix",associativity:"right",precedence:265},{name:"TildeFullEqual",trigger:["\\cong"],kind:"infix",associativity:"right",precedence:260},{name:"NotTildeFullEqual",trigger:["\\ncong"],kind:"infix",associativity:"right",precedence:260},{trigger:[":","="],kind:"infix",associativity:"right",precedence:260,parse:"Assign"},{name:"Assign",trigger:["\\coloneq"],kind:"infix",associativity:"right",precedence:260},{name:"Approx",trigger:["\\approx"],kind:"infix",associativity:"right",precedence:247},{name:"NotApprox",trigger:["\\approx"],kind:"infix",associativity:"right",precedence:247},{name:"ApproxEqual",trigger:["\\approxeq"],kind:"infix",associativity:"right",precedence:260},{name:"NotApproxEqual",trigger:["!","\\approxeq"],kind:"infix",associativity:"right",precedence:250},{name:"NotEqual",trigger:["\\ne"],kind:"infix",associativity:"right",precedence:255},{name:"Unequal",trigger:["!","="],kind:"infix",associativity:"right",precedence:260},{name:"GreaterEqual",trigger:["\\ge"],kind:"infix",associativity:"right",precedence:242},{trigger:["\\geq"],kind:"infix",associativity:"right",precedence:242,parse:"GreaterEqual"},{trigger:[">","="],kind:"infix",associativity:"right",precedence:243,parse:"GreaterEqual"},{trigger:["\\geqslant"],kind:"infix",associativity:"right",precedence:265,parse:"GreaterEqual"},{name:"GreaterNotEqual",trigger:["\\gneqq"],kind:"infix",associativity:"right",precedence:260},{name:"NotGreaterNotEqual",trigger:["\\ngeqq"],kind:"infix",associativity:"right",precedence:260},{trigger:[">"],kind:"infix",associativity:"right",precedence:245,parse:"Greater"},{name:"Greater",trigger:["\\gt"],kind:"infix",associativity:"right",precedence:245},{name:"NotGreater",trigger:["\\ngtr"],kind:"infix",associativity:"right",precedence:244},{trigger:["!",">"],kind:"infix",associativity:"right",precedence:244,parse:"NotGreater"},{name:"RingEqual",trigger:["\\circeq"],kind:"infix",associativity:"right",precedence:260},{name:"TriangleEqual",trigger:["\\triangleq"],kind:"infix",associativity:"right",precedence:260},{name:"DotEqual",trigger:["\\doteq"],kind:"infix",associativity:"right",precedence:265},{name:"DotEqualDot",trigger:["\\doteqdot"],kind:"infix",associativity:"right",precedence:265},{name:"FallingDotEqual",trigger:["\\fallingdotseq"],kind:"infix",associativity:"right",precedence:265},{name:"RisingDotEqual",trigger:["\\fallingdotseq"],kind:"infix",associativity:"right",precedence:265},{name:"QuestionEqual",trigger:["\\questeq"],kind:"infix",associativity:"right",precedence:260},{name:"Equivalent",trigger:["\\equiv"],kind:"infix",associativity:"right",precedence:260},{trigger:["\\iff"],kind:"infix",parse:"Equivalent",associativity:"right",precedence:260},{name:"MuchLess",trigger:["\\ll"],kind:"infix",associativity:"right",precedence:260},{name:"MuchGreater",trigger:["\\gg"],kind:"infix",associativity:"right",precedence:260},{name:"Precedes",trigger:["\\prec"],kind:"infix",associativity:"right",precedence:260},{name:"Succeeds",trigger:["\\succ"],kind:"infix",associativity:"right",precedence:260},{name:"PrecedesEqual",trigger:["\\preccurlyeq"],kind:"infix",associativity:"right",precedence:260},{name:"SucceedsEqual",trigger:["\\curlyeqprec"],kind:"infix",associativity:"right",precedence:260},{name:"NotPrecedes",trigger:["\\nprec"],kind:"infix",associativity:"right",precedence:260},{name:"NotSucceeds",trigger:["\\nsucc"],kind:"infix",associativity:"right",precedence:260},{name:"Between",trigger:["\\between"],kind:"infix",associativity:"right",precedence:265}],other:Ms,physics:[{name:"mu-0",trigger:"\\mu_0"}],sets:Os,symbols:qs,trigonometry:Fs},Cs={"(":["\\lparen","("],")":["\\rparen",")"],"[":["\\lbrack"],"]":["\\rbrack"],"<":["<","\\langle"],">":[">","\\rangle"],"{":["\\{","\\lbrace"],"}":["\\}","\\rbrace"],":":[":","\\colon"],"|":["|","\\|","\\lvert","\\rvert"],"||":["||","\\Vert","\\lVert","\\rVert"],"\\lfloor":["\\lfloor"],"\\rfloor":["\\rfloor"],"\\lceil":["\\lceil"],"\\rceil":["\\rceil"],"\\ulcorner":["\\ulcorner"],"\\urcorner":["\\urcorner"],"\\llcorner":["\\llcorner"],"\\lrcorner":["\\lrcorner"],"\\lgroup":["\\lgroup"],"\\rgroup":["\\rgroup"],"\\lmoustache":["\\lmoustache"],"\\rmoustache":["\\rmoustache"]},Ds={":":[":","\\colon"],"|":["|","\\|","\\mid","\\mvert"]},Ls={"\\left":"\\right","\\bigl":"\\bigr","\\Bigl":"\\Bigr","\\biggl":"\\biggr","\\Biggl":"\\Biggr","\\big":"\\big","\\Big":"\\Big","\\bigg":"\\bigg","\\Bigg":"\\Bigg"},Ts=["\\middle","\\bigm","\\Bigm","\\biggm","\\Biggm","\\big","\\Big","\\bigg","\\Bigg"],bn={"(":")","[":"]","\\{":"\\}","\\lbrace":"\\rbrace","\\lparen":"\\rparen","\\langle":"\\rangle","\\lfloor":"\\rfloor","\\lceil":"\\rceil","\\vert":"\\vert","\\lvert":"\\rvert","\\Vert":"\\Vert","\\lVert":"\\rVert","\\lbrack":"\\rbrack","\\ulcorner":"\\urcorner","\\llcorner":"\\lrcorner","\\lgroup":"\\rgroup","\\lmoustache":"\\rmoustache"},Xn={precision:6,positiveInfinity:"\\infty",negativeInfinity:"-\\infty",notANumber:"\\operatorname{NaN}",decimalMarker:".",groupSeparator:"\\,",exponentProduct:"\\cdot",beginExponentMarker:"10^{",endExponentMarker:"}",notation:"auto",truncationMarker:"\\ldots",beginRepeatingDigits:"\\overline{",endRepeatingDigits:"}",imaginaryNumber:"\\imaginaryI",avoidExponentsInRange:[-7,20]},er={applyInvisibleOperator:"auto",skipSpace:!0,parseArgumentsOfUnknownLatexCommands:!0,parseNumbers:!0,parseUnknownSymbol:t=>/^[fg]$/.test(t)?"function":/^[a-zA-Z]+$/.test(t)?"symbol":"unknown",preserveLatex:!0};class Gt{constructor(e,i,n,r,s){this.index=0,this._lastPeek="",this._peekCounter=0,this.options=z(z(z({},Xn),er),i),this.engine=r,this._tokens=e,this.onError=s,this._dictionary=n}updateOptions(e){for(const[i,n]of Object.entries(e))this.options[i]=n}clone(e,i){return new Gt(this._tokens.slice(e,i),this.options,this._dictionary,this.engine,this.onError)}get atEnd(){return this.index>=this._tokens.length}get peek(){if(this._tokens[this.index]===this._lastPeek?this._peekCounter+=1:this._peekCounter=0,this._peekCounter>=1024)throw Error(`Infinite loop detected while parsing "${this.latex(0)}" at ${this._lastPeek} (index ${this.index})`);return this._lastPeek=this._tokens[this.index],this._tokens[this.index]}atTerminator(e){const i=this.index;return!!this.atEnd||!!e&&(!(!e.condition||!e.condition(this))||!!(e.tokens&&e.tokens.length>0&&this.matchAll(e.tokens))&&(this.index=i,!0))}latex(e,i){return Me(this._tokens.slice(e,i))}latexAhead(e){return Me(this._tokens.slice(this.index,this.index+e))}latexBefore(){return this.latex(0,this.index)}latexAfter(){return this.latex(this.index)}lookAhead(){let e=Math.min(this._dictionary.lookahead,this._tokens.length-this.index);const i=[];for(;e>0;)i[e]=this.latexAhead(e--);return i}peekDefinitions(e){let i;i=e==="operator"?this.lookAhead().map((r,s)=>{var u,o,a,l,h;return(h=(a=(u=this._dictionary.infix[s])==null?void 0:u.get(r))!=null?a:(o=this._dictionary.postfix[s])==null?void 0:o.get(r))!=null?h:(l=this._dictionary.prefix[s])==null?void 0:l.get(r)}):this.lookAhead().map((r,s)=>{var u;return(u=this._dictionary[e][s])==null?void 0:u.get(r)});const n=[];for(let r=i.length;r>0;r--)if(i[r]!==void 0)for(const s of i[r])n.push([s,r]);return n.length===0?null:n}next(){return this._tokens[this.index++]}skipSpace(){if(!this.atEnd&&this.peek==="<{>"&&this._tokens[this.index+1]==="<}>")return this.index+=2,this.skipSpace(),!0;let e=!1;if(!this.options.skipSpace)return!1;for(;this.match("<space>");)e=!0;return e&&this.skipSpace(),e}matchChar(){var n;const e=this.index;let i=0;for(;this.match("^");)i+=1;if(i>=2){let r="",s=0;for(;s!=i;){const u=this.matchAny(["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f"]);if(!u)break;r+=u,s+=1}if(r.length===i)return String.fromCodePoint(Number.parseInt(r,16))}else{if(this.match("\\char")){let r=Math.floor((n=this.matchLatexNumber())!=null?n:NaN);return(!Number.isFinite(r)||r<0||r>1114111)&&(r=10067),String.fromCodePoint(r)}if(this.match("\\unicode"))if(this.peek==="<{>"){const r=this.matchLatexNumber();if(this.match("<}>")&&r!==null&&r>=0&&r<=1114111)return String.fromCodePoint(r)}else{const r=this.matchLatexNumber();if(r!==null&&r>=0&&r<=1114111)return String.fromCodePoint(r)}}return this.index=e,this.next()}matchColor(e=!1){let i="";for(;!this.atEnd&&this.peek!=="}";)i+=this.next();return i}matchLatexDimension(){return null}match(e){return this._tokens[this.index]===e&&(this.index++,!0)}matchAll(e){typeof e=="string"&&(e=[e]);let i=!0,n=0;do i=this._tokens[this.index+n]===e[n++];while(i&&n<e.length);return i&&(this.index+=n),i}matchAny(e){return e.includes(this._tokens[this.index])?this._tokens[this.index++]:""}matchWhile(e){const i=[];for(;e.includes(this._tokens[this.index]);)i.push(this._tokens[this.index++]);return i}matchSign(){let e=!1,i=!1;for(;!i;)this.skipSpace()?i=!1:this.matchAny(["-","\u2212"])?(e=!e,i=!1):i=!this.matchAny(["+","\uFE62"]);return e?"-":"+"}matchDecimalDigits(){let e="",i=!1;for(;!i;)if(e+=this.matchWhile(["0","1","2","3","4","5","6","7","8","9"]).join(""),i=!0,this.options.groupSeparator){const n=this.index;this.skipSpace(),this.match(this.options.groupSeparator)&&(this.skipSpace(),/[0-9]/.test(this.peek)?i=!1:this.index=n)}return e}matchSignedInteger(){const e=this.index,i=this.matchSign(),n=this.matchDecimalDigits();return n?(i==="-"?"-":"")+n:(this.index=e,"")}matchExponent(){const e=this.index;let i="";if(this.matchAny(["e","E"])){const n=this.matchSignedInteger();n&&(i="e"+n)}if(i)return i;if(this.match("\\times")&&(this.skipSpace(),this.match("1")&&this.match("0")&&this.match("^"))){if(/[0-9]/.test(this.peek))return"e"+this.next();if(this.match("<{>")){this.skipSpace();const n=this.matchSignedInteger();if(this.skipSpace(),this.match("<}>")&&n)return"e"+n}}return this.index=e,""}matchNumber(){var r,s;if(!this.options.parseNumbers)return"";const e=this.index;this.skipSpace(),this.match("+");let i=!1;if(this.match(this.options.decimalMarker)){const u=this.index;if(!this.matchAny(["0","1","2","3","4","5","6","7","8","9"]))return this.index=e,"";this.index=u,i=!0}let n=this.matchDecimalDigits();return n?(!i&&this.match((r=this.options.decimalMarker)!=null?r:"")&&(n+="."+((s=this.matchDecimalDigits())!=null?s:"0")),(i?"0.":"")+n+this.matchExponent()):(this.index=e,"")}matchLatexNumber(e=!0){var a,l;let i=!1,n=this.peek;for(;n==="<space>"||n==="+"||n==="-";)n==="-"&&(i=!i),this.next(),n=this.peek;let r=10,s=["0","1","2","3","4","5","6","7","8","9"];if(this.match("'"))r=8,s=["0","1","2","3","4","5","6","7"],e=!0;else if(this.match('"')||this.match("x"))r=16,s=["0","1","2","3","4","5","6","7","8","9","A","B","C","D","E","F"],e=!0;else if(this.match("`"))return n=this.next(),n?n.startsWith("\\")&&n.length===2?(i?-1:1)*((a=n.codePointAt(1))!=null?a:0):(i?-1:1)*((l=n.codePointAt(0))!=null?l:0):null;let u="";for(;s.includes(this.peek);)u+=this.next();if(!e&&this.match("."))for(u+=".";s.includes(this.peek);)u+=this.next();const o=e?Number.parseInt(u,r):Number.parseFloat(u);return Number.isNaN(o)?null:i?-o:o}matchPrefixOperator(e){e||(e={minPrec:0}),e.minPrec||(e=ee(z({},e),{minPrec:0}));const i=this.peekDefinitions("prefix");if(i===null)return null;const n=this.index;for(const[r,s]of i){this.index=n+s;const u=r.parse(this,e);if(u)return u}return this.index=n,null}matchInfixOperator(e,i){i||(i={minPrec:0}),i.minPrec||(i=ee(z({},i),{minPrec:0}));const n=this.peekDefinitions("infix");if(n===null)return null;const r=this.index;for(const[s,u]of n)if(s.precedence>=i.minPrec){this.index=r+u;const o=s.parse(this,i,e);if(o)return o}return this.index=r,null}matchArguments(e){if(!e)return null;const i=this.index,n=this.matchEnclosure();if(e==="enclosure"&&Z(n)==="Delimiter")return te(n);if(e==="group"){const r=this.matchExpression({tokens:["<}>"]});return r===null?[]:[r]}if(e==="implicit"){if(Z(n)==="Delimiter")return te(n);if(n!==null)return[n];const r=this.matchPrimary();return r!==null?[r]:null}return this.index=i,null}matchOpenDelimiter(e,i){var o;const n=this.index,r=Ls[this.peek];r&&this.next();const s=(o=Cs[e])!=null?o:[e],u=r?[r]:[];return s.includes("||")&&this.matchAll(["|","|"])?(u.push("|"),u.push("|"),u):s.includes(this.peek)?(bn[e]===i?u.push(bn[this.peek]):u.push(i),this.next(),u):(this.index=n,null)}matchMiddleDelimiter(e){var n;const i=(n=Ds[e])!=null?n:[e];if(Ts.includes(this.peek)){const r=this.index;return this.next(),i.includes(this.peek)?(this.next(),!0):(this.index=r,!1)}return!!i.include(this.peek)&&(this.next(),!0)}matchEnclosure(){const e=this._dictionary.matchfix;if(e.length===0)return null;const i=this.index;for(const n of e){if(this.index=i,Array.isArray(n.openDelimiter)){if(!this.matchAll(n.openDelimiter))continue;const u=this.matchExpression({tokens:n.closeDelimiter,minPrec:0});if(this.skipSpace(),!this.matchAll(n.closeDelimiter))continue;if(typeof n.parse=="function"){const o=n.parse(this,u!=null?u:"Nothing");if(o===null)continue;return o}return[n.name,u!=null?u:"Nothing"]}const r=this.matchOpenDelimiter(n.openDelimiter,n.closeDelimiter);if(r===null)continue;const s=this.matchExpression({minPrec:0,tokens:r});if(s&&this.matchAll(r)){if(typeof n.parse=="function"){const u=n.parse(this,s!=null?s:"Nothing");if(u===null)continue;return u}return[n.name,s]}}return this.index=i,null}matchSymbol(){var s,u;const e=this.index,i=this.peekDefinitions("symbol");if(i)for(const[o,a]of i){let l=null;if(this.index=e+a,typeof o.parse!="function"){if(o.optionalLatexArg===0&&o.requiredLatexArg===0)return o.name;{const h=[];let d=o.optionalLatexArg;for(;d!==0;){const N=this.matchOptionalLatexArgument();if(N===null)break;h.push(N),d-=1}d=o.requiredLatexArg;const y=[];for(;d!==0;){const N=this.matchRequiredLatexArgument();if(N===null)break;y.push(N),d-=1}return y.length===o.requiredLatexArg?[o.name,...y,...h]:o.name}}if(l=o.parse(this),l)return l}this.index=e;let n="";(this.matchAll(["\\operatorname","<{>"])||this.matchAll(["\\mathit","<{>"])||this.matchAll(["\\mathrm","<{>"]))&&(n=this.matchString({tokens:["<}>"]}),n&&this.match("<}>")||(this.index=e)),n||(n=this.next());const r=(u=(s=this.options).parseUnknownSymbol)==null?void 0:u.call(s,n,this);if(r==="symbol")return n;if(r==="function"){const o=this.matchEnclosure();return o===null?n:Z(o)!=="Delimiter"?null:[n,...te(o)]}return this.index=e,this.matchUnknownLatexCommand()}matchOptionalLatexArgument(){const e=this.index;if(this.skipSpace(),this.match("[")){const i=this.matchExpression();if(this.skipSpace(),this.match("]"))return i}return this.index=e,null}matchRequiredLatexArgument(){const e=this.index;if(this.skipSpace(),this.match("<{>")){const i=this.matchExpression({tokens:["<}>"]});return this.skipSpace(),this.match("<}>")?i:(this.index=e,null)}return/^[0-9]$/.test(this.peek)?parseInt(this.next()):/^[^\\#]$/.test(this.peek)?this.next():this.matchSymbol()||(this.index=e,null)}matchSupsub(e){var u,o,a;if(e===null)return null;const i=this.index;this.skipSpace();const n=[],r=[];for(;this.peek==="_"||this.peek==="^";){if(this.match("_")){let l=this.matchRequiredLatexArgument();!l&&this.match("<{>")&&(l=this.matchString({tokens:["<}>"]}),l&&this.match("<}>")),r.push(l!=null?l:"Missing")}else this.match("^")&&n.push((u=this.matchRequiredLatexArgument())!=null?u:"Missing");this.skipSpace()}if(n.length===0&&r.length===0)return this.index=i,e;let s=e;if(r.length>0){const l=(o=this._dictionary.infix[1])==null?void 0:o.get("_");if(l){const h=["Subscript",s,r.length===1?r[0]:["Sequence",...r]];for(const d of l)if(s=typeof d.parse=="function"?d.parse(this,{minPrec:0},h):h,s)break}}if(n.length>0){const l=(a=this._dictionary.infix[1])==null?void 0:a.get("^");if(l){const h=["Superscript",s,n.length===1?n[0]:["Sequence",...n]];for(const d of l)if(s=typeof d.parse=="function"?d.parse(this,{minPrec:0},h):h,s)break}}return s===null&&(this.index=i),s}matchPostfix(e){if(e===null)return null;const i=this.peekDefinitions("postfix");if(i===null)return null;const n=this.index;for(const[r,s]of i){this.index=n+s;const u=r.parse(this,e);if(u!==null)return u}return this.index=n,null}matchString(e){e.minPrec||(e=ee(z({},e),{minPrec:0}));let i="",n=this.atEnd;for(;!n;){const r=this.peek;r==="<space>"?i+=" ":r[0]==="\\"?(this.onError([{severity:"warning",message:"unexpected-command"}]),i+=this.next()):/^<(\$|\$\$)>$/.test(r)?n=!0:i+=this.next(),n=n||this.atTerminator(e)}return i}matchEnvironmentName(e,i){if(!this.match(e))return!1;const n=this.index;if(this.match("<{>")){const r=this.matchString({tokens:["<}>"]});if(this.match("<}>")&&r===i)return!0}return this.index=n,!1}matchTabular(e){const i=["List"],n={minPrec:0,tokens:["\\end","<{>",...e.split(""),"<}>"]};let r=["List"],s=null;for(;!this.atTerminator(n);)this.skipSpace(),this.match("&")?(r.push(s!=null?s:"Nothing"),s=null):this.match("\\\\")||this.match("\\cr")?(this.skipSpace(),this.matchOptionalLatexArgument(),s!==null&&r.push(s),i.push(r),r=["List"],s=null):s=this.matchExpression(ee(z({},n),{condition:u=>{const o=u.peek;return o==="&"||o==="\\\\"||o==="\\cr"}}));return s!==null&&r.push(s),r.length>1&&i.push(r),i}matchEnvironment(){if(!this.match("\\begin"))return null;const e=this.index;if(this.match("<{>")){const i=this.matchString({tokens:["<}>"]});if(this.match("<}>")){const n=this._dictionary.environment.get(i),r=n?n.parse(this,[],[]):this.matchTabular(i);if(this.skipSpace(),this.matchAll(["\\end","<{>",...i.split(""),"<}>"]),r!==null)return this.decorate(r,e)}}return this.index=e,null}applyInvisibleOperator(e,i){if(i===null||this.atTerminator(e)||this.options.applyInvisibleOperator===null)return null;const n=this.index,r=this.matchExpression(ee(z({},e),{minPrec:390}));if(r===null)return this.index=n,null;if(typeof this.options.applyInvisibleOperator=="function")return this.options.applyInvisibleOperator(this,i,r);const s=this.engine.box(r),u=Be(i);if(u&&this.engine&&this.engine.getFunctionDefinition(u)){let a=[];return a=s.head==="Delimiter"?s.op1.head==="Sequence"?[...s.op1.ops]:[s.op1]:[s],[u,...a.map(l=>l.json)]}const o=this.engine.box(i);if(o.isLiteral&&o.isInteger&&s.isLiteral){const[a,l]=s.rationalValue;if(a!==null&&l!==null)return["Add",i,r]}return(o.isMissing||o.symbol==="Nothing"||o.isNumber)&&(s.isMissing||s.symbol==="Nothing"||s.isNumber)?Yi("Multiply",i,r):(this.index=n,null)}matchUnknownLatexCommand(){const e=this.peek;if(!e||e[0]!=="\\")return null;this.next();const i=[];if(e==="\\operatorname"){if(this.match("<{>")){for(;!this.atEnd&&this.peek!=="<}>";)i.push(this.next());this.match("<}>")}else i.push(this.next());return i.length===0?["Error","Missing",{str:"syntax-error"},["LatexForm",{str:e}]]:["Error","Missing",{str:"unknown-command"},["LatexForm",{str:`${e}{${Me(i)}}`}]]}for(;this.match("[");){i.push("[");let n=0;for(;!this.atEnd&&n===0&&this.peek!=="]";)this.peek==="["&&(n+=1),this.peek==="]"&&(n-=1),i.push(this.next());this.match("]")&&i.push("]")}for(;this.match("<{>");){i.push("<{>");let n=0;for(;!this.atEnd&&n===0&&this.peek!=="<}>";)this.peek==="<{>"&&(n+=1),this.peek==="<}>"&&(n-=1),i.push(this.next());this.match("<}>")&&i.push("<}>")}return["Error","Missing",{str:"unknown-command"},["LatexForm",{str:`${e}${Me(i)}`}]]}matchPrimary(){let e=null;const i=this.index;if(this.match("<{>")?(e=this.matchExpression({tokens:["<}>"]}),this.match("<}>")):this.match("<}>"),e===null){const n=this.matchNumber();n&&(e={num:n})}if(e===null&&(e=this.matchEnclosure()),e===null&&(e=this.matchEnvironment()),e===null&&(e=this.matchSymbol()),e!==null){e=this.decorate(e,i);let n=null,r=this.index;do{if(n=this.matchPostfix(e),e=n!=null?n:e,this.index===r&&n!==null)break;r=this.index}while(n!==null)}return e!==null&&(e=this.matchSupsub(e)),this.decorate(e,i)}matchExpression(e){const i=this.index;e||(e={minPrec:0}),e.minPrec===void 0&&(e.minPrec=0),this.skipSpace();let n=this.matchPrefixOperator(ee(z({},e),{minPrec:0}));if(n===null&&(n=this.matchPrimary()),n){let r=!1;for(;!this.atTerminator(e)&&!r;){this.skipSpace();let s=this.matchInfixOperator(n,e);s===null&&this.peekDefinitions("operator")===null&&(s=this.applyInvisibleOperator(e,n)),s!==null?n=s:r=!0}}return this.decorate(n,i)}decorate(e,i){if(e===null)return null;if(!this.options.preserveLatex)return e;const n=this.latex(i,this.index);return Array.isArray(e)?e={latex:n,fn:e}:typeof e=="number"?e={latex:n,num:Number(e).toString()}:typeof e=="string"?e={latex:n,sym:e}:typeof e=="object"&&e!==null&&(e.latex=n),e}}function Qe(t,e){const i=t.length,n=t;t=t.slice(0,-1);for(let s=0;s<t.length-16;s++){const u=t.substring(0,s);for(let o=0;o<17;o++){const a=t.substring(s,s+o+1),l=Math.floor((t.length-u.length)/a.length);if(l>1&&(u+a.repeat(l+1)).startsWith(t))return a==="0"?u.replace(/(\d{3})/g,"$1"+e.groupSeparator):u.replace(/(\d{3})/g,"$1"+e.groupSeparator)+e.beginRepeatingDigits+a+e.endRepeatingDigits}}const r=i>e.precision-1;return t=n,r&&(t=t.substring(0,e.precision-1)),e.groupSeparator&&(t=t.replace(/(\d{3})/g,"$1"+e.groupSeparator)).endsWith(e.groupSeparator)&&(t=t.slice(0,-e.groupSeparator.length)),r?t+e.truncationMarker:t}function gi(t,e){var i;return t?e.beginExponentMarker?e.beginExponentMarker+t+((i=e.endExponentMarker)!=null?i:""):"10^{"+t+"}":""}class Rs{constructor(e,i,n){this.level=-1,this.options=e,e.invisibleMultiply&&(/#1/.test(e.invisibleMultiply)&&/#2/.test(e.invisibleMultiply)||n([{severity:"warning",message:["expected-argument","invisibleMultiply"]}])),this.onError=n,this.dictionary=i}updateOptions(e){for(const i of Object.keys(this.options))i in e&&(this.options[i]=e[i])}wrap(e,i){if(e===null)return"";if(i===void 0)return"("+this.serialize(e)+")";if(typeof e=="number"||Ki(e)||typeof e=="string"||jt(e))return this.serialize(e);const n=Z(e);if(typeof n=="string"&&n!=="Delimiter"){const r=this.dictionary.name.get(n);if(r&&(r.kind==="symbol"||r.kind==="prefix"||r.kind==="infix"||r.kind==="postfix")&&r.precedence<i)return this.wrapString(this.serialize(e),this.options.applyFunctionStyle(e,this.level))}return this.serialize(e)}wrapShort(e){if(e===null)return"";const i=this.serialize(e);return Z(e)==="Delimiter"||typeof e=="number"||Ki(e)||/(^(.|\\[a-zA-Z*]+))$/.test(i)?i:this.wrapString(i,this.options.groupStyle(e,this.level+1))}wrapString(e,i){return i==="none"?e:"("+e+")"}serializeSymbol(e,i){var s;const n=Z(e);if(!n)return typeof(i==null?void 0:i.serialize)=="string"?i.serialize:typeof(i==null?void 0:i.serialize)=="function"?i.serialize(this,e):(s=qt(Be(e),"upright."))!=null?s:"";const r=te(e);if(!i){if(typeof n=="string"&&n.length>0&&n[0]==="\\"){let u=n;for(const o of r)u+="{"+this.serialize(o)+"}";return u}return typeof n=="string"?`${qt(n,"upright.")}(${r.map(u=>this.serialize(u)).join(", ")})`:`\\operatorname{Apply}(${this.serialize(n)}, ${this.serialize(["List",...r])})`}if(i.requiredLatexArg>0){let u="",o="",a=0;for(;a<i.requiredLatexArg;)o+="{"+this.serialize(r[a++])+"}";for(;a<Math.min(r.length,i.optionalLatexArg+i.requiredLatexArg);){const l=this.serialize(r[1+a++]);l&&(u+="["+l+"]")}return i.serialize+(u+o)}return typeof i.serialize=="function"?i.serialize(this,e):this.options.applyFunctionStyle(e,this.level)==="none"?i.serialize+X(r.map(u=>this.serialize(u))):i.serialize+this.serialize(["Delimiter",...r])}serializeDictionary(e){return`\\left[\\begin{array}{lll}${Object.keys(e).map(i=>`\\textbf{${i}} & \\rightarrow & ${this.serialize(e[i])}`).join("\\\\")}\\end{array}\\right]`}serialize(e){if(e==null)return"";this.level+=1;try{const i=(()=>{const n=function(a,l){var x,k,M;if(a===null)return"";let h;if(typeof a=="number")h=a;else{if(typeof a!="object"||!("num"in a))return"";h=a.num}if(h===1/0||h==="Infinity"||h==="+Infinity")return l.positiveInfinity;if(h===-1/0||h==="-Infinity")return l.negativeInfinity;if(h==="NaN"||typeof h=="number"&&Number.isNaN(h))return l.notANumber;if(typeof h=="number")return l.notation==="engineering"?function(P,I){if(P===0)return"0";const D=Math.abs(P);let V=Math.round(Math.log10(D));V-=V%3,D>Math.pow(10,I.avoidExponentsInRange[0])&&D<Math.pow(10,I.avoidExponentsInRange[1])&&(V=0);const C=D/Math.pow(10,V);let j="";const $=C.toString().match(/^(.*)\.(.*)$/);($==null?void 0:$[1])&&$[2]&&(j=$[1]+I.decimalMarker+$[2]),I.groupSeparator&&(j=Qe(C.toExponential(),I));let Mi="";return V!==0&&(Mi=gi(V.toString(),I)),(P<0?"-":"")+j+Mi}(h,l):function(P,I){var $;let D,V=P.match(/^(.*)[e|E]([-+]?[0-9]+)$/i);(V==null?void 0:V[1])&&V[2]&&(D=gi(V[2],I));let C=($=V==null?void 0:V[1])!=null?$:P,j="";return V=(D?V[1]:P).match(/^(.*)\.(.*)$/),(V==null?void 0:V[1])&&V[2]&&(C=V[1],j=V[2]),I.groupSeparator&&(C=C.replace(/\B(?=(\d{3})+(?!\d))/g,I.groupSeparator),j=Qe(j,I)),j&&(j=I.decimalMarker+j),D?C!=="1"||j?C+j+I.exponentProduct+D:D:C+j}(h.toString(),l);if(/[0-9][nd]$/.test(h)&&(h=h.slice(0,-1)),h=h.replace(/[\u0009-\u000d\u0020\u00a0]/g,""),/\([0-9]+\)$/.test(h)){const[P,I,D]=(x=h.match(/(.+)\(([0-9]+)\)$/))!=null?x:[];h=I+D.repeat(Math.ceil(l.precision/D.length))}let d="";for(h[0]==="-"?(d="-",h=h.substring(1)):h[0]==="+"&&(h=h.substring(1));h[0]==="0";)h=h.substring(1);if(h.length===0)return d+"0";h[0]==="."&&(h="0"+h);let y="";if(h.indexOf(".")>=0){const P=h.match(/(\d*)\.(\d*)([e|E]([-+]?[0-9]*))?/);if(!P)return"";const I=P[1],D=P[2];if(y=(k=P[4])!=null?k:"",I==="0"){let V=0;for(;D[V]==="0"&&V<D.length;)V+=1;let C="";if(V<=4)C="0"+l.decimalMarker,C+=D.substring(0,V),C+=Qe(h.substring(C.length),l);else if(V+1>=l.precision)C="0",d="";else{C=h[V];const j=Qe(h.substring(V+1),l);j&&(C+=l.decimalMarker+j)}C!=="0"&&(!(h.length-1>l.precision)||l.endRepeatingDigits&&C.endsWith(l.endRepeatingDigits)||!l.truncationMarker||C.endsWith(l.truncationMarker)||(C+=l.truncationMarker),V>4&&(C+=l.exponentProduct+gi(""+(1-V),l))),h=C}else{h=I.replace(/\B(?=(\d{3})+(?!\d))/g,l.groupSeparator);const V=Qe(D,l);V&&(h+=l.decimalMarker+V)}}else if(h.length>l.precision){const P=h.length;if(P>l.avoidExponentsInRange[1]){let I=h[0];const D=Qe(h.substring(1),l);D&&(I+=l.decimalMarker+D,l.truncationMarker&&!I.endsWith(l.truncationMarker)&&l.endRepeatingDigits&&!I.endsWith(l.endRepeatingDigits)&&(I+=l.truncationMarker)),I!=="1"?I+=l.exponentProduct:I="",h=I+gi(""+(P-1),l)}}else{const P=h.match(/([0-9]*)\.?([0-9]*)([e|E]([-+]?[0-9]+))?/);P&&(h=P[1],P[2]&&(h+=l.decimalMarker+P[2]),y=(M=P[4])!=null?M:""),h=h.replace(/\B(?=(\d{3})+(?!\d))/g,l.groupSeparator)}const N=gi(y,l);return h==="1"&&N?d+N:(N&&(h=h+l.exponentProduct+N),d+h)}(e,this.options);if(n)return n;const r=ui(e);if(r!==null)return`\\text{${r}}`;const s=Be(e);if(s!==null){const a=this.dictionary.name.get(s);if((a==null?void 0:a.kind)==="symbol")return this.serializeSymbol(e,a)}const u=Un(e);if(u!==null)return this.serializeDictionary(u);const o=cn(e);if(o){if(o[0]==="\\"){const l=te(e);return l.length===0?o:o+"{"+l.map(h=>this.serialize(h)).filter(h=>!!h).join("}{")+"}"}const a=this.dictionary.name.get(o);if(a)return typeof a.serialize=="function"?a.serialize(this,e):a.kind==="infix"||a.kind==="postfix"||a.kind==="prefix"?function(l,h,d){let y="";const N=Se(h),x=cn(h);if(d.kind==="postfix")return N!==1&&l.onError([{severity:"warning",message:["postfix-operator-requires-one-operand",l.serializeSymbol(x)]}]),Li(d.serialize,[l.wrap(q(h,1),d.precedence)]);if(d.kind==="prefix")return N!==1&&l.onError([{severity:"warning",message:["prefix-operator-requires-one-operand",l.serializeSymbol(x)]}]),Li(d.serialize,[l.wrap(q(h,1),d.precedence+1)]);if(d.kind==="infix"){y=l.wrap(q(h,1),d.precedence);for(let k=2;k<N+1;k++){const M=q(h,k);M!==null&&(y=Li(d.serialize,[y,l.wrap(M,d.precedence)]))}}return y}(this,e,a):a.kind==="matchfix"?function(l,h,d){var y;return Li(d.serialize,[l.serialize((y=q(h,1))!=null?y:"Nothing")])}(this,e,a):a.kind==="symbol"?this.serializeSymbol(e,a):""}if(Array.isArray(e)||ci(e)||Be(e)!==null)return this.serializeSymbol(e);this.onError([{severity:"warning",message:["syntax-error",e?JSON.stringify(e):"undefined"]}])})();return this.level-=1,i!=null?i:""}catch{}return this.level-=1,""}applyFunctionStyle(e,i){return this.options.applyFunctionStyle(e,i)}groupStyle(e,i){return this.options.groupStyle(e,i)}rootStyle(e,i){return this.options.rootStyle(e,i)}fractionStyle(e,i){return this.options.fractionStyle(e,i)}logicStyle(e,i){return this.options.logicStyle(e,i)}powerStyle(e,i){return this.options.powerStyle(e,i)}numericSetStyle(e,i){return this.options.numericSetStyle(e,i)}}function Li(t,e){var n;let i=t;for(let r=0;r<e.length;r++){let s=(n=e[r])!=null?n:"";if(/[a-zA-Z*]/.test(s[0])){const u=i.match(RegExp("(.*)#"+Number(r+1).toString()));u&&/\\[a-zA-Z*]+/.test(u[1])&&(s=" "+s)}i=i.replace("#"+Number(r+1).toString(),s)}return i}const zs=["alpha","beta","gamma","Gamma","delta","Delta","epsilon","zeta","eta","theta","Theta","iota","kappa","lambda","Lambda","mu","nu","xi","Xi","pi","Pi","rho","sigma","Sigma","tau","upsilon","phi","Phi","varphi","chi","psi","Psi","omega","Omega","aleph","ast","blacksquare","bot","bullet","circ","diamond","times","top","square","star"];function qt(t,e="italic."){var s;if(t===null)return null;const i=t.match(/^(_+)(.*)/);if(i)return`\\text{${"\\_".repeat(i[1].length)+He(i[2])}}`;let n;[n,t]=function(u){const o=u.match(/^([a-zA-Z-]+\.)(.*)/);return o?[o[1],o[2]]:["",u]}(t);const r=He(t);return r.length!==1||n?(n||(n=e),((s={"upright.":"\\mathrm{_}","italic.":"\\mathit{_}","bold-italic.":"\\mathbf{\\mathit{_}}","script.":"\\mathscr{_}","calligraphic.":"\\mathcal{_}","bold-script.":"\\mathbf{\\mathscr{_}}","bold-calligraphic.":"\\mathbf{\\mathcal{_}}","fraktur.":"\\mathfrak{_}","gothic.":"\\mathfrak{_}","bold-gothic.":"\\mathbf{\\mathfrak{_}}","bold-fraktur.":"\\mathbf{\\mathfrak{_}}","sans-serif.":"\\mathsf{_}","bold-sans-serif.":"\\mathbf{\\mathsf{_}}","italic-sans-serif.":"\\mathit{\\mathsf{_}}","monospace.":"\\mathtt{_}","blackboard.":"\\mathbb{_}","double-struck.":"\\mathbb{_}"}[n])!=null?s:"\\mathit{_}").replace("_",r)):r}function He(t){const e=t.indexOf("_");if(e>0){const n=t.substring(0,e),r=t.substring(e+1);return r?r.startsWith('"')&&r.endsWith('"')?`${He(n)}_\\mathrm{${He(r.substring(1,-1))}}`:`${He(n)}_{${He(r)}}`:qt(n)+"\\_"}const i=t.match(/([^0-9]+?)([0-9]+)$/);return i?i[1].length===0?t:`${He(i[1])}_{${i[2]}}`:zs.includes(t)?"\\"+t:t=t.replace(/[{}\[\]\\:\-\$%]/g,n=>{var r;return(r={"{":"\\lbrace ","}":"\\rbrace ","[":"\\lbrack ","]":"\\rbrack ",":":"\\colon ","\\":"\\backslash ","-":'\\unicode{"2013}'}[n])!=null?r:"\\"+n})}const $s={invisibleMultiply:"",invisiblePlus:"",multiply:"\\times",missingSymbol:"\\placeholder{}",applyFunctionStyle:function(t,e){return"paren"},groupStyle:function(t,e){return"paren"},rootStyle:Xe,fractionStyle:Kn,logicStyle:function(t,e){return"boolean"},powerStyle:function(t,e){return"solidus"},numericSetStyle:function(t,e){return"compact"}};class Ji{constructor(e){var n,r;this.onError=(n=e.onError)!=null?n:s=>{if(typeof window!="undefined")for(const u of s);},this.computeEngine=e.computeEngine;const i=z({},e);delete i.dictionary,delete i.onError,this.options=z(z(z(z({},Xn),$s),er),i),this.dictionary=function(s,u){var a,l;const o={lookahead:1,name:new Map,symbol:[],infix:[],prefix:[],postfix:[],environment:new Map,matchfix:[]};for(const h of s){const[d,y]=Vs(h,u);if(y!==null){if(y.name!==void 0&&(o.name.has(y.name)&&u({severity:"warning",message:["invalid-dictionary-entry",y.name,"Duplicate definition"]}),o.name.set(y.name,y)),y.kind==="matchfix")o.matchfix.push(y);else if(y.kind==="environment"){const N=Me((a=h.trigger)!=null?a:"");o.environment.has(N)&&u({severity:"warning",message:["invalid-dictionary-entry",N,"Duplicate environment definition"]}),o.environment.set(N,y)}else if(d){const N=Me((l=h.trigger)!=null?l:""),x=Ps(d);if(o.lookahead=Math.max(o.lookahead,x),y.kind==="symbol"){o.symbol[x]===void 0&&(o.symbol[x]=new Map);const k=o.symbol[x];k.has(N)?k.get(N).push(y):k.set(N,[y])}else if(y.kind==="prefix"){o.prefix[x]===void 0&&(o.prefix[x]=new Map);const k=o.prefix[x];k.has(N)?k.get(N).push(y):k.set(N,[y])}else if(y.kind==="infix"){o.infix[x]===void 0&&(o.infix[x]=new Map);const k=o.infix[x];k.has(N)?k.get(N).push(y):k.set(N,[y])}else if(y.kind==="postfix"){o.postfix[x]===void 0&&(o.postfix[x]=new Map);const k=o.postfix[x];k.has(N)?k.get(N).push(y):k.set(N,[y])}}}}return o}((r=e.dictionary)!=null?r:Ji.getDictionary(),s=>this.onError([s]))}updateOptions(e){for(const i of Object.keys(this.options))i in e&&(this.options[i]=e[i]);this.serializer.updateOptions(e)}static getDictionary(e="all"){if(e==="all"){let i=[];for(const n of Object.keys(fi))fi[n]&&(i=[...i,...fi[n]]);return i}return fi[e]?[...fi[e]]:[]}parse(e){const i=new Gt(Qi(e,[]),this.options,this.dictionary,this.computeEngine,this.onError);let n=i.matchExpression();if(!i.atEnd){const r=[];for(;!i.atEnd;)r.push(i.next());n=["Error",n!=null?n:"Nothing",{str:"syntax-error"},["LatexForm",{str:Me(r)}]]}return n||(n="Nothing"),this.options.preserveLatex&&(Array.isArray(n)?n={latex:e,fn:n}:typeof n=="number"?n={latex:e,num:Number(n).toString()}:typeof n=="string"?n={latex:e,sym:n}:typeof n=="object"&&n!==null&&(n.latex=e)),n!=null?n:"Nothing"}serialize(e){return this.serializer.serialize(e)}get serializer(){return this._serializer||(this._serializer=new Rs(this.options,this.dictionary,this.onError)),this._serializer}}const yi=Math.log10(Math.pow(2,53)),vn=new Set([2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97,101,103,107,109,113,127,131,137,139,149,151,157,163,167,173,179,181,191,193,197,199,211,223,227,229,233,239,241,251,257,263,269,271,277,281,283,293,307,311,313,317,331,337,347,349,353,359,367,373,379,383,389,397,401,409,419,421,431,433,439,443,449,457,461,463,467,479,487,491,499,503,509,521,523,541,547,557,563,569,571,577,587,593,599,601,607,613,617,619,631,641,643,647,653,659,661,673,677,683,691,701,709,719,727,733,739,743,751,757,761,769,773,787,797,809,811,821,823,827,829,839,853,857,859,863,877,881,883,887,907,911,919,929,937,941,947,953,967,971,977,983,991,997,1009,1013,1019,1021,1031,1033,1039,1049,1051,1061,1063,1069,1087,1091,1093,1097,1103,1109,1117,1123,1129,1151,1153,1163,1171,1181,1187,1193,1201,1213,1217,1223,1229,1231,1237,1249,1259,1277,1279,1283,1289,1291,1297,1301,1303,1307,1319,1321,1327,1361,1367,1373,1381,1399,1409,1423,1427,1429,1433,1439,1447,1451,1453,1459,1471,1481,1483,1487,1489,1493,1499,1511,1523,1531,1543,1549,1553,1559,1567,1571,1579,1583,1597,1601,1607,1609,1613,1619,1621,1627,1637,1657,1663,1667,1669,1693,1697,1699,1709,1721,1723,1733,1741,1747,1753,1759,1777,1783,1787,1789,1801,1811,1823,1831,1847,1861,1867,1871,1873,1877,1879,1889,1901,1907,1913,1931,1933,1949,1951,1973,1979,1987,1993,1997,1999,2003,2011,2017,2027,2029,2039,2053,2063,2069,2081,2083,2087,2089,2099,2111,2113,2129,2131,2137,2141,2143,2153,2161,2179,2203,2207,2213,2221,2237,2239,2243,2251,2267,2269,2273,2281,2287,2293,2297,2309,2311,2333,2339,2341,2347,2351,2357,2371,2377,2381,2383,2389,2393,2399,2411,2417,2423,2437,2441,2447,2459,2467,2473,2477,2503,2521,2531,2539,2543,2549,2551,2557,2579,2591,2593,2609,2617,2621,2633,2647,2657,2659,2663,2671,2677,2683,2687,2689,2693,2699,2707,2711,2713,2719,2729,2731,2741,2749,2753,2767,2777,2789,2791,2797,2801,2803,2819,2833,2837,2843,2851,2857,2861,2879,2887,2897,2903,2909,2917,2927,2939,2953,2957,2963,2969,2971,2999,3001,3011,3019,3023,3037,3041,3049,3061,3067,3079,3083,3089,3109,3119,3121,3137,3163,3167,3169,3181,3187,3191,3203,3209,3217,3221,3229,3251,3253,3257,3259,3271,3299,3301,3307,3313,3319,3323,3329,3331,3343,3347,3359,3361,3371,3373,3389,3391,3407,3413,3433,3449,3457,3461,3463,3467,3469,3491,3499,3511,3517,3527,3529,3533,3539,3541,3547,3557,3559,3571,3581,3583,3593,3607,3613,3617,3623,3631,3637,3643,3659,3671,3673,3677,3691,3697,3701,3709,3719,3727,3733,3739,3761,3767,3769,3779,3793,3797,3803,3821,3823,3833,3847,3851,3853,3863,3877,3881,3889,3907,3911,3917,3919,3923,3929,3931,3943,3947,3967,3989,4001,4003,4007,4013,4019,4021,4027,4049,4051,4057,4073,4079,4091,4093,4099,4111,4127,4129,4133,4139,4153,4157,4159,4177,4201,4211,4217,4219,4229,4231,4241,4243,4253,4259,4261,4271,4273,4283,4289,4297,4327,4337,4339,4349,4357,4363,4373,4391,4397,4409,4421,4423,4441,4447,4451,4457,4463,4481,4483,4493,4507,4513,4517,4519,4523,4547,4549,4561,4567,4583,4591,4597,4603,4621,4637,4639,4643,4649,4651,4657,4663,4673,4679,4691,4703,4721,4723,4729,4733,4751,4759,4783,4787,4789,4793,4799,4801,4813,4817,4831,4861,4871,4877,4889,4903,4909,4919,4931,4933,4937,4943,4951,4957,4967,4969,4973,4987,4993,4999,5003,5009,5011,5021,5023,5039,5051,5059,5077,5081,5087,5099,5101,5107,5113,5119,5147,5153,5167,5171,5179,5189,5197,5209,5227,5231,5233,5237,5261,5273,5279,5281,5297,5303,5309,5323,5333,5347,5351,5381,5387,5393,5399,5407,5413,5417,5419,5431,5437,5441,5443,5449,5471,5477,5479,5483,5501,5503,5507,5519,5521,5527,5531,5557,5563,5569,5573,5581,5591,5623,5639,5641,5647,5651,5653,5657,5659,5669,5683,5689,5693,5701,5711,5717,5737,5741,5743,5749,5779,5783,5791,5801,5807,5813,5821,5827,5839,5843,5849,5851,5857,5861,5867,5869,5879,5881,5897,5903,5923,5927,5939,5953,5981,5987,6007,6011,6029,6037,6043,6047,6053,6067,6073,6079,6089,6091,6101,6113,6121,6131,6133,6143,6151,6163,6173,6197,6199,6203,6211,6217,6221,6229,6247,6257,6263,6269,6271,6277,6287,6299,6301,6311,6317,6323,6329,6337,6343,6353,6359,6361,6367,6373,6379,6389,6397,6421,6427,6449,6451,6469,6473,6481,6491,6521,6529,6547,6551,6553,6563,6569,6571,6577,6581,6599,6607,6619,6637,6653,6659,6661,6673,6679,6689,6691,6701,6703,6709,6719,6733,6737,6761,6763,6779,6781,6791,6793,6803,6823,6827,6829,6833,6841,6857,6863,6869,6871,6883,6899,6907,6911,6917,6947,6949,6959,6961,6967,6971,6977,6983,6991,6997,7001,7013,7019,7027,7039,7043,7057,7069,7079,7103,7109,7121,7127,7129,7151,7159,7177,7187,7193,7207,7211,7213,7219,7229,7237,7243,7247,7253,7283,7297,7307,7309,7321,7331,7333,7349,7351,7369,7393,7411,7417,7433,7451,7457,7459,7477,7481,7487,7489,7499,7507,7517,7523,7529,7537,7541,7547,7549,7559,7561,7573,7577,7583,7589,7591,7603,7607,7621,7639,7643,7649,7669,7673,7681,7687,7691,7699,7703,7717,7723,7727,7741,7753,7757,7759,7789,7793,7817,7823,7829,7841,7853,7867,7873,7877,7879,7883,7901,7907,7919]);function Ei(t,e){const i=function(s){if(s<=3)return{[s]:1};const u={};let o=!1;for(;!o;){if(s%2==0){u[2]?u[2]+=1:u[2]=1,s/=2;continue}if(s%3==0){u[3]?u[3]+=1:u[3]=1,s/=3;continue}if(s===1)return u;const a=Math.sqrt(s);o=!0;for(let l=6;l<=a+6;l+=6){if(s%(l-1)==0){u[l-1]?u[l-1]+=1:u[l-1]=1,s/=l-1,o=!1;break}if(s%(l+1)==0){u[l+1]?u[l+1]+=1:u[l+1]=1,s/=l+1,o=!1;break}}}return u[s]=1,u}(t);let n=1,r=1;for(const s of Object.keys(i)){const u=parseFloat(s);n*=Math.pow(u,Math.floor(i[s]/e)),r*=Math.pow(u,i[s]%e)}return[n,r]}function ir(t,e){if(t===0)return e;if(e===0||t===e)return t;if(!Number.isInteger(t)||!Number.isInteger(e))return NaN;for(;e!==0;)[t,e]=[e,t%e];return t<0?-t:t}function $e([t,e]){if(t===1||e===1)return[t,e];e<0&&([t,e]=[-t,-e]);const i=ir(t,e);return i<=1?[t,e]:[t/i,e/i]}const yn=[.9999999999998099,676.5203681218851,-1259.1392167224028,771.3234287776531,-176.6150291621406,12.507343278686905,-.13857109526572012,9984369578019572e-21,15056327351493116e-23],Nn=[.999999999999997,57.15623566586292,-59.59796035547549,14.13609797474174,-.4919138160976202,3399464998481188e-20,4652362892704857e-20,-9837447530487956e-20,.0001580887032249125,-.00021026444172410488,.0002174396181152126,-.0001643181065367639,8441822398385274e-20,-261908384015814e-19,3689918265953162e-21];function tr(t){if(t<0)return NaN;let e=Nn[0];for(let n=14;n>0;--n)e+=Nn[n]/(t+n);const i=t+4.7421875+.5;return .9189385332046727+(t+.5)*Math.log(i)-i+Math.log(e)-Math.log(t)}function Pt(t){if(t<.5)return Math.PI/(Math.sin(Math.PI*t)*Pt(1-t));if(t>100)return Math.exp(tr(t));t-=1;let e=yn[0];for(let n=1;n<9;n++)e+=yn[n]/(t+n);const i=t+7+.5;return 2.5066282746310002*Math.pow(i,t+.5)*Math.exp(-i)*e}function nr(t,e=10){let i=0;for(let n=0;n<t.length;n++){const r={" ":-1,"\xA0":-1,"\u2000":-1,"\u2001":-1,"\u2002":-1,"\u2003":-1,"\u2004":-1,"\u2005":-1,"\u2006":-1,"\u2007":-1,"\u2008":-1,"\u2009":-1,"\u200A":-1,"\u200B":-1,"\u202F":-1,"\u205F":-1,_:-1,",":-1,0:0,1:1,2:2,3:3,4:4,5:5,6:6,7:7,8:8,9:9,a:10,b:11,c:12,d:13,e:14,f:15,g:16,h:17,i:18,j:19,k:20,l:21,m:22,n:23,o:24,p:25,q:26,r:27,s:28,t:29,u:30,v:31,w:32,x:33,y:34,z:35}[t[n]];if(r!==-1){if(r===void 0)return[i,t.substring(n)];if(r>=e)return[i,t.substring(n)];i=i*e+r}}return[i,""]}class ye{constructor(e,i){this.engine=e,i!=null&&i.latex&&(this._latex=i.latex),i!=null&&i.wikidata&&(this._wikidata=i.wikidata)}toJSON(){return JSON.stringify(this.json)}toString(){return this.latex}valueOf(){var n,r,s;const[e,i]=this.rationalValue;return e!==null&&i!==null?[e,i]:(s=(r=(n=this.asFloat)!=null?n:this.string)!=null?r:this.symbol)!=null?s:this.toString()}is(e){return e!=null&&this.isSame(this.engine.box(e))}has(e){return!1}get description(){return[]}get url(){return""}_purge(){}get isPure(){return!1}get isLiteral(){return!1}get latex(){var e;return(e=this._latex)!=null?e:this.engine.serialize(this)}set latex(e){this._latex=e}get wikidata(){var e;return(e=this._wikidata)!=null?e:""}set wikidata(e){this._wikidata=e}get complexity(){return 1}get ops(){return null}get nops(){return 0}get op1(){return this.engine.symbol("Missing")}get op2(){return this.engine.symbol("Missing")}get op3(){return this.engine.symbol("Missing")}get symbolDefinition(){}get functionDefinition(){}_repairDefinition(){}get keys(){return null}get keysCount(){return 0}getKey(e){}hasKey(e){return!1}get machineValue(){var e,i;return(i=(e=this.numericValue)==null?void 0:e.machineValue)!=null?i:null}get rationalValue(){var e,i;return(i=(e=this.numericValue)==null?void 0:e.rationalValue)!=null?i:[null,null]}get decimalValue(){var e,i;return(i=(e=this.numericValue)==null?void 0:e.decimalValue)!=null?i:null}get complexValue(){var e,i;return(i=(e=this.numericValue)==null?void 0:e.complexValue)!=null?i:null}get asFloat(){var e,i;return(i=(e=this.numericValue)==null?void 0:e.asFloat)!=null?i:null}get asSmallInteger(){var e,i;return(i=(e=this.numericValue)==null?void 0:e.asSmallInteger)!=null?i:null}get asRational(){var e,i;return(i=(e=this.numericValue)==null?void 0:e.asRational)!=null?i:[null,null]}get sgn(){var e,i;return(i=(e=this.numericValue)==null?void 0:e.sgn)!=null?i:null}get symbol(){return null}get isMissing(){return!1}get value(){return this}set value(e){throw Error(`Can't change the value of \\(${this.latex}\\)`)}get numericValue(){}isSubdomainOf(e){}get domain(){return this.engine.domain("Nothing")}set domain(e){throw Error(`Can't change the domain of \\(${this.latex}\\)`)}get valueDomain(){return this.domain}get string(){return null}isLess(e){}isLessEqual(e){}isGreater(e){}isGreaterEqual(e){}get isZero(){}get isNotZero(){}get isPositive(){}get isNonNegative(){}get isNegative(){}get isNonPositive(){}get isInfinity(){}get isNaN(){}get isFinite(){}get isNumber(){}get isInteger(){}get isRational(){}get isAlgebraic(){return!1}get isReal(){}get isExtendedReal(){}get isComplex(){}get isImaginary(){}get isExtendedComplex(){}get isOne(){}get isNegativeOne(){}get isEven(){}get isOdd(){}get isPrime(){}get isComposite(){}get canonical(){return this}apply(e,i){return this}evaluate(e){return this.simplify(e)}simplify(e){return this}N(e){return this}replace(e){return null}subs(e){return this}solve(e){return null}}function rr(t,e){if(!e.isInteger()||e.isNegative())return t.DECIMAL_NAN;if(e.lessThan(10))return t.decimal([1,1,2,6,24,120,720,5040,40320,362880,3628800][e.toNumber()]);if(e.gt(Number.MAX_SAFE_INTEGER)){let s=t.DECIMAL_ONE,u=t.DECIMAL_TWO;for(;u.lessThan(e);)s=s.mul(u),u=u.add(1);return s}if(e.modulo(2).eq(1))return e.times(rr(t,e.minus(1)));let i=e.toNumber(),n=e,r=e;for(;i>2;)i-=2,n=n.add(i),r=r.mul(n);return r}function sr(t,e){if(e.isNegative())return t.DECIMAL_NAN;const i=t.cache("gamma-p-ln",()=>["0.99999999999999709182","57.156235665862923517","-59.597960355475491248","14.136097974741747174","-0.49191381609762019978","0.33994649984811888699e-4","0.46523628927048575665e-4","-0.98374475304879564677e-4","0.15808870322491248884e-3","-0.21026444172410488319e-3","0.2174396181152126432e-3","-0.16431810653676389022e-3","0.84418223983852743293e-4","-0.2619083840158140867e-4","0.36899182659531622704e-5"].map(u=>t.decimal(u)));let n=i[0];for(let u=i.length-1;u>0;--u)n=n.add(i[u].div(e.add(u)));const r=t.cache("gamma-g-ln",()=>t.decimal(607).div(128)),s=e.add(r).add(t.DECIMAL_HALF);return t.DECIMAL_NEGATIVE_ONE.acos().mul(t.DECIMAL_TWO).log().mul(t.DECIMAL_HALF).add(s.log().mul(e.add(t.DECIMAL_HALF)).minus(s).add(n.log()).minus(e.log()))}function ar(t,e){if(e.lessThan(t.DECIMAL_HALF)){const s=t.DECIMAL_NEGATIVE_ONE.acos();return s.div(s.mul(e).sin().mul(ar(t,t.DECIMAL_ONE.sub(e))))}if(e.greaterThan(100))return sr(t,e).exp();e=e.sub(1);const i=t.cache("lanczos-7-c",()=>["0.99999999999980993227684700473478","676.520368121885098567009190444019","-1259.13921672240287047156078755283","771.3234287776530788486528258894","-176.61502916214059906584551354","12.507343278686904814458936853","-0.13857109526572011689554707","9.984369578019570859563e-6","1.50563273514931155834e-7"].map(t.decimal));let n=i[0];for(let s=1;s<9;s++)n=n.add(i[s].div(e.add(s)));const r=e.add(7).add(t.DECIMAL_HALF);return t.DECIMAL_NEGATIVE_ONE.acos().times(t.DECIMAL_TWO).sqrt().mul(n.mul(r.neg().exp()).mul(r.pow(e.add(t.DECIMAL_HALF))))}function ki(t){return t.e<308&&t.e>-306}function re(t,e){var n;const i=[];for(const r of t)r.ops&&r.head===e?i.push(...(n=re(r.ops,e))!=null?n:r.ops):i.push(r);return i.length===t.length?null:i}function Xi(t){if(t.head==="Power"&&t.op2.isLiteral){const e=t.op2.asSmallInteger;return e!==null&&e>0?e:1}if(t.head==="Multiply"){let e=1;for(const i of t.ops){const n=Xi(i);n>1&&(e+=n)}return e}return 1}function xn(t){if(t.head==="Power"&&t.op2.isLiteral){const e=t.op2.asSmallInteger;return e!==null&&e>0?e:1}if(t.head==="Multiply"){let e=1;for(const i of t.ops)e=Math.max(e,Xi(i));return e}return 1}function Vt(t){return t.symbol?t.symbol:t.ops?t.ops.map(e=>Vt(e)).filter(e=>e.length>0).join('"'):""}function Ht(t){return typeof t=="string"&&t.startsWith("$")&&t.endsWith("$")}function xi(t){return typeof t=="string"&&t.startsWith("$")&&t.endsWith("$")?t.slice(1,-1):null}function Ct(t){var n;if(t.symbol==="ImaginaryUnit")return 1;const e=t.complexValue;if(e&&e.re===0)return e.im;if(t.head==="Negate")return-Ct(t.op1);let i=0;if(t.head==="Multiply"&&t.nops===2){let r;t.op1.symbol==="ImaginaryUnit"?r=t.op2:t.op2.symbol==="ImaginaryUnit"&&(r=t.op1),r&&r.isLiteral&&(i=(n=r.asFloat)!=null?n:0)}return i}function Ii(t){var i;if(t.symbol)return(i=t.symbolDefinition)!=null&&i.constant?[]:[t.symbol];if(!t.ops&&!t.keys)return[];const e=[];if(t.ops)for(const n of t.ops)e.push(...Ii(n));if(t.keys)for(const n of t.keys)e.push(...Ii(t.getKey(n)));return e}function pe(t){return t.numericMode==="decimal"||t.numericMode==="auto"&&t.precision>Math.floor(yi)}function Ze(t){return t.numericMode==="auto"||t.numericMode==="complex"}function be(t){let e=0;for(let i=0;i<t.length;i++)e=Math.imul(31,e)+t.charCodeAt(i)|0;return Math.abs(e)}function Bt(t,e){var i,n,r,s;if(t.isLiteral&&t.asFloat!==null)return e.isLiteral&&e.asFloat!==null?t.asFloat-e.asFloat:-1;if(t.isLiteral&&t.complexValue)return e.isLiteral&&e.complexValue?t.complexValue.re===e.complexValue.re?Math.abs(t.complexValue.im)===Math.abs(e.complexValue.im)?t.complexValue.im-e.complexValue.im:Math.abs(t.complexValue.im)-Math.abs(e.complexValue.im):t.complexValue.re-e.complexValue.re:e.isLiteral&&e.isNumber?1:-1;if(t.symbol)return e.symbol?t.symbol===e.symbol?0:t.symbol>e.symbol?1:-1:e.isLiteral&&e.isNumber?1:-1;if(t.ops){if(e.ops){const u=(n=(i=t.functionDefinition)==null?void 0:i.complexity)!=null?n:1e5,o=(s=(r=e.functionDefinition)==null?void 0:r.complexity)!=null?s:1e5;return u===o?typeof t.head=="string"&&typeof e.head=="string"?t.head===e.head?ei(t)-ei(e):t.head<e.head?1:-1:ei(t)-ei(e):u-o}return e.isLiteral&&e.isNumber||e.symbol?1:-1}if(t.string)return e.string?t.string.length!==e.string.length?e.string.length-t.string.length:e.string<t.string?-1:t.string>e.string?1:0:e.keys?-1:1;if(t.keys&&e.keys){if(t.keysCount!==e.keysCount)return e.keysCount-t.keysCount;let u=0,o=0;for(const a of e.keys)u+=e.getKey(a).complexity;for(const a of t.keys)o+=t.getKey(a).complexity;return o-u}return t.complexity-e.complexity}function ei(t){return t.keys!==null?1+t.keysCount:t.ops?(typeof t.head=="string"?1:ei(t.head))+[...t.ops].reduce((e,i)=>e+ei(i),0):1}function ii(t){var r;const e=t.engine;let i=1,n=1;if(t.head==="Multiply"){const s=[];for(const u of t.ops)if(u.isLiteral){const[o,a]=u.asRational;o!==null&&a!==null?(i*=o,n*=a):s.push(u)}else s.push(u);return[i,n]=$e([i,n]),i===n?[[1,1],t]:s.length===0?[[i,n],e.ONE]:s.length===1?[[i,n],s[0]]:[[i,n],e.mul(s)]}if(t.head==="Divide"){let[[s,u],o]=ii(t.op1);const[[a,l],h]=ii(t.op2),[d,y]=$e([s*l,a*u]);return o.isOne&&h.isOne?[[d,y],e.ONE]:h.isOne?[[d,y],o]:[[d,y],e.fn("Divide",[o,h]).canonical]}if(t.head==="Power"){if(!t.op2.isLiteral)return[[1,1],t];let[[s,u],o]=ii(t.op1);if(s===1&&u===1)return[[1,1],t];const a=t.op2,l=a.asSmallInteger;if(l!==null){if(l===-1)return[[u,s],e.inverse(o)];if(Math.log10(Math.abs(s))*Math.abs(l)<15&&Math.log10(Math.abs(u))*Math.abs(l)<15)return l>0?[[Math.pow(s,l),Math.pow(u,l)],e.power(o,a)]:[[Math.pow(u,-l),Math.pow(s,-l)],e.power(o,a)]}const[h,d]=a.rationalValue;if(h!==null&&d!==null&&s>0&&Math.abs(h)===1){const[y,N]=Ei(s,d),[x,k]=Ei(u,d);return y===1&&x===1?[[1,1],t]:[h===1?[y,x]:[x,y],e.power(e.mul([e.number([N,k]),o]),a)]}return[[1,1],t]}if(t.head==="Negate"){const[s,u]=ii(t.op1);return[[-s[0],s[1]],u]}if(t.isLiteral){if(t.decimalValue){if(t.decimalValue.isInteger()&&ki(t.decimalValue))return[[t.decimalValue.toNumber(),1],e.ONE];if((r=t.decimalValue)!=null&&r.isNegative())return[[-1,1],e.number(t.decimalValue.neg())]}if(t.machineValue!==null){if(Number.isInteger(t.machineValue))return[[t.machineValue,1],e.ONE];if(t.machineValue<0)return[[-1,1],e.number(-t.machineValue)]}const[s,u]=t.rationalValue;if(s!==null&&u!==null)return[[s,u],e.ONE];if(t.complexValue!==null){const o=t.complexValue;if(o.re<0)return[[-1,1],e.number(e.complex(-o.re,-o.im))]}}return[[1,1],t]}function _n(t){var r;if(t.head==="Negate")return[-1,t.op1];const e=t.engine;if(t.machineValue!==null&&t.machineValue<0)return[-1,e.number(-t.machineValue)];if((r=t.decimalValue)!=null&&r.isNegative())return[-1,e.number(t.decimalValue.neg())];if(t.complexValue!==null){const s=t.complexValue;if(s.re<0)return[-1,e.number(e.complex(-s.re,-s.im))]}const[i,n]=t.rationalValue;return i!==null&&n!==null&&i<0?[-1,e.number([-i,n])]:[1,t]}class Ai{constructor(e,i){if(this._terms=[],this._literal=[1,1],this._hasInfinity=!1,this._hasZero=!1,this.engine=e,i)for(const n of i)this.addTerm(n)}get isEmpty(){return this._hasInfinity===!1&&this._hasZero===!1&&this._literal[0]===this._literal[1]&&this._terms.length===0}addTerm(e){if(e.symbol==="Nothing")return;if(e.isLiteral){if(e.isOne)return;if(e.isZero)return void(this._hasZero=!0);if(e.isNegativeOne)return void(this._literal[0]*=-1);if(e.isInfinity)return this._hasInfinity=!0,void(e.isNegative&&(this._literal[0]*=-1))}let[i,n]=ii(e);if(this._literal=[this._literal[0]*i[0],this._literal[1]*i[1]],n.isLiteral&&n.isOne)return;let r=[1,1];if(n.head==="Power"&&n.op2.isLiteral){const[u,o]=n.op2.asRational;u!==null&&o!==null&&(r=[u,o],n=n.op1)}let s=!1;if(r[1]===1||n.isNonNegative){for(const u of this._terms)if(u.term.isSame(n)){const[o,a]=u.exponent,[l,h]=r;u.exponent=[o*h+a*l,a*h],s=!0;break}}s||this._terms.push({exponent:r,term:n})}groupedByDegrees(e){const i=this.engine,n=[],r=[];this._hasInfinity&&r.push(i.POSITIVE_INFINITY),this._literal=$e(this._literal),this._literal[0]===1&&this._literal[1]===1||(e!=null&&e.splitRational?(this._literal[0]!==1&&r.push(i.number(this._literal[0]).canonical),this._literal[1]!==1&&n.push({exponent:[-1,1],terms:[i.number(this._literal[1]).canonical]})):r.push(i.number(this._literal).canonical)),r.length>0&&n.push({exponent:[1,1],terms:r});for(const s of this._terms){if(s.exponent[0]===0)continue;let u=!1;for(const o of n)if(s.exponent[0]===o.exponent[0]&&s.exponent[1]===o.exponent[1]){o.terms.push(s.term),u=!0;break}u||n.push({exponent:$e(s.exponent),terms:[s.term]})}return n}terms(){return Ti(this.engine,this.groupedByDegrees())}asNumeratorDenominator(){var l,h;const e=this.groupedByDegrees(),i=[],n=[];for(const d of e)d.exponent[0]>=0?i.push(d):n.push({exponent:[-d.exponent[0],d.exponent[1]],terms:d.terms});const r=this.engine;let s=Ti(r,i);s=(l=re(s,"Multiply"))!=null?l:s;let u=r.ONE;s.length===1?u=s[0]:s.length>0&&(u=r._fn("Multiply",s));let o=Ti(r,n);o=(h=re(o,"Multiply"))!=null?h:o;let a=r.ONE;return o.length===1?a=o[0]:o.length>0&&(a=r._fn("Multiply",o)),[u,a]}asExpression(){var n;const e=this.engine;if(this._hasInfinity){if(this._hasZero)return e.NAN;if(this._terms.length===0)return this._literal[0]>0?e.POSITIVE_INFINITY:e.NEGATIVE_INFINITY}if(this._hasZero)return e.ZERO;if(this._terms.length===0)return e.number(this._literal).canonical;let i=Ti(e,this.groupedByDegrees({splitRational:!1}));return this._hasInfinity&&i.push(e.POSITIVE_INFINITY),i=(n=re(i,"Multiply"))!=null?n:i,i.length===0?e.ONE:i.length===1?i[0]:this.engine._fn("Multiply",i)}asRationalExpression(){const[e,i]=this.asNumeratorDenominator();return i.isOne?e:i.isNegativeOne?this.engine.negate(e):this.engine._fn("Divide",[e,i])}}function Sn(t){const[e,i]=t;return e===i?0:e>0&&Number.isInteger(e/i)?1:e>0?2:Number.isInteger(e/i)?3:4}function Zs(t,e){const i=Sn(t.exponent),n=Sn(e.exponent);return i!==n?i-n:t.exponent[0]/t.exponent[1]-e.exponent[0]/e.exponent[1]}function Ti(t,e){var n;const i=(e=e.sort(Zs)).map(r=>{var o;const s=(o=re(r.terms,"Multiply"))!=null?o:r.terms,u=s.length<=1?s[0]:t._fn("Multiply",s.sort(Bt));return r.exponent[0]===r.exponent[1]?u:t.power(u,r.exponent)});return(n=re(i,"Multiply"))!=null?n:i}function G(t,e,i,n){var o,a,l,h,d,y,N;const r=t.jsonSerializationOptions.exclude;if((e==="Rational"||e==="Divide")&&((o=i[0])==null?void 0:o.isLiteral)&&((a=i[1])==null?void 0:a.isLiteral)&&((l=i[0])==null?void 0:l.asSmallInteger)===1&&((h=i[1])==null?void 0:h.asSmallInteger)===2&&!r.includes("Half"))return at(t,"Half",ee(z({},n),{wikidata:"Q39373172"}));if(e==="Negate"&&i[0].isLiteral){if(i[0].machineValue!==null)return ti(t,-i[0].machineValue);if(i[0].decimalValue!==null)return ti(t,i[0].decimalValue.neg());if(i[0].complexValue!==null)return ti(t,i[0].complexValue.neg());const[x,k]=i[0].rationalValue;if(x!==null&&k!==null)return ti(t,[-x,k])}if(e==="Rational"&&r.includes(e)&&i.length>1)return G(t,"Divide",i,n);if(e==="Complex"&&r.includes(e))return G(t,"Add",[i[0],t._fn("Multiply",[i[1],t.symbol("ImaginaryUnit")])],n);if(e==="Sqrt"&&r.includes(e))return G(t,"Power",[i[0],r.includes("Half")?t.number([1,2]):t.HALF],n);if(e==="Root"&&r.includes(e)&&i[1].isLiteral){const x=i[1].asSmallInteger;if(x===2)return G(t,"Sqrt",[i[0]]);if(x!==null)return x<0?G(t,"Divide",[t.ONE,t._fn("Power",[i[0],t.number([1,-x])])],n):G(t,"Power",[i[0],t.number([1,-x])],n)}if(e==="Square"&&r.includes(e))return G(t,"Power",[i[0],t.TWO],n);if(e==="Exp"&&r.includes(e))return G(t,"Power",[t.symbol("ExponentialE"),i[0]],n);if(e==="Subtract"&&r.includes(e))return G(t,"Add",[i[0],t._fn("Negate",[i[1]])],n);if(e==="Add"&&i.length===2&&!r.includes("Subtract")){if(i[1].isLiteral){const x=i[1].asSmallInteger;if(x!==null&&x<0)return G(t,"Subtract",[i[0],t.number(-x)],n)}if(i[1].head==="Negate")return G(t,"Subtract",[i[0],i[1].op1],n)}if(e==="Tuple"){if(i.length===1&&!r.includes("Single"))return G(t,"Single",i,n);if(i.length===2&&!r.includes("Pair"))return G(t,"Pair",i,n);if(i.length===3&&!r.includes("Triple"))return G(t,"Triple",i,n)}const s=[typeof e=="string"?e:e.json,...i.map(x=>x.json)],u=z({},n!=null?n:{});return t.jsonSerializationOptions.metadata.includes("latex")?u.latex=(d=u.latex)!=null?d:t.serialize({fn:s}):u.latex="",t.jsonSerializationOptions.metadata.includes("wikidata")?(n==null?void 0:n.wikidata)||typeof e!="string"||(u.wikidata=(N=(y=t.getFunctionDefinition(e,i))==null?void 0:y.wikidata)!=null?N:""):u.wikidata="",u.latex||u.wikidata||!t.jsonSerializationOptions.shorthands.includes("function")?u.latex&&u.wikidata?{fn:s,latex:u.latex,wikidata:u.wikidata}:u.latex?{fn:s,latex:u.latex}:u.wikidata?{fn:s,wikidata:u.wikidata}:{fn:s}:s}function at(t,e,i){var n,r,s;return e==="Half"&&t.jsonSerializationOptions.exclude.includes("Half")?ti(t,[1,2],i):(i=z({},i),t.jsonSerializationOptions.metadata.includes("latex")?(i.latex=(n=i.latex)!=null?n:t.serialize({sym:e}),i.latex===e&&(i.latex=""),i.latex=i.latex):i.latex="",t.jsonSerializationOptions.metadata.includes("wikidata")?i.wikidata||(i.wikidata=(s=(r=t.getSymbolDefinition(e))==null?void 0:r.wikidata)!=null?s:""):i.wikidata="",e=e,i.latex||i.wikidata||!t.jsonSerializationOptions.shorthands.includes("symbol")?i.latex&&i.wikidata?{sym:e,latex:i.latex,wikidata:i.wikidata}:i.latex?{sym:e,latex:i.latex}:i.wikidata?{sym:e,wikidata:i.wikidata}:{sym:e}:e)}function ti(t,e,i){var s,u,o;i=z({},i),t.jsonSerializationOptions.metadata.includes("latex")||(i.latex="");const n=!i.latex&&!t.jsonSerializationOptions.metadata.includes("latex")&&t.jsonSerializationOptions.shorthands.includes("number");let r="";if(e instanceof Ss){if(e.isNaN()?r="NaN":e.isFinite()||(r=e.isPositive()?"+Infinity":"-Infinity"),!r){if(n&&ki(e)&&e.precision()<15)return e.toNumber();r=e.isInteger()&&e.e<e.precision()+4?e.toFixed(0):wn(t,e.toJSON())}return t.jsonSerializationOptions.metadata.includes("latex")&&(i.latex=(s=i.latex)!=null?s:t.serialize({num:r})),i.latex?{num:r,latex:i.latex}:{num:r}}if(e instanceof B.exports.Complex)return e.isInfinite()?at(t,"ComplexInfinity",i):e.isNaN()?(r="NaN",t.jsonSerializationOptions.metadata.includes("latex")&&(i.latex=(u=i.latex)!=null?u:t.serialize({num:r})),i.latex?{num:r,latex:i.latex}:{num:r}):G(t,"Complex",[t.number(e.re),t.number(e.im)],ee(z({},i),{wikidata:"Q11567"}));if(Array.isArray(e))return i.latex||i.wikidata||t.jsonSerializationOptions.metadata.includes("latex")||!t.jsonSerializationOptions.shorthands.includes("function")||!t.jsonSerializationOptions.shorthands.includes("number")?G(t,"Rational",[t.number(e[0]),t.number(e[1])],i):["Rational",e[0],e[1]];if(Number.isNaN(e)&&(r="NaN"),!Number.isFinite(e)&&e>0&&(r="+Infinity"),!Number.isFinite(e)&&e<0&&(r="-Infinity"),!r){if(n)return e;r=wn(t,e.toString())}return t.jsonSerializationOptions.metadata.includes("latex")&&(i.latex=(o=i.latex)!=null?o:t.serialize({num:r})),i.latex?{num:r,latex:i.latex}:{num:r}}function wn(t,e){var a;if(!t.jsonSerializationOptions.repeatingDecimal)return e;let[i,n,r,s]=(a=e.match(/^(.*)\.([0-9]+)([e|E][-+]?[0-9]+)?$/))!=null?a:[];if(!r)return e;const u=r[r.length-1];r=r.slice(0,-1);let o="";for(let l=0;l<r.length-16;l++){o=r.substring(0,l);for(let h=0;h<=16;h++){const d=r.substring(l,l+h+1),y=Math.floor((r.length-o.length)/d.length);if(y>1&&(o+d.repeat(y+1)).startsWith(r))return d==="0"?u==="0"?n+"."+o+(s!=null?s:""):e:n+"."+o+"("+d+")"+(s!=null?s:"")}}return e}class _e extends ye{constructor(e,i,n){super(e,n),this._value=new Map,this._isCanonical=!1;for(const r of Object.keys(i))this._value.set(r,e.box(i[r]));e._register(this)}_purge(){for(const[e,i]of this._value)i._purge()}get hash(){let e=be("Dictionary");for(const[i,n]of this._value)e^=be(i)^n.hash;return e}get complexity(){return 97}get head(){return"Dictionary"}get isPure(){return!1}getKey(e){return this._value.get(e)}hasKey(e){return this._value.has(e)}get keys(){return this._value.keys()}get keysCount(){return this._value.size}has(e){for(const[i,n]of this._value)if(n.has(e))return!0;return!1}get domain(){const e=["Dictionary"];for(const[i,n]of this._value)e.push(["Tuple",i,n.domain]);return this.engine.domain(e)}get json(){if(this.engine.jsonSerializationOptions.shorthands.includes("dictionary")){const i={};for(const n of this._value.keys())i[n]=this._value.get(n).json;return{dict:i}}const e=[];for(const i of this._value.keys())e.push(this.engine._fn("KeyValuePair",[this.engine.string(i),this._value.get(i)]));return G(this.engine,"Dictionary",e,{latex:this._latex})}isSame(e){if(this===e)return!0;if(!(e instanceof _e)||this._value.size!==e._value.size)return!1;for(const[i,n]of this._value){const r=e.getKey(i);if(!r||!n.isSame(r))return!1}return!0}match(e,i){if(!(e instanceof _e)||this._value.size!==e._value.size)return null;let n={};for(const[r,s]of this._value){const u=e.getKey(r);if(!u)return null;const o=s.match(u);if(o===null)return null;n=z(z({},n),o)}return n}isEqual(e){if(this===e)return!0;if(!(e instanceof _e)||!e.keys||this._value.size!==e._value.size)return!1;for(const[i,n]of this._value){const r=e.getKey(i);if(!r||!n.isEqual(r))return!1}return!0}apply(e,i){const n={};for(const r of this.keys)n[r]=this.engine.box(e(this.getKey(r)));return i?this.engine.fn(i,[{dict:n}]):new _e(this.engine,n)}evaluate(e){return this.apply(i=>{var n;return(n=i.evaluate(e))!=null?n:i})}get isCanonical(){return this._isCanonical}set isCanonical(e){this._isCanonical=e}get canonical(){if(this.isCanonical)return this;const e=this.apply(i=>i.canonical);return e.isCanonical=!0,e}simplify(e){var i;return(i=e==null?void 0:e.recursive)==null||i?this.apply(n=>{var r;return(r=n.simplify(e))!=null?r:n}):this}N(e){return this.apply(i=>i.N(e))}replace(e,i){let n=0;const r={};for(const s of this.keys){const u=this.getKey(s),o=u.replace(e,i);o!==null&&(n+=1),r[s]=o!=null?o:u}return n===0?null:new _e(this.engine,r)}subs(e){const i={};for(const n of this.keys)i[n]=this.getKey(n).subs(e);return new _e(this.engine,i)}}function or(t,e){var n;const i=new Set;for(const[r,s,u]of e){let o=t.pattern(r);const a={};for(const y of Ii(o))a[y]=t.symbol("_"+y);let l;o=o.subs(a);const h=xi(u==null?void 0:u.condition);if(h){const y=t.parse(h).subs(a);l=N=>{var x;return((x=y.subs(N).value)==null?void 0:x.symbol)==="True"}}else l=u==null?void 0:u.condition;const d=Ht(s)?t.parse(s):t.box(s);d&&i.add([o,d.subs(a),(n=u==null?void 0:u.priority)!=null?n:0,l])}return i}function js([t,e,i,n],r,s){const u=t.match(r,s);return u===null?null:typeof n!="function"||n(u)?e.subs(u):null}function lr(t,e,i){var a,l;const n=(a=i==null?void 0:i.iterationLimit)!=null?a:1;let r=0;const s=(l=i==null?void 0:i.once)!=null?l:!1;let u=!1,o=!1;try{for(;!u&&r<n;){u=!0;for(const h of e){const d=js(h,t,i);if(d!==null&&d!==t){if(s)return d;u=!1,o=!0,t=d}}r+=1}}catch{}return o?t:null}const Gs=[];function Hs(t,e){if(e==null||t===e)return t;const i=t.engine,n=i.box(e);return i.costFunction(n)<=1.7*i.costFunction(t)?n:t}class Ve extends ye{constructor(e,i,n,r){var s;super(e,r),this._head=typeof i=="string"?i:(s=i.symbol)!=null?s:i,this._ops=n,typeof this._head=="string"&&(this._def=e.getFunctionDefinition(this._head,n)),this._isCanonical=!1,e._register(this)}get hash(){if(this._hash!==void 0)return this._hash;let e=0;for(const i of this._ops)e=e<<1^i.hash|0;return e=typeof this._head=="string"?e^be(this._head)|0:e^this._head.hash|0,this._hash=e,e}_purge(){typeof this._head!="string"&&this._head._purge();for(const e of this._ops)e._purge();this._value&&this._value._purge(),this._numericValue&&this._numericValue._purge()}get wikidata(){var e,i,n;return(n=(i=this._wikidata)!=null?i:(e=this._def)==null?void 0:e.wikidata)!=null?n:""}get description(){return this._def&&this._def.description?typeof this._def.description=="string"?[this._def.description]:this._def.description:[]}get url(){var e,i;return(i=(e=this._def)==null?void 0:e.url)!=null?i:""}get complexity(){var e,i;return(i=(e=this._def)==null?void 0:e.complexity)!=null?i:1e5}get head(){return this._head}get value(){if(this.isPure)return this._value||(this._value=this.evaluate()),this._value}get numericValue(){if(!this.isPure)return;if(this._numericValue)return this._numericValue;const e=this.N();return this._numericValue=e.isLiteral?e:void 0,this._numericValue}get isPure(){var i;if(this._isPure!==void 0)return this._isPure;let e;return((i=this._def)==null?void 0:i.pure)!==void 0&&(e=this._def.pure),e!==!1&&(e=this._ops.every(n=>n.isPure)),this._isPure=e,e}get isLiteral(){return!1}get ops(){return this._ops}get nops(){return this._ops.length}get op1(){var e;return(e=this._ops[0])!=null?e:this.engine.symbol("Missing")}get op2(){var e;return(e=this._ops[1])!=null?e:this.engine.symbol("Missing")}get op3(){var e;return(e=this._ops[2])!=null?e:this.engine.symbol("Missing")}get functionDefinition(){return this._def}_repairDefinition(){if(typeof this._head=="string"){if(this._head[0]==="_")return;this._def=this.engine.getFunctionDefinition(this._head,this._ops),this._def&&(this._head=this._def.name)}}get domain(){var i;if((i=this._def)!=null&&i.domain)return typeof this._def.domain=="function"?this.engine.domain(this._def.domain(this.engine,this._ops)):this.engine.domain(this._def.domain);const e=[this.head];for(const n of this._ops)e.push(n.domain);return e.push(this.engine.domain("Anything")),this.engine.domain(e)}get valueDomain(){var e;return(e=this.domain.codomain)!=null?e:this.engine.domain("Nothing")}isLess(e){if(e.isZero){const i=this.sgn;if(i===null)return!1;if(i!==void 0)return i<0}}isLessEqual(e){if(e.isZero){const i=this.sgn;if(i===null)return!1;if(i!==void 0)return i<=0}}isGreater(e){if(e.isZero){const i=this.sgn;if(i===null)return!1;if(i!==void 0)return i>0}}isGreaterEqual(e){if(e.isZero){const i=this.sgn;if(i===null)return!1;if(i!==void 0)return i>=0}}get isZero(){const e=this.sgn;return e!==null&&(typeof e=="number"?e===0:void 0)}get isNotZero(){const e=this.sgn;return e!==null&&(typeof e=="number"?e!==0:void 0)}get isOne(){}get isNegativeOne(){}get isPositive(){const e=this.sgn;return e!==null&&(typeof e=="number"?e!==0:void 0)}get isNonPositive(){const e=this.sgn;return e!==null&&(typeof e=="number"?e<=0:void 0)}get isNegative(){const e=this.sgn;return e!==null&&(typeof e=="number"?e<0:void 0)}get isNonNegative(){const e=this.sgn;return e!==null&&(typeof e=="number"?e>=0:void 0)}get isNumber(){return this.valueDomain.isSubdomainOf("Number")}get isInteger(){return this.valueDomain.isSubdomainOf("Integer")}get isRational(){return this.valueDomain.isSubdomainOf("RationalNumber")}get isAlgebraic(){return this.valueDomain.isSubdomainOf("AlgebraicNumber")}get isReal(){return this.valueDomain.isSubdomainOf("RealNumber")}get isExtendedReal(){return this.valueDomain.isSubdomainOf("ExtendedRealNumber")}get isComplex(){return this.valueDomain.isSubdomainOf("ComplexNumber")}get isImaginary(){return this.valueDomain.isSubdomainOf("ImaginaryNumber")}get json(){return this._isCanonical?function(e,i,n,r){var u,o;const s=e.jsonSerializationOptions.exclude;if(i==="Add"&&n.length===2&&!s.includes("Subtract")){const a=n[0].asSmallInteger;if(a!==null&&a<0)return G(e,"Subtract",[n[1],e.number(-a)],r);if(n[0].head==="Negate")return G(e,"Subtract",[n[1],n[0].op1],r)}if(i==="Divide"&&e.jsonSerializationOptions.exclude.includes("Divide"))return G(e,"Multiply",[n[0],e._fn("Power",[n[1],e.NEGATIVE_ONE])],r);if(i==="Multiply"&&!e.jsonSerializationOptions.exclude.includes("Divide")){const a=new Ai(e,n).asRationalExpression();if(a.head==="Divide")return G(e,a.head,a.ops,r)}if(i==="Power"){if(!s.includes("Exp")&&((u=n[0])==null?void 0:u.symbol)==="ExponentialE")return G(e,"Exp",[n[1]],r);if((o=n[1])!=null&&o.isLiteral){const a=n[1].asSmallInteger;if(!s.includes("Square")&&a===2)return G(e,"Square",[n[0]],r);if(!e.jsonSerializationOptions.exclude.includes("Divide")){if(a===-1)return G(e,"Divide",[e.ONE,n[0]],r);if(a!==null&&a<0)return G(e,"Divide",[e.ONE,e.power(n[0],-a)],r)}const[l,h]=n[1].rationalValue;if(l===1){if(!s.includes("Sqrt")&&h===2)return G(e,"Sqrt",[n[0]],r);if(!s.includes("Root"))return G(e,"Root",[n[0],e.number(h)],r)}if(l===-1){if(!s.includes("Sqrt")&&h===2)return G(e,"Divide",[e.ONE,e._fn("Sqrt",[n[0]])],r);if(!s.includes("Root"))return G(e,"Divide",[e.ONE,e._fn("Root",[n[0],e.number(h)])],r)}}}return G(e,i,n,r)}(this.engine,this._head,this._ops,{latex:this._latex,wikidata:this._wikidata}):G(this.engine,this._head,this._ops,{latex:this._latex,wikidata:this._wikidata})}has(e){if(typeof this._head=="string"){if(typeof e=="string"){if(this._head===e)return!0}else if(e.includes(this._head))return!0}for(const i of this._ops)if(i.has(e))return!0;return!1}isSame(e){if(this===e)return!0;if(!(e instanceof Ve)||this.nops!==e.nops)return!1;if(typeof this.head=="string"){if(this.head!==e.head)return!1}else if(typeof e.head=="string"||!e.head||!this.head.isSame(e.head))return!1;const i=this._ops,n=e._ops;for(let r=0;r<i.length;r++)if(!i[r].isSame(n[r]))return!1;return!0}match(e,i){if(!(e instanceof Ve))return null;let n={};if(typeof this.head=="string"){if(this.head!==e.head)return null}else{if(typeof e.head=="string")return null;{if(!e.head)return null;const u=this.head.match(e.head,i);if(u===null)return null;n=z(z({},n),u)}}const r=this._ops,s=e._ops;for(let u=0;u<r.length;u++){const o=r[u].match(s[u],i);if(o===null)return null;n=z(z({},n),o)}return n}isEqual(e){if(!this.isCanonical)return this.canonical.isEqual(e);if((e=e.canonical).isNumber&&this.isNumber){const i=this.engine,n=i.add([this,i.negate(e)]).N();return!!n.isZero||n.asFloat!==null&&i.chop(n.asFloat)===0||this.evaluate().isSame(e.evaluate())}return this.domain.isRelationalOperator&&e.domain.isRelationalOperator?this.evaluate().isSame(e.evaluate()):this.isSame(e)}get sgn(){var i,n,r,s,u,o,a,l;const e=this.head;if(e==="Negate"){const h=(i=this._ops[0])==null?void 0:i.sgn;return h===void 0?void 0:h===null?null:h===0?0:h>0?-1:1}if(e==="Multiply"){const h=this._ops.reduce((d,y)=>{var N;return d*((N=y.sgn)!=null?N:NaN)},1);return isNaN(h)?null:h>0?1:h<0?-1:0}if(e==="Add"){let h=0,d=0,y=0;const N=this._ops.length;for(const x of this._ops){const k=x.sgn;if(k==null)break;k===0&&(y+=1),k>0&&(h+=1),k<0&&(d+=1)}return y===N?0:h===N?1:d===N?-1:null}if(e==="Divide"){const h=(n=this._ops[0])==null?void 0:n.sgn,d=(r=this._ops[1])==null?void 0:r.sgn;return h===null||d===null||h===void 0||d===void 0?null:h===0?0:h>0&&d>0||h<0&&d<0?1:-1}return e==="Square"?(s=this._ops[0])!=null&&s.isImaginary?-1:(u=this._ops[0])!=null&&u.isZero?0:1:e==="Abs"?(o=this._ops[0])!=null&&o.isZero?0:1:e==="Sqrt"?(a=this._ops[0])!=null&&a.isZero?0:(l=this._ops[0])!=null&&l.isImaginary?null:1:null}*map(e){let i=0;for(;i<this._ops.length;)yield e(this._ops[i++])}get isCanonical(){return this._isCanonical}set isCanonical(e){this._isCanonical=e}get canonical(){var i,n,r,s,u,o,a;if(this.isCanonical)return this;let e=(i=this._def)!=null&&i.associative?(n=re(this._ops,this._def.name))!=null?n:this._ops:this._ops;if(e=Ge(e,(s=(r=this._def)==null?void 0:r.hold)!=null?s:"none",l=>l.canonical),(u=this._def)!=null&&u.associative&&(e=(o=re(e,this._def.name))!=null?o:e),(a=this._def)==null?void 0:a.canonical)return this._def.canonical(this.engine,e);if(!this._def)return this.engine._fn(this._head,e);if(e.length===1&&e[0].head===this._head){if(this._def.idempotent)e=e[0].ops;else if(this._def.involution)return e[0].op1}return e.length>1&&this._def.commutative===!0&&(e=e.sort(Bt)),this.engine._fn(this._head,e)}apply(e,i){const n=i!=null?i:this.head;let r=!1;const s=[];for(const u of this._ops){const o=e(u);u!==o&&(r=!0),s.push(this.engine.box(o))}return r||this.head!==n?this.engine.fn(n,s):this}simplify(e){var a,l,h,d;if(!this.isCanonical)return this.canonical.simplify(e);const i=this._def;let n,r=this._ops;if(i?(i.associative&&(r=(a=re(r,i.name))!=null?a:r),r=Ge(r,i.hold,y=>y.simplify(e)),i.associative&&(r=(l=re(r,i.name))!=null?l:r)):r=Ge(this._ops,"none",y=>y.simplify(e)),typeof this._head!="string")return Ri(this._head,r).simplify(e);i&&(i.simplify?n=i.simplify(this.engine,r):i.inert&&(n=(h=r[0])!=null?h:this.engine.symbol("Missing"))),n||(n=this.engine.fn(this._head,r).canonical);const s=(d=e==null?void 0:e.rules)!=null?d:this.engine.cache("standard-simplification-rules",()=>or(this.engine,Gs),y=>{for(const[N,x,k,M]of y)N._purge(),x._purge();return y});let u=0,o=!1;do{const y=n.replace(s);y!==null?(n=Hs(y,n),n===y&&(o=!0)):o=!0,u+=1}while(!o&&u<this.engine.iterationLimit);return n}evaluate(e){var r,s,u,o;if(!this.isCanonical)return this.canonical.evaluate(e);const i=this._def;let n;return i?(n=Ge(i.associative?(r=re(this._ops,i.name))!=null?r:this._ops:this._ops,i.hold,a=>a.evaluate(e)),i.associative&&(n=(s=re(n,i.name))!=null?s:n)):n=Ge(this._ops,"none",a=>a.evaluate(e)),typeof this._head!="string"?Ri(this._head,n).evaluate(e):i?i.evaluate===void 0?i.inert?(u=n[0])!=null?u:this.engine.symbol("Missing"):this.engine.fn(this._head,n).canonical:typeof i.evaluate!="function"?Ri(i.evaluate,n).canonical:(o=i.evaluate(this.engine,n))!=null?o:this.engine.fn(this._head,n).canonical:this.engine.fn(this._head,n).canonical}N(e){var s,u,o,a;if(!this.isCanonical)return this.canonical.N(e);const i=this._def;let n;if(i?(n=Ge(i.associative?(s=re(this._ops,i.name))!=null?s:this._ops:this._ops,i.hold,l=>l.N(e)),i.associative&&(n=(u=re(n,i.name))!=null?u:n)):n=Ge(this._ops,"none",l=>l.N(e)),typeof this._head!="string")return Ri(this._head,n).N(e);if(!i)return this.engine.fn(this._head,n).canonical;const r=(a=(o=i.N)==null?void 0:o.call(i,this.engine,n))!=null?a:this.engine.fn(this._head,n).evaluate();if(r.isLiteral){if(!Ze(this.engine)&&r.complexValue)return this.engine.NAN;if(!pe(this.engine)&&r.decimalValue)return this.engine.number(r.decimalValue.toNumber())}return r}solve(e){return null}replace(e,i){return lr(this,e,i)}subs(e){return this.engine.fn(this._head,this._ops.map(i=>i.subs(e))).canonical}}function Ri(t,e){const i={__:t.engine.tuple(e),"_#":t.engine.number(e.length)};let n=1;for(const r of e)i["_"+n++]=r;return i._=i._1,t.subs(i)}function Ge(t,e,i){if(t.length===0)return[];const n=[];for(let r=0;r<t.length;r++)if(t[r].symbol!=="Nothing")if(t[r].head==="Hold")n.push(t[r].op1);else if(t[r].head==="ReleaseHold"){const s=i(t[r].op1);s!==null&&s.symbol!=="Nothing"&&n.push(s)}else if(Bs(t,e,r)){const s=i(t[r]);s!==null&&s.symbol!=="Nothing"&&n.push(s)}else n.push(t[r]);return n}function Bs(t,e,i){return e!=="all"&&(e==="none"||(e==="first"?i!==0:e==="rest"?i===0:e==="last"?i!==t.length-1:e==="most"&&i===t.length-1))}function Dt(t){if(typeof t=="number"&&!isNaN(t))return isFinite(t)?t===0?"NonNegativeInteger":Number.isInteger(t)?t>0?"PositiveInteger":t<0?"NegativeInteger":"Integer":t>0?"PositiveNumber":t<0?"NegativeNumber":"RealNumber":"ExtendedRealNumber";if(t instanceof Q.exports.Decimal)return t.isNaN()?"Number":t.isFinite()?t.isZero()?"NonNegativeInteger":t.isInteger()?t.gt(0)?"PositiveInteger":t.lt(0)?"NegativeInteger":"Integer":t.gt(0)?"PositiveNumber":t.lt(0)?"NegativeNumber":"RealNumber":"ExtendedRealNumber";if(t instanceof B.exports.Complex){const e=t;return e.im===0?Dt(e.re):e.re===0&&e.im!==0?"ImaginaryNumber":"ComplexNumber"}if(Array.isArray(t)){const[e,i]=$e(t);if(!Number.isNaN(e)&&!Number.isNaN(i))return i!==1?"RationalNumber":Dt(e)}return"Number"}function Lt(t){if(!Number.isInteger(t)||!Number.isFinite(t)||Number.isNaN(t)||t<=1)return!1;if(t<=7919)return vn.has(t);for(const e of vn)if(t%e==0)return!1;return t>=0x3ffffffffffe5?!!function(e,i){let n=0,r=e-1;for(;r%2==0;)r/=2,++n;e:do{let s=Math.pow(2+Math.floor(Math.random()*(e-3)),r)%e;if(s!==1&&s!==e-1){for(let u=n-1;u--;){if(s=s*s%e,s===1)return!1;if(s===e-1)continue e}return!1}}while(--i);return!0}(t,30)&&void 0:t===function(e){if(e===1)return 1;if(e%2==0)return 2;if(e%3==0)return 3;if(e%5==0)return 5;const i=Math.floor(Math.sqrt(e));let n=7;for(;n<=i;){if(e%n==0)return n;if(e%(n+4)==0)return n+4;if(e%(n+6)==0)return n+6;if(e%(n+10)==0)return n+10;if(e%(n+12)==0)return n+12;if(e%(n+16)==0)return n+16;if(e%(n+22)==0)return n+22;if(e%(n+24)==0)return n+24;n+=30}return e}(t)}class J extends ye{constructor(e,i,n){if(super(e,n),this._isCanonical=!0,i instanceof B.exports.Complex)Number.isNaN(i.re)||Number.isNaN(i.im)?this._value=NaN:e.chop(i.im)===0?this._value=i.re:this._value=Ze(e)?i:NaN;else if(Array.isArray(i)){let[r,s]=i;s<0&&([r,s]=[-r,-s]),s===1?this._value=r:r===0?this._value=s===0?NaN:r:(this._value=[r,s],this._isCanonical=ir(r,s)===1)}else i instanceof Q.exports.Decimal?this._value=pe(e)?i:i.toNumber():typeof i=="number"?this._value=i:pe(e)?this._value=e.decimal(i):typeof i=="string"&&(this._value=Number.parseFloat(i));typeof this._value=="number"?Number.isInteger(this._value)?this._head="Integer":this._head="Number":this._value instanceof B.exports.Complex?this._head="ComplexNumber":Array.isArray(this._value)?this._head="RationalNumber":this._value instanceof Q.exports.Decimal?this._value.isInteger()?this._head="Integer":this._head="RealNumber":this._head="Number",e._register(this)}get hash(){if(this._hash!==void 0)return this._hash;let e=0;return e=typeof this._value=="number"?be(this._value.toString()):this._value instanceof B.exports.Complex?be(this._value.re.toString()+" +i "+this._value.im.toString()):this._value instanceof Q.exports.Decimal?be(this._value.toString()):be(this._value[0].toString()+" / "+this._value[1].toString()),this._hash=e,e}get head(){return this._head}get isPure(){return!0}get isLiteral(){return!0}get isCanonical(){return this._isCanonical}set isCanonical(e){this._isCanonical=e}get numericValue(){if(!Array.isArray(this._value))return this;const[e,i]=this._value,n=this.engine;return pe(n)?new J(n,n.decimal(e).div(i)):new J(n,e/i)}get machineValue(){return typeof this._value=="number"?this._value:null}get decimalValue(){return this._value instanceof Q.exports.Decimal?this._value:null}get complexValue(){return this._value instanceof B.exports.Complex?this._value:null}get rationalValue(){return Array.isArray(this._value)?this._value:[null,null]}get asFloat(){if(typeof this._value=="number")return this._value;if(this._value instanceof Q.exports.Decimal){if(this._value.isNaN())return NaN;if(!this._value.isFinite())return this._value.isPositive()?1/0:-1/0;if(ki(this._value))return this._value.toNumber()}return Array.isArray(this._value)?this._value[0]/this._value[1]:null}get asSmallInteger(){if(typeof this._value=="number")return Number.isInteger(this._value)&&this._value>=-1e6&&this._value<=1e6?this._value:null;if(this._value instanceof Q.exports.Decimal)return this._value.isInteger()&&this._value.gte(-1e6)&&this._value.lte(1e6)?this._value.toNumber():null;if(Array.isArray(this._value)){const e=this._value[0]/this._value[1];return Number.isInteger(e)&&e>=-1e6&&e<=1e6?e:null}return this.engine.chop(this._value.im)===0&&Number.isInteger(this._value.re)&&this._value.re>=-1e6&&this._value.re<=1e6?this._value.re:null}get asRational(){const[e,i]=this.rationalValue;if(e!==null&&i!==null)return[e,i];const n=this.asSmallInteger;return n!==null?[n,1]:[null,null]}get domain(){return this._domain===void 0&&(this._domain=this.engine.domain(Dt(this._value))),this._domain}get json(){return ti(this.engine,this._value,{latex:this._latex})}get sgn(){if(this.isZero)return 0;if(this._value instanceof B.exports.Complex)return null;if(typeof this._value=="number")return this._value<0?-1:this._value>0?1:null;if(this._value instanceof Q.exports.Decimal)return this._value.isNegative()?-1:this._value.isPositive()?1:null;if(Array.isArray(this._value)){const[e,i]=this._value;return e===0&&i!==0?0:e<0?-1:e>0?1:null}return null}isSame(e){if(this===e)return!0;if(!(e instanceof J))return!1;if(Array.isArray(this._value)){if(!Array.isArray(e._value))return!1;const[i,n]=e._value;return this._value[0]===i&&this._value[1]===n}return this._value instanceof Q.exports.Decimal?e._value instanceof Q.exports.Decimal&&this._value.eq(e._value):this._value instanceof B.exports.Complex?e._value instanceof B.exports.Complex&&this._value.equals(e._value):typeof this._value=="number"&&typeof e._value=="number"&&this._value===e._value}isEqual(e){var s,u;if(this===e)return!0;const i=e.numericValue;if(i===void 0||!(i instanceof J))return!1;if(Array.isArray(this._value)){const o=i.asFloat;return o!==null&&this.engine.chop(this._value[0]/this._value[1]-o)===0}if(this._value instanceof Q.exports.Decimal)return this.engine.chop(this._value.sub((u=(s=i.decimalValue)!=null?s:i.asFloat)!=null?u:NaN))===0;if(this._value instanceof B.exports.Complex){if(i instanceof B.exports.Complex)return this.engine.chop(i.re-this._value.re)===0&&this.engine.chop(i.im-this._value.im)===0;if(this._value.im!==0)return!1}const n=this.asFloat,r=i.asFloat;return n!==null&&r!==null&&this.engine.chop(r-n)===0}match(e,i){var n;return this.isEqualWithTolerance(e,(n=i==null?void 0:i.numericTolerance)!=null?n:0)?{}:null}isEqualWithTolerance(e,i){var s,u;if(this===e)return!0;if(!(e instanceof J))return!1;if(Array.isArray(this._value)){const o=e.asFloat;return o!==null&&Math.abs(this._value[0]/this._value[1]-o)<=i}if(this._value instanceof Q.exports.Decimal)return this._value.sub((u=(s=e.decimalValue)!=null?s:e.asFloat)!=null?u:NaN).abs().lte(i);if(this._value instanceof B.exports.Complex){if(e._value instanceof B.exports.Complex)return Math.abs(e._value.re-this._value.re)<=i&&Math.abs(e._value.im-this._value.im)<=i;if(this._value.im!==0)return!1}const n=this.asFloat,r=e.asFloat;return n!==null&&r!==null&&Math.abs(r-n)<=i}isLess(e){if(e=e.N(),!this.isImaginary&&!e.isImaginary){if(typeof this._value=="number"){const i=e.machineValue;if(i!==null)return this._value<i;const n=e.decimalValue;if(n!==null)return n.greaterThanOrEqualTo(this._value);const[r,s]=e.rationalValue;return r!==null&&s!==null&&this._value*s<r}if(this._value instanceof Q.exports.Decimal){const i=e.machineValue;if(i!==null)return this._value.lt(i);const n=e.decimalValue;if(n!==null)return this._value.lt(n);const[r,s]=e.rationalValue;return r!==null&&s!==null&&this._value.mul(s).lt(r)}if(Array.isArray(this._value)){const[i,n]=this._value;if(typeof e=="number")return i<e*n;const[r,s]=e.rationalValue;if(r!==null&&s!==null)return i*s<r*n;const u=e.decimalValue;return u!==null&&u.mul(i).lt(n)}this._value,B.exports.Complex}}isLessEqual(e){e=e.N();const i=this.isLess(e);if(i===void 0)return;const n=this.isEqual(e);return n!==void 0?i||n:void 0}isGreater(e){const i=this.isLess(e);if(i!==void 0)return!i}isGreaterEqual(e){e=e.N();const i=this.isLess(e);if(i===void 0)return;const n=this.isEqual(e);return n!==void 0?!i||n:void 0}get isPositive(){const e=this.sgn;if(e!=null)return e>0}get isNonNegative(){const e=this.sgn;if(e!=null)return e>=0}get isNegative(){const e=this.sgn;if(e!=null)return e<0}get isNonPositive(){const e=this.sgn;if(e!=null)return e<=0}get isZero(){return!Array.isArray(this._value)&&this.engine.chop(this._value)===0}get isNotZero(){return!!Array.isArray(this._value)||this.engine.chop(this._value)!==0}get isOne(){if(typeof this._value=="number")return this._value===1;if(this._value instanceof Q.exports.Decimal)return this._value.equals(this.engine.DECIMAL_ONE);if(Array.isArray(this._value)){const[e,i]=this._value;return i!==0&&e===i}return this._value.equals(1)}get isNegativeOne(){if(typeof this._value=="number")return this._value===-1;if(this._value instanceof Q.exports.Decimal)return this._value.equals(this.engine.DECIMAL_NEGATIVE_ONE);if(Array.isArray(this._value)){const[e,i]=this._value;return e<0&&i!==0&&-e===i}return this._value.equals(-1)}get isOdd(){return!(!this.isOne&&!this.isNegativeOne)||!this.isZero&&!!this.isInteger&&(typeof this._value=="number"?this._value%2!=0:this._value instanceof Q.exports.Decimal?!this._value.mod(2).isZero():void 0)}get isEven(){return!this.isOne&&!this.isNegativeOne&&(!!this.isZero||!!this.isInteger&&(typeof this._value=="number"?this._value%2==0:this._value instanceof Q.exports.Decimal?this._value.mod(2).isZero():void 0))}get isPrime(){return!(!this.isInteger||!this.isFinite||this.isNonPositive||this.isOne||this.isZero)&&(typeof this._value=="number"?Lt(this._value):void 0)}get isComposite(){return!(!this.isInteger||!this.isFinite||this.isNonPositive||this.isOne||this.isZero)&&(typeof this._value=="number"?!Lt(this._value):void 0)}get isInfinity(){return typeof this._value=="number"?!Number.isFinite(this._value)&&!Number.isNaN(this._value):(this._value instanceof Q.exports.Decimal||this._value instanceof B.exports.Complex)&&!this._value.isFinite()&&!this._value.isNaN()}get isNaN(){return typeof this._value=="number"?Number.isNaN(this._value):(this._value instanceof Q.exports.Decimal&&this._value.isNaN(),this._value instanceof B.exports.Complex&&this._value.isNaN(),!1)}get isFinite(){return!this.isInfinity&&!isNaN}get isNumber(){return!0}get isInteger(){return typeof this._value=="number"?Number.isInteger(this._value):this._value instanceof Q.exports.Decimal&&this._value.isInteger()}get isRational(){return!!Array.isArray(this._value)||this.isInteger}get isAlgebraic(){if(this.isRational)return!0}get isReal(){return!(!this.isFinite||this._value instanceof B.exports.Complex&&this.engine.chop(this._value.im)!==0)}get isExtendedReal(){return this.isInfinity||this.isReal}get isComplex(){return!this.isNaN}get isImaginary(){return this._value instanceof B.exports.Complex&&this._value.im!==0}get isExtendedComplex(){return this.isInfinity||!this.isNaN}get canonical(){if(this._isCanonical)return this;if(Array.isArray(this._value)){const[e,i]=$e(this._value);return Number.isNaN(e)||Number.isNaN(i)?this.engine.NAN:i===1?this.engine.number(e):i===0?e!==0&&Number.isFinite(e)?e<0?this.engine.NEGATIVE_INFINITY:this.engine.POSITIVE_INFINITY:this.engine.NAN:e===0?this.engine.ZERO:this.engine.number([e,i])}return this}simplify(e){return this.canonical}N(e){if(Array.isArray(this._value)){const i=this.engine,[n,r]=this._value;return pe(i)?i.number(i.decimal(n).div(r)):i.number(n/r)}return this}}class Re extends ye{constructor(e,i,n){super(e,n),this._string=i.normalize(),e._register(this)}get hash(){return be("String"+this._string)}get json(){return e=this.engine,i=i=this._string,e.jsonSerializationOptions.shorthands.includes("string")?`'${i}'`:{str:i};var e,i}get head(){return"String"}get isPure(){return!0}get isLiteral(){return!0}get isCanonical(){return!0}set isCanonical(e){}get domain(){return this.engine.domain("String")}get complexity(){return 19}get string(){return this._string}isEqual(e){return e.string===this._string}isSame(e){return e.string===this._string}match(e,i){return e instanceof Re&&this._string===e._string?{}:null}}function ge(t,e){if(e==null)return t.symbol("Nothing");if(e instanceof ye)return e;if(Array.isArray(e)){if(typeof e[0]!="number")return new Ve(t,typeof e[0]=="string"?e[0]:ge(t,e[0]),e.slice(1).map(r=>ge(t,r)));const[i,n]=e;return typeof n=="number"&&Number.isInteger(i)&&Number.isInteger(n)?t.number(e):t.fn("Divide",e)}if(typeof e=="number"||e instanceof B.exports.Complex||e instanceof Q.exports.Decimal)return t.number(e);if(typeof e=="string")return e.startsWith("'")&&e.endsWith("'")?new Re(t,e.slice(1,-1)):t.symbol(e);if(typeof e=="object"){const i={latex:e.latex,wikidata:e.wikidata};if("dict"in e)return new _e(t,e.dict,i);if("fn"in e)return typeof e.fn[0]=="string"?function(n,r,s,u){var o,a,l;if(r==="Hold")return new Ve(n,"Hold",[Tt(n,(o=s[0])!=null?o:"Missing")],u);if(r==="String")return s.length===0?new Re(n,"",u):new Re(n,s.map(h=>{var d;return(d=kn(h))!=null?d:""}).join(""),u);if(r==="Symbol"&&s.length>0)return n.symbol(s.map(h=>{var d;return(d=kn(h))!=null?d:""}).join(""),u);if((r==="Divide"||r==="Rational")&&s.length===2){const h=W(s[0]),d=W(s[1]);if(h!==null&&d!==null&&Number.isInteger(h)&&Number.isInteger(d))return n.number([h,d])}if(r==="Number"&&s.length===1)return ge(n,s[0]);if(r==="Complex"){if(s.length===1){const h=ge(n,s[0]),d=h.asFloat;return d!==null&&d!==0?new J(n,n.complex(0,d),u):n.mul([h,n.I])}if(s.length===2){const h=ge(n,s[0]),d=ge(n,s[1]),y=h.asFloat,N=d.asFloat;return N!==null&&y!==null?N===0&&y===0?n.ZERO:N!==null&&N!==0?new J(n,n.complex(y,N),u):h:n.add([h,n.mul([d,n.I])],u)}}if(r==="Negate"&&s.length>0&&typeof s[0]=="number")return n.number(-s[0],u);if(r==="Single"||r==="Pair"||r==="Triple")return n.fn("Tuple",s,u);if(r==="Dictionary"){const h={};for(const d of s){const y=n.box(d),N=y.head;if(N==="KeyValuePair"||N==="Pair"||N==="Tuple"){const x=y.op1;if(!x.isMissing){const k=y.op2;let M=(a=x.symbol)!=null?a:x.string;if(!M&&x.isLiteral){const P=(l=x.machineValue)!=null?l:x.asSmallInteger;P&&Number.isFinite(P)&&Number.isInteger(P)&&(M=P.toString())}M&&(h[M]=k)}}}return new _e(n,h,u)}return new Ve(n,r,s.map(h=>ge(n,h)),u)}(t,e.fn[0],e.fn.slice(1),i):t.fn(ge(t,e.fn[0]),e.fn.slice(1).map(n=>ge(t,n)),i);if("str"in e)return new Re(t,e.str,i);if("sym"in e)return t.symbol(e.sym,i);if("num"in e)return t.number(e,i)}return t.symbol("Undefined")}function En(t,e,i){var n;if(e instanceof J)return e;if(Array.isArray(e)){if(e.length!==2)throw Error("Array argument to boxNumber() should be two integers");const[r,s]=e;if(typeof r!="number"||typeof s!="number"||!Number.isInteger(r)||!Number.isInteger(s))throw Error("Array argument to boxNumber() should be two integers");if(s===r)return s===0?t.NAN:t.ONE;if(s===1)e=r;else{if(s!==-1)return r===1&&s===2?t.HALF:new J(t,[r,s],i);e=-r}}if(e instanceof B.exports.Complex){if(e.isNaN())return t.NAN;if(e.isZero())return t.ZERO;if(e.isInfinite())return t.COMPLEX_INFINITY;if(e.im!==0)return Ze(t)?new J(t,e,i):t.NAN;e=e.re}if(e instanceof Q.exports.Decimal)return e.isNaN()?t.NAN:e.equals(t.DECIMAL_NEGATIVE_ONE)?t.NEGATIVE_ONE:e.isZero()?t.ZERO:e.equals(t.DECIMAL_ONE)?t.ONE:e.equals(t.DECIMAL_TWO)?t.TWO:!e.isFinite()&&e.isPositive()?t.POSITIVE_INFINITY:!e.isFinite()&&e.isNegative()?t.NEGATIVE_INFINITY:new J(t,pe(t)?e:e.toNumber(),i);if(typeof e=="object"&&"num"in e){if(typeof e.num=="number")e=e.num;else if(typeof e.num=="string"){let r=e.num.toLowerCase();if(/[0-9][nd]$/.test(r)&&(r=r.slice(0,-1)),r=r.replace(/[\u0009-\u000d\u0020\u00a0]/g,""),/\([0-9]+\)$/.test(r)){const[s,u,o]=(n=r.match(/(.+)\(([0-9]+)\)$/))!=null?n:[];r=u+o.repeat(Math.ceil(t.precision/o.length))}return r==="nan"?t.NAN:r==="infinity"||r==="+infinity"?t.POSITIVE_INFINITY:r==="-infinity"?t.NEGATIVE_INFINITY:r==="0"?t.ZERO:r==="1"?t.ONE:r==="-1"?t.NEGATIVE_ONE:r==="2"?t.TWO:new J(t,r,i)}}if(typeof e=="number"){if(Number.isNaN(e))return t.NAN;if(!Number.isFinite(e)&&e>0&&t.POSITIVE_INFINITY,!Number.isFinite(e)&&e<0&&t.NEGATIVE_INFINITY,e===-1)return t.NEGATIVE_ONE;if(e===0)return t.ZERO;if(e===1)return t.ONE;if(e===2)return t.TWO}return typeof e=="number"?new J(t,e,i):null}function Tt(t,e){if(typeof e=="object"&&e instanceof ye)return e;if(typeof e=="string")return ge(t,e);if(Array.isArray(e)){const i=e.map(n=>Tt(t,n));return new Ve(t,i[0],i.slice(1))}if(typeof e=="object"){if("dict"in e)return new _e(t,e.dict);if("fn"in e)return Tt(t,e.fn);if("str"in e)return new Re(t,e.str);if("sym"in e)return ge(t,e.sym);if("num"in e)return ge(t,e.num)}return ge(t,e)}function kn(t){var e,i;if(typeof t=="string")return t;if(t instanceof ye)return(i=(e=t.string)!=null?e:t.symbol)!=null?i:t.toString();if(typeof t=="object"){if("str"in t)return t.str;if("fn"in t&&t.fn[0]==="String"&&typeof t.fn[1]=="string")return t.fn[1]}return Array.isArray(t)&&t[0]==="String"&&typeof t[1]=="string"?t[1]:null}function ur(t,e){if(!t.isLiteral)return null;let i;t.machineValue!==null&&(i=-t.machineValue),t.decimalValue&&(i=t.decimalValue.neg()),t.complexValue&&(i=t.complexValue.neg());const[n,r]=t.rationalValue;return n!==null&&r!==null&&(i=[-n,r]),i!==void 0?t.engine.number(i,e):null}function se(t,e){var i;if(t.head==="Negate")return t.op1;if(t.isLiteral)return ur(t,e);if(t.head==="Add"){let n=t.ops.map(r=>se(r));return n=(i=re(n,"Add"))!=null?i:n,t.engine.add(n,e)}return t.engine._fn("Negate",[t],e)}function Ni(t){var i;if(t.head==="Negate")return t.op1;if(t.isLiteral)return ur(t);const e=t.engine;if(t.head==="Add"){let n=t.ops.map(r=>Ni(r));return n=(i=re(n,"Add"))!=null?i:n,e.add(n)}return t.head==="Multiply"?function(n,r){let s=[],u=!1;for(const o of r)u||o.head!=="Negate"?s.push(o):(u=!0,s.push(o.op1));if(u)return n.mul(s);s=[];for(const o of r)!u&&o.isLiteral&&o.isInteger?(u=!0,s.push(Ni(o))):s.push(o);if(u)return n.mul(s);s=[];for(const o of r)!u&&o.isLiteral&&o.isNumber?(u=!0,s.push(Ni(o))):s.push(o);return u?n.mul(s):n._fn("Negate",[n._fn("Multiply",r)])}(e,t.ops):t.head==="Divide"?e.divide(Ni(t.op1),t.op2):e._fn("Negate",[t])}function vt(t,e,i="simplify"){return Ni(e)}class Wt{constructor(e,i){if(this._literal=[0,1],this._imaginary=0,this._posInfinityCount=0,this._negInfinityCount=0,this._terms=[],this.engine=e,i)for(const n of i)this.addTerm(n)}get isEmpty(){return this._terms.length===0&&this._literal[0]===0&&this._imaginary===0&&this._negInfinityCount===0&&this._posInfinityCount===0}addTerm(e,i){if(e.symbol==="Nothing")return;if(i===void 0&&(i=[1,1]),e.isLiteral){if(e.isInfinity)return void(e.isPositive?this._posInfinityCount+=1:this._negInfinityCount+=1);const[s,u]=e.asRational;if(s!==null&&u!==null)return void(this._literal=[i[0]*(this._literal[0]*u+s*this._literal[1]),i[1]*u*this._literal[1]]);if(e.complexValue){let o=e.complexValue.re,a=e.complexValue.im;if(Number.isInteger(o)&&Math.abs(o)<=1e6&&(this._literal[0]+=this._literal[1]*o*i[0]/i[1],o=0),Number.isInteger(a)&&Math.abs(a)<=1e6&&(this._imaginary+=a*i[0]/i[1],a=0),o===0&&a===0)return;e=this.engine.number(this.engine.complex(o,a)).canonical}}let n;if([n,e]=ii(e),n[0]===0)return;if(n=[n[0]*i[0],n[1]*i[1]],e.head==="Add"){for(const s of e.ops)this.addTerm(s,n);return}let r=!1;if(!e.isLiteral){if(this._terms.length>500){const s=e.hash;for(let u=0;u<this._terms.length;u++)if(!this._terms[u].term.isLiteral&&s===this._terms[u].term.hash&&e.isSame(this._terms[u].term)){const[o,a]=this._terms[u].coef,[l,h]=n;this._terms[u].coef=[o*h+a*l,a*h],r=!0;break}}else for(let s=0;s<this._terms.length;s++)if(!this._terms[s].term.isLiteral&&e.isSame(this._terms[s].term)){const[u,o]=this._terms[s].coef,[a,l]=n;this._terms[s].coef=[u*l+o*a,o*l],r=!0;break}}r||this._terms.push({term:e,coef:n})}terms(){var n;const e=this.engine;if(this._posInfinityCount>0&&this._negInfinityCount>0)return[e.NAN];if(this._posInfinityCount>0)return[e.POSITIVE_INFINITY];if(this._negInfinityCount>0)return[e.NEGATIVE_INFINITY];if(this._terms.length===0)return this._literal[0]===0&&this._imaginary===0?[]:this._imaginary===0?[e.number(this._literal).canonical]:this._literal[0]===0?[e.number(e.complex(0,this._imaginary)).canonical]:[e.number(this._literal).canonical,e.number(e.complex(0,this._imaginary)).canonical];const i=[];for(const{coef:[r,s],term:u}of this._terms)r!==0&&(r===s?i.push(u):r===-s?i.push(e.negate(u)):s===1?i.push(e.mul([e.number(r).canonical,u])):r===1?i.push(e.divide(u,e.number(s).canonical)):r!==0&&i.push(e.mul([e.number([r,s]).canonical,u])));return this._literal[0]!==0&&i.push(e.number(this._literal).canonical),this._imaginary!==0&&i.push(e.number(e.complex(0,this._imaginary)).canonical),(n=re(i,"Add"))!=null?n:i}asExpression(){const e=this.engine,i=this.terms();return i.length===0?e.ZERO:i.length===1?i[0]:e._fn("Add",i.sort((n,r)=>{const s=Vt(n),u=Vt(r);if(s<u)return-1;if(s>u)return 1;const o=Xi(n),a=Xi(r);if(o!==a)return a-o;const l=xn(n),h=xn(r);return l!==h?l-h:Bt(n,r)}))}}function Rt(t,e){var i,n,r,s;if((e=(i=re(e,"Add"))!=null?i:e).length<=1)return(n=e[0])!=null?n:t.symbol("Nothing");if(e.length===2){let u=0,o=0;if(e[0].isLiteral&&(o=e[0].machineValue,o=o===null&&e[0].decimalValue&&(r=e[0].asFloat)!=null?r:0),o!==0?u=Ct(e[1]):(u=Ct(e[0]),u!==0&&(o=e[1].machineValue,o=o===null&&e[1].decimalValue&&(s=e[1].asFloat)!=null?s:0)),u!==0)return t.number(t.complex(o,u));if(e[0].isLiteral&&e[1].isLiteral){if(e[0].isZero)return e[1];if(e[1].isZero)return e[0];const[a,l]=e[0].asRational,[h,d]=e[1].asRational;if(a!==null&&l!==null&&h!==null&&d!==null)return t.number([a*d+h*l,l*d])}}return new Wt(t,e).asExpression()}function In(t,e,i){const n=new Wt(t);for(const r of e){if(r.isImaginary&&r.isInfinity)return t.symbol("ComplexInfinity");if(r.isNaN||r.isMissing||r.symbol==="Undefined")return t.NAN;n.addTerm(r)}return n.asExpression()}function ni(t,e,i,n){if(i.symbol==="ComplexInfinity")return t.NAN;if(i.isLiteral){if(i.isZero)return t.ONE;if(e.isLiteral){if(e.isOne)return t.ONE;if(e.isZero){if(i.isPositive)return t.ZERO;if(i.isNegative)return t.COMPLEX_INFINITY}if(i.isOne)return e;if(i.isNegativeOne){if(e.isOne)return t.ONE;if(e.isNegativeOne)return t.NEGATIVE_ONE;if(e.isInfinity)return t.ZERO;const[o,a]=e.rationalValue;if(o!==null&&a!==null)return t.number([a,o],n);const l=e.asFloat;return l!==null&&Number.isInteger(l)?t.number([1,l],n):t._fn("Power",[e,t.NEGATIVE_ONE],n)}const r=i.asFloat;if(r===.5||r===-.5){const o=e.asSmallInteger;if(o!==null&&o>0){const[a,l]=Ei(o,2);if(l===1&&a===1)return t.ONE;if(a!==1)return l===1?t.number(r>=0?a:[1,a]):t.mul([t.number(a),t.power(t.number(l),t.HALF)])}return r>0?t._fn("Power",[e,t.HALF],n):t._fn("Power",[e,t.number([-1,2])],n)}if(e.isInfinity){if(i.complexValue){const o=i.complexValue.re;if(o===0)return t.NAN;if(o<0)return t.ZERO;if(o>0)return t.COMPLEX_INFINITY}if(e.isNegative){if(i.isInfinity)return t.NAN}else if(e.isPositive){if(i.isNegativeOne)return t.ZERO;if(i.isInfinity)return i.isNegative?t.ZERO:t.POSITIVE_INFINITY}}if(i.isInfinity&&(e.isOne||e.isNegativeOne))return t.NAN;const[s,u]=e.asRational;if(s!==null&&u!==null){const o=i.asSmallInteger;if(o!==null)return o===-1?t.number([u,s]):o>0?t.number([Math.pow(s,o),Math.pow(u,o)]):t.number([Math.pow(u,-o),Math.pow(s,-o)])}}}if(e.head==="Power"&&e.op1.isReal){const r=i.asSmallInteger;if(r!==null){const s=e.op2.asSmallInteger;if(s!==null)return t._fn("Power",[e.op1,t.number(r*s)])}if(e.op1.isNonNegative){const[s,u]=i.asRational;if(s!==null&&u!==null){const[o,a]=e.op2.asRational;if(o!==null&&a!==null)return t._fn("Power",[e.op1,t.number([s*o,u*a])])}}}return e.head==="Multiply"&&i.asSmallInteger!==null?t._fn("Multiply",e.ops.map(r=>t.power(r,i))):null}function cr(t,e){if(e.machineValue)return t.number(Math.pow(e.machineValue,2));if(e.decimalValue)return t.number(e.decimalValue.pow(2));if(e.complexValue)return t.number(e.complexValue.pow(2));const[i,n]=e.rationalValue;if(i!==null&&n!==null)return t.number([Math.pow(n,2),Math.pow(i,2)]);if(e.head==="Multiply")return t._fn("Multiply",e.ops.map(r=>cr(t,r)));if(e.head==="Power"){const r=e.op2.asSmallInteger;return r!==null?t._fn("Power",[e.op1,t.number(2*r)]):t._fn("Power",[e.op1,t.mul([t.TWO,e.op2])])}return t._fn("Power",[e,t.TWO])}function yt(t,e,i,n){var r,s,u,o,a,l;if(n==="N"&&e.isLiteral&&i.isLiteral)return e.complexValue?t.number(e.complexValue.pow((s=(r=i.complexValue)!=null?r:i.asFloat)!=null?s:NaN)):i.complexValue&&e.asFloat?t.number(t.complex(e.asFloat).pow(i.complexValue)):e.decimalValue?t.number(e.decimalValue.pow((u=i.decimalValue)!=null?u:i.asFloat)):e.asFloat&&(i.decimalValue||pe(t))?t.number(t.decimal(e.asFloat).pow((o=i.decimalValue)!=null?o:i.asFloat)):t.number(Math.pow((a=e.asFloat)!=null?a:NaN,(l=i.asFloat)!=null?l:NaN));if(e.asSmallInteger!==null){const[h,d]=i.rationalValue;if(!(h!==1&&h!==-1||d!==2&&d!==3)){const[y,N]=Ei(e.asSmallInteger,d);return N===1&&y===1?t.ONE:y===1?void 0:N===1?t.number(h>=0?y:[1,y]):t.mul([t.number(y),t.power(t.number(N),i)])}}}function hr(t,e){var i;return(e=(i=re(e,"Multiply"))!=null?i:e).length===0?t.symbol("Nothing"):e.length===1?e[0]:e.length===2?mr(e[0],e[1]):new Ai(t,e).asExpression()}function An(t,e,i){const n=new Ai(t);for(const r of e){if(r.isNaN||r.isMissing||r.symbol==="Undefined")return t.NAN;n.addTerm(r)}return n.asExpression()}function mr(t,e,i){const n=t.engine;if(t.isLiteral&&e.isLiteral&&t.isInteger&&e.isInteger){if(t.decimalValue&&e.decimalValue)return n.number(t.decimalValue.mul(e.decimalValue));if(t.machineValue&&e.machineValue)return n.number(t.machineValue*e.machineValue)}if(t.symbol==="Nothing")return e;if(e.symbol==="Nothing")return t;if(t.isLiteral&&t.isOne)return e;if(e.isLiteral&&e.isOne)return t;if(t.isLiteral&&t.isNegativeOne)return se(e);if(e.isLiteral&&e.isNegativeOne)return se(t);if(t.isMissing||e.isMissing)return n._fn("Multiply",[t,e]);let r=1,s=t,u=e;s.isLiteral&&s.asRational!==null||(u=e,s=t),u.head==="Negate"&&(u=u.op1,r=-r);const[o,a]=s.asRational;if(s.isLiteral&&o!==null&&a!==null){if(o===a)return u;if(o===0)return n.ZERO;if(u.head==="Add")return r<0&&(s=se(s)),n.add(u.ops.map(h=>mr(s,h)),i);if(u.isLiteral){const[h,d]=u.asRational;if(h!==null&&d!==null)return n.number($e([r*o*h,d*a]),i)}return r<0?n._fn("Multiply",[se(s),u],i):n._fn("Multiply",[s,u],i)}if(s.hash===u.hash&&s.isSame(u))return cr(n,s);const l=new Ai(n,[s,u]);return r>0?l.asExpression():se(l.asExpression(),i)}function zt(t,e,i){if(e.isLiteral&&i.isLiteral){if(e.isOne)return t.inverse(i);if(e.isNegativeOne)return se(t.inverse(i));if(i.isOne)return e;if(i.isNegativeOne)return se(e);const[o,a]=[e.asSmallInteger,i.asSmallInteger];if(o!==null&&a!==null&&a!==0)return t.number($e([o,a]))}if(e.head==="Divide"&&i.head==="Divide")return t.divide(t.mul([e.op1,i.op2]),t.mul([e.op2,i.op1]));if(e.head==="Divide")return t.divide(t.mul([e.op1,i]),e.op2);if(i.head==="Divide")return t.divide(t.mul([e,i.op2]),i.op1);let[n,r]=_n(e),[s,u]=_n(i);return r=r.canonical,u=u.canonical,u.isLiteral&&u.isOne?n*s<0?se(r):r:(u=t.inverse(u),r.isOne?u:r.isNegativeOne?se(u):n*s>0?t.mul([r,u]):t.negate(t.mul([r,u])))}const Ws=[{functions:[{name:"Abs",domain:["Function","ExtendedRealNumber","ExtendedRealNumber"],range:[0,1/0],wikidata:"Q3317982",threadable:!0,idempotent:!0,complexity:1200,simplify:(t,e)=>Nt(t,e[0],"simplify"),evaluate:(t,e)=>Nt(t,e[0],"evaluate"),N:(t,e)=>Nt(t,e[0],"N")},{name:"Add",wikidata:"Q32043",associative:!0,commutative:!0,threadable:!0,idempotent:!0,domain:"NumericFunction",complexity:1300,canonical:(t,e)=>Rt(t,e),simplify:(t,e)=>In(t,e),evaluate:(t,e)=>In(t,e),N:(t,e)=>function(i,n){for(const h of n){if(h.isImaginary&&h.isInfinity)return i.symbol("ComplexInfinity");if(h.isNaN||h.isMissing||h.symbol==="Undefined")return i.NAN}let[r,s]=[0,1],u=0,o=i.DECIMAL_ZERO,a=B.exports.Complex.ZERO;const l=new Wt(i);for(const h of n)if(h.symbol!=="Nothing"&&!h.isZero){const[d,y]=h.rationalValue;d!==null&&y!==null?[r,s]=[r*y+s*d,s*y]:h.decimalValue!==null?o=o.add(h.decimalValue):h.machineValue!==null?pe(i)?o=o.add(h.machineValue):u+=h.machineValue:h.complexValue!==null?a=a.add(h.complexValue):l.addTerm(h)}if(!Ze(i)&&a.im!==0)return i.NAN;if(pe(i)||i.chop(o)!==0){let h=o;if(r!==0&&(h=h.mul(s).add(r).div(s)),u!==0&&(h=h.add(u)),a.re!==0&&(h=h.add(a.re)),a.im!==0)if(ki(h)){const d=i.number(i.complex(h.toNumber(),a.im));if(l.isEmpty)return d;l.addTerm(d)}else l.addTerm(i.number(i.complex(0,a.im))),l.addTerm(i.number(h));else{if(l.isEmpty)return i.number(h);l.addTerm(i.number(h))}}else{const h=u+a.re+r/s,d=i.number(a.im===0?h:i.complex(h,a.im));if(l.isEmpty)return d;l.addTerm(d)}return l.asExpression()}(t,e)},{name:"Ceil",description:"Rounds a number up to the next largest integer",complexity:1250,domain:"NumericFunction",evaluate:(t,e)=>{const i=e[0];return i.decimalValue?t.number(i.decimalValue.ceil()):i.complexValue?t.number(i.complexValue.ceil(0)):i.asFloat!==null?t.number(Math.ceil(i.asFloat)):void 0}},{name:"Chop",associative:!0,threadable:!0,idempotent:!0,complexity:1200,domain:"NumericFunction",N:(t,e)=>{const i=e[0];return i.decimalValue?t.number(t.chop(i.decimalValue)):i.complexValue?t.number(t.chop(i.complexValue)):i.asFloat!==null?t.number(t.chop(i.asFloat)):void 0}},{name:"Complex",wikidata:"Q11567",domain:"NumericFunction",complexity:500},{name:"Divide",wikidata:"Q1226939",domain:"NumericFunction",complexity:2500,canonical:(t,e)=>e[0]&&e[1]?zt(t,e[0],e[1]):t.symbol("Missing")},{name:"Exp",domain:"NumericFunction",wikidata:"Q168698",threadable:!0,complexity:3500,canonical:(t,e)=>e[0]?t.power(t.symbol("ExponentialE"),e[0]):t.symbol("Missing")},{name:"Erf",description:"Complementary Error Function",domain:"NumericFunction",complexity:7500},{name:"Erfc",description:"Complementary Error Function",domain:"NumericFunction",complexity:7500},{name:"Factorial",description:"The factorial function",wikidata:"Q120976",complexity:9e3,domain:"NumericFunction",evaluate:(t,e)=>{const i=e[0].asSmallInteger;return i!==null&&i>=0?pe(t)?t.number(rr(t,t.decimal(i))):t.number(function(n){if(!Number.isInteger(n)||n<0)return NaN;let r=1;for(let s=2;s<=n;s++)r*=s;return r}(i)):e[0].complexValue?t.number(e[0].complexValue.add(1)):e[0].asFloat!==null?t.number(Pt(1+e[0].asFloat)):void 0}},{name:"Floor",wikidata:"Q56860783",domain:["Function","ExtendedRealNumber","ExtendedRealNumber"],complexity:1250,evaluate:(t,e)=>e[0].decimalValue?t.number(e[0].decimalValue.floor()):e[0].complexValue?t.number(e[0].complexValue.floor(0)):e[0].asFloat!==null?t.number(Math.floor(e[0].asFloat)):void 0},{name:"Gamma",wikidata:"Q190573",domain:["Function","Number","Number"],complexity:8e3,N:(t,e)=>e[0].decimalValue?t.number(ar(t,e[0].decimalValue)):e[0].complexValue?t.number(e[0].complexValue):e[0].asFloat!==null?t.number(Pt(e[0].asFloat)):void 0},{name:"LogGamma",domain:["Function","Number","Number"],complexity:8e3,N:(t,e)=>e[0].decimalValue?t.number(sr(t,e[0].decimalValue)):e[0].complexValue?t.number(e[0].complexValue):e[0].asFloat!==null?t.number(tr(e[0].asFloat)):void 0},{name:"Ln",description:"Natural Logarithm",domain:["Function","Number","Number"],wikidata:"Q204037",complexity:4e3,N:(t,e)=>e[0].decimalValue?t.number(e[0].decimalValue.log()):e[0].complexValue?t.number(e[0].complexValue.log()):e[0].asFloat!==null?t.number(Math.log(e[0].asFloat)):void 0},{name:"Log",description:"Log(b, z) = Logarithm of base b",wikidata:"Q11197",domain:["Function","Number","Number","Number"],complexity:4100,N:(t,e)=>{var r,s,u,o,a;const i=e[0],n=e[1];return i.decimalValue?t.number(i.decimalValue.log().div((s=(r=n.decimalValue)!=null?r:n.asFloat)!=null?s:NaN)):i.complexValue?t.number(i.complexValue.log().div((o=(u=n.complexValue)!=null?u:n.asFloat)!=null?o:NaN)):i.asFloat!==null?t.number(Math.log(i.asFloat)/Math.log((a=n.asFloat)!=null?a:NaN)):void 0}},{name:"Lb",description:"Base-2 Logarithm",domain:["Function","Number","Number"],wikidata:"Q581168",complexity:4100,N:(t,e)=>{const i=e[0];return i.decimalValue?t.number(i.decimalValue.log().div(t.DECIMAL_TWO)):i.complexValue?t.number(i.complexValue.log().div(t.complex(2))):i.asFloat!==null?t.number(Math.log2(i.asFloat)):void 0}},{name:"Lg",description:"Base-10 Logarithm",domain:["Function","Number","Number"],wikidata:"Q966582",complexity:4100,N:(t,e)=>{const i=e[0];return i.decimalValue?t.number(i.decimalValue.log().div(t.decimal(10))):i.complexValue?t.number(i.complexValue.log().div(t.complex(10))):i.asFloat!==null?t.number(Math.log10(i.asFloat)):void 0}},{name:"Multiply",domain:"NumericFunction",wikidata:"Q40276",associative:!0,commutative:!0,idempotent:!0,complexity:2100,canonical:(t,e)=>hr(t,e),simplify:(t,e)=>An(t,e),evaluate:(t,e)=>An(t,e),N:(t,e)=>function(i,n){for(const h of n)if(h.isNaN||h.isMissing||h.symbol==="Undefined")return i.NAN;let[r,s]=[1,1],u=1,o=i.DECIMAL_ONE,a=B.exports.Complex.ONE;const l=new Ai(i);for(const h of n)if(h.symbol!=="Nothing"&&!h.isOne){const[d,y]=h.rationalValue;d!==null&&y!==null?[r,s]=[r*d,s*y]:h.decimalValue!==null?o=o.mul(h.decimalValue):h.machineValue!==null?pe(i)?o=o.mul(h.machineValue):u*=h.machineValue:h.complexValue!==null?a=a.mul(h.complexValue):l.addTerm(h)}if(!Ze(i)&&a.im!==0)return i.NAN;if(pe(i)||!o.eq(i.DECIMAL_ONE)){const h=o.mul(r).div(s).mul(u);if(a.re!==1||a.im!==0)if(ki(h)){const d=i.number(i.complex(a.mul(h.toNumber())));if(l.isEmpty)return d;l.addTerm(d)}else{if(l.isEmpty)return i._fn("Multiply",[i.number(a),i.number(h)]);l.addTerm(i.number(a)),l.addTerm(i.number(h))}else{if(l.isEmpty)return i.number(h);l.addTerm(i.number(h))}}else{const h=u*r/s;let d;if(d=a.re!==1||a.im!==0?i.number(a.mul(h)):i.number(h),l.isEmpty)return d;l.addTerm(d)}return l.asExpression()}(t,e)},{name:"Negate",description:"Additive Inverse",wikidata:"Q715358",domain:["Function","Number","Number"],complexity:2e3,canonical:(t,e)=>e[0]?se(e[0]):t.box("Missing"),simplify:(t,e)=>vt(0,e[0],"simplify"),evaluate:(t,e)=>vt(0,e[0],"evaluate"),N:(t,e)=>vt(0,e[0],"N"),sgn:(t,e)=>{var n;const i=(n=e[0])!=null?n:t.symbol("Missing");return i.isZero?0:i.isPositive?-1:i.isNegative?1:void 0}},{name:"Power",domain:["Function","Number","Number","Number"],wikidata:"Q33456",commutative:!1,complexity:3500,canonical:(t,e)=>{var r,s,u;const i=(r=e[0])!=null?r:t.symbol("Missing"),n=(s=e[1])!=null?s:t.symbol("Missing");return(u=ni(t,i,n))!=null?u:t._fn("Power",e)},simplify:(t,e)=>yt(t,e[0],e[1],"simplify"),evaluate:(t,e)=>yt(t,e[0],e[1],"evaluate"),N:(t,e)=>yt(t,e[0],e[1],"N")},{name:"Rational",domain:["Function","Number",["Optional","Number"],"RationalNumber"],complexity:2400,canonical:(t,e)=>e.length===2?zt(t,e[0],e[1]):t._fn("Rational",e),simplify:(t,e)=>{if(e.length===2)return e[0].asSmallInteger!==null&&e[1].asSmallInteger!==null?t.number([e[0].asSmallInteger,e[1].asSmallInteger]):void 0},evaluate:(t,e)=>{if(e.length===2)return e[0].asSmallInteger!==null&&e[1].asSmallInteger!==null?t.number([e[0].asSmallInteger,e[1].asSmallInteger]):void 0;const i=e[0].asFloat;if(i===null)return e[0];const n=function(r){if(!Number.isFinite(r)||r%1==0)return r;let s=Math.floor(r),u=1,o=0,a=s,l=1;for(;r-s>1e-15*l*l;){s=Math.floor(r=1/(r-s));const h=u;u=a;const d=o;o=l,a=h+s*u,l=d+s*o}return[a,l]}(i);return typeof n=="number"?t.number(n):t.number([n[0],n[1]])},N:(t,e)=>{if(e.length===2)return e[0].asSmallInteger===null||e[1].asSmallInteger===null?void 0:t.number(e[0].asSmallInteger/e[1].asSmallInteger)}},{name:"Root",domain:["Function","Number","RationalNumber","Number"],complexity:3200,canonical:(t,e)=>{var s,u,o;const i=(s=e[0])!=null?s:t.symbol("Missing"),n=(u=e[1])!=null?u:t.symbol("Missing"),r=t.inverse(n);return(o=ni(t,i,r))!=null?o:t._fn("Power",[i,r])},N:(t,e)=>{var r,s,u;const i=e[0],n=e[1];if(i.decimalValue)return t.number(i.decimalValue.pow(t.DECIMAL_ONE.div((r=n.asFloat)!=null?r:NaN)));if(i.complexValue){const o=n.complexValue?B.exports.Complex.ONE.div(n.complexValue):t.complex(1/((s=n.asFloat)!=null?s:NaN));return t.number(i.complexValue.pow(o))}return i.asFloat!==null?t.number(Math.pow(i.asFloat,(u=n.asFloat)!=null?u:NaN)):void 0}},{name:"Round",domain:["Function","Number","Number"],complexity:1250,N:(t,e)=>e[0].decimalValue?t.number(e[0].decimalValue.round()):e[0].complexValue?t.number(e[0].complexValue.round(0)):e[0].asFloat!==null?t.number(Math.round(e[0].asFloat)):void 0},{name:"Sign",domain:["Function","Number","Integer"],range:[-1,1],complexity:1200,simplify:(t,e)=>{const i=e[0].sgn;return i===0?t.ZERO:i===1?t.ONE:i===-1?t.NEGATIVE_ONE:void 0},evaluate:(t,e)=>{const i=e[0].sgn;return i===0?t.ZERO:i===1?t.ONE:i===-1?t.NEGATIVE_ONE:void 0},N:(t,e)=>{const i=e[0].sgn;return i===0?t.ZERO:i===1?t.ONE:i===-1?t.NEGATIVE_ONE:void 0}},{name:"SignGamma",description:"The sign of the gamma function: -1 or +1",domain:["Function","Number","Integer"],complexity:7900,range:[-1,1]},{name:"Sqrt",description:"Square Root",domain:["Function","Number","Number"],wikidata:"Q134237",complexity:3e3,canonical:(t,e)=>{var i;return e[0]?(i=ni(t,e[0],t.HALF))!=null?i:t._fn("Power",[e[0],t.HALF]):t._fn("Power",[t.symbol("Missing"),t.HALF])},simplify:(t,e)=>xt(t,e[0],"simplify"),evaluate:(t,e)=>xt(t,e[0],"evaluate"),N:(t,e)=>xt(t,e[0],"N")},{name:"Square",domain:["Function","Number","Number"],wikidata:"Q3075175",complexity:3100,canonical:(t,e)=>{var i;return e[0]?(i=ni(t,e[0],t.TWO))!=null?i:t._fn("Power",[e[0],t.TWO]):t._fn("Power",[t.symbol("Missing"),t.TWO])},N:(t,e)=>e[0].decimalValue?t.number(e[0].decimalValue.mul(e[0].decimalValue)):e[0].complexValue?t.number(e[0].complexValue.mul(e[0].complexValue)):e[0].asFloat!==null?t.number(e[0].asFloat*e[0].asFloat):void 0},{name:"Subscript",domain:["Function","Anything","Anything","Anything"],hold:"last",canonical:(t,e)=>{var r,s,u,o;const i=(r=e[0])!=null?r:t.symbol("Missing"),n=(s=e[1])!=null?s:t.symbol("Missing");if(i.string&&n.isLiteral&&n.asSmallInteger!==null){const a=n.asSmallInteger;if(a>1&&a<=36){const[l,h]=nr(i.string,a);return h?t._fn("Error",[t.number(l),t.string("unexpected-digits"),t._fn("LatexForm",[t.string(h)])]):t.number(l)}}if(i.symbol){if((u=i.symbolDefinition)!=null&&u.at)return t._fn("At",[i,n]);let a=(o=n.string)!=null?o:n.symbol;if(a||n.asSmallInteger!==null&&(a=n.asSmallInteger.toString()),a)return t.symbol(i.symbol+"_"+a)}return t._fn("Subscript",e)}},{name:"Subtract",domain:["Function","Number","Number","Number"],wikidata:"Q40754",complexity:1350,canonical:(t,e)=>e.length===0?t.symbol("Nothing"):e.length===1?se(e[0]):Rt(t,[e[0],se(e[1])]),N:(t,e)=>{var r,s,u,o,a,l;const i=e[0],n=e[1];return i.complexValue||n.complexValue?t.number(t.complex((r=i.complexValue)!=null?r:i.asFloat).sub((s=n.complexValue)!=null?s:n.asFloat)):i.decimalValue||n.decimalValue?t.number(t.decimal((o=(u=i.decimalValue)!=null?u:i.asFloat)!=null?o:NaN).sub((l=(a=n.decimalValue)!=null?a:n.asFloat)!=null?l:NaN)):i.asFloat!==null&&n.asFloat!==null?t.number(i.asFloat-n.asFloat):void 0}}]},{symbols:[{name:"MachineEpsilon",domain:"RealNumber",constant:!0,real:!0,value:{num:Number.EPSILON.toString()}},{name:"Half",constant:!0,hold:!1,value:["Rational",1,2]},{name:"ImaginaryUnit",domain:"ImaginaryNumber",constant:!0,hold:!0,wikidata:"Q193796",imaginary:!0,value:["Complex",0,1]},{name:"ExponentialE",domain:"TranscendentalNumber",algebraic:!1,wikidata:"Q82435",constant:!0,hold:!0,real:!0,value:t=>pe(t)?t.DECIMAL_ONE.exp():Math.exp(1)},{name:"GoldenRatio",domain:"AlgebraicNumber",wikidata:"Q41690",constant:!0,algebraic:!0,hold:!1,value:["Divide",["Add",1,["Sqrt",5]],2]},{name:"CatalanConstant",domain:"RealNumber",algebraic:void 0,wikidata:"Q855282",constant:!0,value:{num:`0.91596559417721901505460351493238411077414937428167
                  21342664981196217630197762547694793565129261151062
                  48574422619196199579035898803325859059431594737481
                  15840699533202877331946051903872747816408786590902
                  47064841521630002287276409423882599577415088163974
                  70252482011560707644883807873370489900864775113225
                  99713434074854075532307685653357680958352602193823
                  23950800720680355761048235733942319149829836189977
                  06903640418086217941101917532743149978233976105512
                  24779530324875371878665828082360570225594194818097
                  53509711315712615804242723636439850017382875977976
                  53068370092980873887495610893659771940968726844441
                  66804621624339864838916280448281506273022742073884
                  31172218272190472255870531908685735423498539498309
                  91911596738846450861515249962423704374517773723517
                  75440708538464401321748392999947572446199754961975
                  87064007474870701490937678873045869979860644874974
                  64387206238513712392736304998503539223928787979063
                  36440323547845358519277777872709060830319943013323
                  16712476158709792455479119092126201854803963934243
                  `}},{name:"EulerGamma",domain:"RealNumber",algebraic:void 0,wikidata:"Q273023",constant:!0,value:{num:`0.57721566490153286060651209008240243104215933593992359880576723488486772677766
          467093694706329174674951463144724980708248096050401448654283622417399764492353
          625350033374293733773767394279259525824709491600873520394816567085323315177661
          152862119950150798479374508570574002992135478614669402960432542151905877553526
          733139925401296742051375413954911168510280798423487758720503843109399736137255
          306088933126760017247953783675927135157722610273492913940798430103417771778088
          154957066107501016191663340152278935867965497252036212879226555953669628176388
          792726801324310104765059637039473949576389065729679296010090151251959509222435
          014093498712282479497471956469763185066761290638110518241974448678363808617494
          551698927923018773910729457815543160050021828440960537724342032854783670151773
          943987003023703395183286900015581939880427074115422278197165230110735658339673`}}]},{functions:[{name:"PreIncrement",domain:["Function","Number","Number"]},{name:"PreDecrement",domain:["Function","Number","Number"]}]}];function Nt(t,e,i){if(i!=="simplify"||e.isLiteral){if(e.machineValue!==null)return t.number(Math.abs(e.machineValue));if(e.decimalValue)return t.number(e.decimalValue.abs());if(e.complexValue)return t.number(e.complexValue.abs());const[n,r]=e.rationalValue;return n===null||r===null?void 0:t.number(i==="N"?Math.abs(n/r):[Math.abs(n),r])}if(!e.isMissing)return e.isNonNegative?e:e.isNegative?t.negate(e):void 0}function xt(t,e,i){if(e.isOne)return t.ONE;if(e.isZero)return t.ZERO;if(i==="N")return e.complexValue?t.number(e.complexValue.sqrt()):e.isNonNegative?e.decimalValue?t.number(e.decimalValue.sqrt()):e.asFloat!==null?t.number(Math.sqrt(e.asFloat)):void 0:Ze(t)?t.number(t.complex(e.asFloat).sqrt()):t.NAN;if(e.asSmallInteger!==null){const[n,r]=Ei(e.asSmallInteger,2);if(r===1)return t.number(n);if(n!==1)return this._fn("Multiply",[n,t._fn("Sqrt",[t.box(r).canonical])])}}const Us=[{symbols:[{name:"Missing",domain:"Anything"},{name:"Nothing",domain:"Nothing"}]},{functions:[{name:"KeyValuePair",domain:["Function","String","Anything",["Tuple","String","Anything"]],description:"A key/value pair",complexity:8200,canonical:(t,e)=>t.tuple(e)},{name:"Single",domain:["Function","Anything",["Tuple","Anything"]],description:"A tuple with a single element",complexity:8200,canonical:(t,e)=>t.tuple(e)},{name:"Pair",domain:["Function","Anything","Anything",["Tuple","Anything","Anything"]],description:"A tuple of two elements",complexity:8200,canonical:(t,e)=>t.tuple(e)},{name:"Triple",domain:["Function","Anything","Anything","Anything",["Tuple","Anything","Anything","Anything"]],description:"A tuple of three elements",complexity:8200,canonical:(t,e)=>t.tuple(e)},{name:"Tuple",domain:["Function",["Some","Anything"],["Tuple",["Some","Anything"]]],description:"A fixed number of heterogeneous elements",complexity:8200}]},{functions:[{name:"BaseForm",domain:["Function","Anything",["Optional","Integer"],"String"],description:"`BaseForm(expr, base=10)`",complexity:9e3,inert:!0},{name:"Delimiter",domain:(t,e)=>{if(!e[0])return"Nothing";const i=e[0].domain.domainExpression;return["Function",i,["Optional","String"],i]},complexity:9e3,inert:!0,canonical:(t,e)=>!e[0]||e[0].isMissing?t.symbol("Nothing"):e[0]},{name:"Error",domain:(t,e)=>{if(!e[0])return"Nothing";const i=e[0].domain.domainExpression;return["Function",i,["Optional","String"],["Optional","Expression"],i]},complexity:500,inert:!0,hold:"all",evaluate:(t,e)=>e[0].evaluate()},{name:"Style",domain:(t,e)=>{if(!e[0])return"Nothing";const i=e[0].domain.domainExpression;return["Function",i,["Optional",["Head","Dictionary"]],i]},complexity:9e3,inert:!0}]},{functions:[{name:"Apply",domain:"Function"},{name:"About",domain:"Function"},{name:"Block",domain:"Function"},{name:"Domain",domain:"Function"},{name:"Evaluate",domain:"Function",hold:"all",evaluate:(t,e)=>e[0].evaluate()},{name:"FromDigits",description:"`FromDigits(s, base=10)`       return an integer representation of the string `s` in base `base`.",evaluate:(t,e)=>{const i=e[0];if(i.isMissing)return;if(!i.string)return t.error(t._fn("FromDigits",e),"Expected first argument as a string",["LatexForm",i.latex]);const n=e[1];if(n.isMissing&&t.number(Number.parseInt(i.string,10)),n.machineValue===null)return["Error",t._fn("FromDigits",e),{str:"Expected `base` as an integer between 2 and 36"},["LatexForm",n.latex]];const r=n.machineValue;if(r<2||r>36)return["Error",t._fn("FromDigits",e),{str:"Expected `base` as an integer between 2 and 36"},["LatexForm",n.latex]];const[s,u]=nr(i.string,r);return u?["Error",s,{str:"unexpected-digits"},["LatexForm",u]]:t.number(s)}},{name:"Head",domain:"Function",evaluate:(t,e)=>{const i=e[0];return typeof i.head=="string"?t.symbol(i.head):i.head}},{name:"Html",domain:["Function","Expression","String"],evaluate:(t,e)=>(e.length,t.string(""))},{name:"IntegerString",domain:["Function","Integer",["Optional","Integer"],"String"],description:"`IntegerString(n, base=10)`       return a string representation of the integer `n` in base `base`.",evaluate:(t,e)=>{var u,o,a,l;const i=e[0];if(i.isMissing)return;const n=(a=(o=i.machineValue)!=null?o:(u=i.decimalValue)==null?void 0:u.toNumber())!=null?a:NaN;if(Number.isNaN(n)||!Number.isInteger(n))return void t.signal(t._fn("IntegerString",e),`Expected first argument as an integer. Got \\(${i.latex}$\\)`);const r=e[1];if(r.isMissing)return i.machineValue?t.string(Math.abs(i.machineValue).toString()):i.decimalValue?t.string(i.decimalValue.abs().toString()):t.string(Math.abs(Math.round((l=i.asFloat)!=null?l:NaN)).toString());if(r.asSmallInteger===null)return void t.signal(t._fn("IntegerString",e),`Expected \`base\` as an integer between 2 and 36. Got \\(${r.latex}$\\)`);const s=r.asSmallInteger;if(!(s<2||s>36))return t.string(Math.abs(n).toString(s));t.signal(t._fn("IntegerString",e),"Expected `base` as an integer between 2 and 36. Got "+s)}},{name:"Lambda",domain:"Function",wikidata:"Q567612",hold:"all"},{name:"Latex",domain:"Function",evaluate:(t,e)=>e.length===0?t._fn("LatexString",[]):t._fn("LatexString",[t.string(X(e.map(i=>i.latex)))])},{name:"LatexString",domain:"Function",evaluate:(t,e)=>e.length===0?t._fn("LatexString",[]):t._fn("LatexString",[t.string(X(e.map(i=>t.serialize(i))))])},{name:"LatexTokens",domain:"Function",evaluate:(t,e)=>e.length===0?t._fn("LatexString",[]):t._fn("LatexString",[t.string(X(e.map(i=>t.serialize(i))))])},{name:"Parse",domain:"Function",evaluate:(t,e)=>{if(e.length===0)return t.symbol("Nothing");const i=X(e.map(n=>t.serialize(n)));return t.parse(i)}},{name:"String",domain:["Function",["Some","Anything"],"String"],threadable:!0,evaluate:(t,e)=>e.length===0?t.string(""):t.string(e.map(i=>{var n;return(n=i.string)!=null?n:`\\(${i.latex}$\\)`}).join(""))},{name:"Symbol",complexity:500,description:"Construct a new symbol with a name formed by concatenating the arguments",domain:["Function",["Some","Anything"],"Symbol"],threadable:!0,evaluate:(t,e)=>{if(e.length===0)return t.symbol("Nothing");const i=e.map(n=>{const r=n.symbol;if(r!==null)return r;const s=i.string;if(s!==null)return s;const u=i.smallIntegerValue;return u!==null?u.toString():""}).join("");return i.length>0?t.symbol(i):t.symbol("Nothing")}},{name:"SymbolName",domain:["Function","Anything","String"],evaluate:(t,e)=>e[0].symbol?t.string(e[0].symbol):t.symbol("Nothing")},{name:"Tail",domain:["Function","Expression",["List","Expression]"]],evaluate:(t,e)=>{var i;return t._fn("List",(i=e[0].ops)!=null?i:[])}},{name:"Timing",description:"`Timing(expr)` evaluates `expr` and return a `Pair` of the number of second elapsed for the evaluation, and the value of the evaluation",domain:["Function","Expression",["Tuple","Expression","Number"]],evaluate:(t,e)=>{var a;if(!e[1]||e[1].isMissing){const l=globalThis.performance.now(),h=e[0].evaluate(),d=1e3*(globalThis.performance.now()-l);return t.pair(t.number(d),h)}let i,n=Math.max(3,Math.round((a=e[1].asSmallInteger)!=null?a:3)),r=[];for(;n>0;){const l=globalThis.performance.now();i=e[0].evaluate(),r.push(1e3*(globalThis.performance.now()-l)),n-=1}const s=Math.max(...r),u=Math.min(...r);r=r.filter(l=>l>u&&l<s);const o=r.reduce((l,h)=>l+h,0);return o===0?t.pair(t.number(s),i):t.pair(t.number(o/r.length),i)}}]}],Qs={symbols:[{name:"True",wikidata:"Q16751793",domain:"Boolean",constant:!0},{name:"False",wikidata:"Q5432619",domain:"Boolean",constant:!0},{name:"Maybe",wikidata:"Q781546",domain:"MaybeBoolean",constant:!0}],functions:[{name:"And",wikidata:"Q191081",domain:"LogicOperator",threadable:!0,associative:!0,commutative:!0,idempotent:!0,complexity:1e4,simplify:Mn,evaluate:Mn},{name:"Or",wikidata:"Q1651704",domain:"LogicOperator",threadable:!0,associative:!0,commutative:!0,idempotent:!0,complexity:1e4,simplify:Fn,evaluate:Fn},{name:"Not",wikidata:"Q190558",domain:"LogicOperator",involution:!0,complexity:10100,simplify:On,evaluate:On},{name:"Equivalent",wikidata:"Q220433",domain:"LogicOperator",complexity:10200,simplify:qn,evaluate:qn},{name:"Implies",wikidata:"Q7881229",domain:"LogicOperator",complexity:10200,simplify:Pn,evaluate:Pn},{name:"Exists",domain:"MaybeBoolean"}]};function Mn(t,e){if(e.length===0)return t.symbol("True");const i=[];for(const n of e){if(n.symbol==="False")return t.symbol("False");if(n.symbol!=="True"){let r=!1;for(const s of i)if(s.isSame(n))r=!0;else if(n.head==="Not"&&n.op1.isSame(s)||s.head==="Not"&&s.op1.isSame(n))return t.symbol("False");r||i.push(n)}}return i.length===0?t.symbol("True"):i.length===1?i[0]:t._fn("And",i)}function Fn(t,e){if(e.length===0)return t.symbol("True");const i=[];for(const n of e){if(n.symbol==="True")return t.symbol("True");if(n.symbol!=="False"){let r=!1;for(const s of i)if(s.isSame(n))r=!0;else if(n.head==="Not"&&n.op1.isSame(s)||s.head==="Not"&&s.op1.isSame(n))return t.symbol("True");r||i.push(n)}}return i.length===0?t.symbol("True"):i.length===1?i[0]:t._fn("Or",i)}function On(t,e){const i=e[0].symbol;return i==="True"?t.symbol("False"):i==="False"?t.symbol("True"):i==="Maybe"?t.symbol("Maybe"):void 0}function qn(t,e){const i=e[0].symbol,n=e[1].symbol;return i==="True"&&n==="True"||i==="False"&&n==="False"?t.symbol("True"):i==="True"&&n==="False"||i==="False"&&n==="True"?t.symbol("False"):i==="Maybe"||n==="Maybe"?t.symbol("Maybe"):void 0}function Pn(t,e){const i=e[0].symbol,n=e[1].symbol;return i==="True"&&n==="True"||i==="False"&&n==="False"||i==="False"&&n==="True"?t.symbol("True"):i==="True"&&n==="False"?t.symbol("False"):i==="Maybe"||n==="Maybe"?t.symbol("Maybe"):void 0}const Ks=[{symbols:[{name:"Degrees",domain:"RealNumber",constant:!0,value:["Divide","Pi",180]},{name:"Pi",domain:"TranscendentalNumber",algebraic:!1,constant:!0,hold:!0,wikidata:"Q167",value:t=>pe(t)?t.DECIMAL_PI:Math.PI}],functions:[{name:"Hypot",evaluate:["Sqrt",["Square","_1"],["Square","_2"]],domain:["Function","Number","Number","Number"]},{name:"Sin",domain:["Function","Number","Number"],complexity:5e3,simplify:(t,e)=>{var i;return(i=ne(t,"Sin",e[0]))!=null?i:Ze(t)?t.box(["Divide",["Subtract",["Exp",["Multiply","ImaginaryUnit",e[0]]],["Exp",["Multiply","ImaginaryUnit",["Negate",e[0]]]]],["Complex",0,2]]).canonical:void 0},evaluate:(t,e)=>{var i;return(i=ne(t,"Sin",e[0]))!=null?i:Ze(t)?t.box(["Divide",["Subtract",["Exp",["Multiply","ImaginaryUnit",e[0]]],["Exp",["Multiply","ImaginaryUnit",["Negate",e[0]]]]],["Complex",0,2]]).canonical:void 0},N:(t,e)=>e[0].decimalValue?t.number(t.chop(e[0].decimalValue.sin())):e[0].complexValue?t.number(e[0].complexValue.sin()):e[0].asFloat!==null?t.number(Math.sin(e[0].asFloat)):void 0}]},{functions:[{name:"Arctan",wikidata:"Q2257242",domain:["Function","Number","ExtendedRealNumber"],complexity:5200,simplify:(t,e)=>ne(t,"Arctan",e[0]),N:(t,e)=>e[0].decimalValue?t.number(e[0].decimalValue.atan()):e[0].complexValue?t.number(e[0].complexValue.atan()):e[0].asFloat!==null?t.number(Math.atan(e[0].asFloat)):void 0},{name:"Arctan2",wikidata:"Q776598",domain:["Function","Number","Number","Number"],complexity:5200,N:(t,e)=>e[0].decimalValue&&e[1].decimalValue?t.number(Q.exports.Decimal.atan2(e[0].decimalValue,e[1].decimalValue)):e[0].asFloat!==null&&e[1].asFloat!==null?t.number(Math.atan2(e[0].asFloat,e[1].asFloat)):void 0},{name:"Cos",domain:["Function","Number","Number"],complexity:5050,simplify:(t,e)=>{var i;return(i=ne(t,"Cos",e[0]))!=null?i:t.box(["Sin",["Add",e[0],["Multiply","Half","Pi"]]]).canonical},evaluate:["Sin",["Add","_1",["Multiply","Half","Pi"]]],N:(t,e)=>e[0].decimalValue?t.number(e[0].decimalValue.cos()):e[0].complexValue?t.number(e[0].complexValue.cos()):e[0].asFloat!==null?t.number(Math.cos(e[0].asFloat)):void 0},{name:"Tan",domain:["Function","Number","Number"],complexity:5100,simplify:(t,e)=>{var i;return(i=ne(t,"Tan",e[0]))!=null?i:t.box(["Divide",["Sin",e[0]],["Cos",e[0]]]).canonical},evaluate:["Divide",["Sin","_1"],["Cos","_1"]],N:(t,e)=>e[0].decimalValue?t.number(e[0].decimalValue.tan()):e[0].complexValue?t.number(e[0].complexValue.tan()):e[0].asFloat!==null?t.number(Math.tan(e[0].asFloat)):void 0}]},{functions:[{name:"Arcosh",domain:["Function","Number","Number"],complexity:6200,simplify:(t,e)=>{var i;return(i=ne(t,"Arcoshh",e[0]))!=null?i:t.box(["Ln",["Add",e[0],["Sqrt",["Subtract",["Square",e[0]],1]]]]).canonical},evaluate:["Ln",["Add","_1",["Sqrt",["Subtract",["Square","_1"],1]]]],N:(t,e)=>e[0].decimalValue?t.number(e[0].decimalValue.acosh()):e[0].complexValue?t.number(e[0].complexValue.acosh()):e[0].asFloat!==null?t.number(Math.acosh(e[0].asFloat)):void 0},{name:"Arcsin",domain:["Function","Number","Number"],complexity:5500,simplify:(t,e)=>{var i;return(i=ne(t,"Arcsin",e[0]))!=null?i:t.box(["Multiply",2,["Arctan2",e[0],["Add",1,["Sqrt",["Subtract",1,["Square",e[0]]]]]]]).canonical},evaluate:["Multiply",2,["Arctan2","_1",["Add",1,["Sqrt",["Subtract",1,["Square","_1"]]]]]],N:(t,e)=>e[0].decimalValue?t.number(e[0].decimalValue.asin()):e[0].complexValue?t.number(e[0].complexValue.asin()):e[0].asFloat!==null?t.number(Math.asin(e[0].asFloat)):void 0},{name:"Arsinh",domain:["Function","Number","Number"],complexity:6100,simplify:(t,e)=>{var i;return(i=ne(t,"Arsinh",e[0]))!=null?i:t.box(["Ln",["Add",e[0],["Sqrt",["Add",["Square",e[0]],1]]]]).canonical},evaluate:["Ln",["Add","_1",["Sqrt",["Add",["Square","_1"],1]]]],N:(t,e)=>e[0].decimalValue?t.number(e[0].decimalValue.asinh()):e[0].complexValue?t.number(e[0].complexValue.asinh()):e[0].asFloat!==null?t.number(Math.asinh(e[0].asFloat)):void 0},{name:"Artanh",domain:["Function","Number","Number"],complexity:6300,simplify:(t,e)=>{var i;return(i=ne(t,"Artanh",e[0]))!=null?i:t.box(["Multiply","Half",["Ln",["Divide",["Add",1,e[0]],["Subtract",1,e[0]]]]]).canonical},evaluate:["Multiply","Half",["Ln",["Divide",["Add",1,"_1"],["Subtract",1,"_1"]]]],N:(t,e)=>e[0].decimalValue?t.number(e[0].decimalValue.atanh()):e[0].complexValue?t.number(e[0].complexValue.atanh()):e[0].asFloat!==null?t.number(Math.atanh(e[0].asFloat)):void 0},{name:"Cosh",domain:["Function","Number","Number"],complexity:6050,simplify:(t,e)=>ne(t,"Cosh",e[0]),evaluate:["Multiply","Half",["Add",["Exp","_1"],["Exp",["Negate","_1"]]]],N:(t,e)=>e[0].decimalValue?t.number(e[0].decimalValue.cosh()):e[0].complexValue?t.number(e[0].complexValue.cosh()):e[0].asFloat!==null?t.number(Math.cosh(e[0].asFloat)):void 0},{name:"Cot",domain:["Function","Number","Number"],complexity:5600,simplify:(t,e)=>{var i;return(i=ne(t,"Cot",e[0]))!=null?i:t.box(["Divide",["Cos",e[0]],["Sin",e[0]]]).canonical},evaluate:["Divide",["Cos","_1"],["Sin","_1"]],N:(t,e)=>e[0].decimalValue?t.number(t.DECIMAL_ONE.div(e[0].decimalValue.tan())):e[0].complexValue?t.number(e[0].complexValue.tan().inverse()):e[0].asFloat!==null?t.number(1/Math.tan(e[0].asFloat)):void 0},{name:"Csc",description:"Cosecant",domain:["Function","Number","Number"],complexity:5600,simplify:(t,e)=>{var i;return(i=ne(t,"Csc",e[0]))!=null?i:t.box(["Divide",1,["Sin",e[0]]]).canonical},evaluate:["Divide",1,["Sin","_1"]],N:(t,e)=>e[0].decimalValue?t.number(t.DECIMAL_ONE.div(e[0].decimalValue.sin())):e[0].complexValue?t.number(e[0].complexValue.sin().inverse()):e[0].asFloat!==null?t.number(1/Math.sin(e[0].asFloat)):void 0},{name:"Haversine",wikidata:"Q2528380",domain:["Function","ExtendedRealNumber","RealNumber"],evaluate:["Divide",["Subtract",1,["Cos","_1"]],2]},{name:"InverseHaversine",domain:["Function","ExtendedRealNumber","RealNumber"],evaluate:["Multiply",2,["Arcsin",["Sqrt","_1"]]]},{name:"Sec",description:"Secant, inverse of cosine",domain:["Function","Number","Number"],complexity:5500,simplify:(t,e)=>{var i;return(i=ne(t,"Sec",e[0]))!=null?i:t.box(["Divide",1,["Cos",e[0]]]).canonical},evaluate:["Divide",1,["Cos","_1"]],N:(t,e)=>e[0].decimalValue?t.number(t.DECIMAL_ONE.div(e[0].decimalValue.cos())):e[0].complexValue?t.number(e[0].complexValue.cos().inverse()):e[0].asFloat!==null?t.number(1/Math.cos(e[0].asFloat)):void 0},{name:"Sinh",domain:["Function","Number","Number"],complexity:6e3,simplify:(t,e)=>{var i;return(i=ne(t,"Sinh",e[0]))!=null?i:t.box(["Multiply","Half",["Subtract",["Exp",e[0]],["Exp",["Negate",e[0]]]]]).canonical},evaluate:["Multiply","Half",["Subtract",["Exp","_1"],["Exp",["Negate","_1"]]]]}]},{functions:[{name:"Csch",domain:["Function","Number","ExtendedRealNumber"],complexity:6200,simplify:(t,e)=>{var i;return(i=ne(t,"Csch",e[0]))!=null?i:t.box(["Divide",1,["Sinh",e[0]]]).canonical},evaluate:["Divide",1,["Sinh","_1"]],N:(t,e)=>e[0].decimalValue?t.number(t.DECIMAL_ONE.div(e[0].decimalValue.sinh())):e[0].complexValue?t.number(e[0].complexValue.sinh().inverse()):e[0].asFloat!==null?t.number(1/Math.sinh(e[0].asFloat)):void 0},{name:"Sech",domain:["Function","Number","Number"],complexity:6200,simplify:(t,e)=>{var i;return(i=ne(t,"Sech",e[0]))!=null?i:t.box(["Divide",1,["Cosh",e[0]]]).canonical},evaluate:["Divide",1,["Cosh","_1"]],N:(t,e)=>e[0].decimalValue?t.number(t.DECIMAL_ONE.div(e[0].decimalValue.cosh())):e[0].complexValue?t.number(e[0].complexValue.cosh().inverse()):e[0].asFloat!==null?t.number(1/Math.cosh(e[0].asFloat)):void 0},{name:"Tanh",domain:["Function","Number","Number"],complexity:6200,simplify:(t,e)=>{var i;return(i=ne(t,"Tanh",e[0]))!=null?i:t.box(["Divide",["Sinh",e[0]],["Cosh",e[0]]]).canonical},evaluate:["Divide",["Sinh","_1"],["Cosh","_1"]],N:(t,e)=>e[0].decimalValue?t.number(e[0].decimalValue.tanh()):e[0].complexValue?t.number(e[0].complexValue.tanh()):e[0].asFloat!==null?t.number(Math.tanh(e[0].asFloat)):void 0}]},{functions:[{name:"Arccos",domain:["Function","Number","ExtendedRealNumber"],complexity:5550,evaluate:["Subtract",["Divide","Pi",2],["Arcsin","_1"]],simplify:(t,e)=>{var i;return(i=ne(t,"Arccos",e[0]))!=null?i:t.box(["Subtract",["Divide","Pi",2],["Arcsin",e[0]]]).canonical},N:(t,e)=>e[0].decimalValue?t.number(e[0].decimalValue.acos()):e[0].complexValue?t.number(e[0].complexValue.acos()):e[0].asFloat!==null?t.number(Math.acos(e[0].asFloat)):void 0},{name:"Coth",domain:["Function","Number","Number"],complexity:6300,simplify:(t,e)=>{var i;return(i=ne(t,"Coth",e[0]))!=null?i:t.box(["Divide",1,["Tanh",e[0]]]).canonical},evaluate:["Divide",1,["Tanh","_1"]],N:(t,e)=>e[0].decimalValue?t.number(t.DECIMAL_ONE.div(e[0].decimalValue.tanh())):e[0].complexValue?t.number(e[0].complexValue.tanh().inverse()):e[0].asFloat!==null?t.number(1/Math.tanh(e[0].asFloat)):void 0},{name:"InverseFunction",domain:"Function",simplify:(t,e)=>Vn(t,e[0]),evaluate:(t,e)=>Vn(t,e[0])}]}],Te=["Sqrt",2],Ke=["Sqrt",3],Ye=["Sqrt",5],zi=["Sqrt",6],Ys=[[[0,1],{Sin:0,Cos:1,Tan:0,Cot:NaN,Sec:1,Csc:NaN}],[[1,12],{Sin:["Divide",["Subtract",zi,Te],4],Cos:["Divide",["Add",zi,Te],4],Tan:["Subtract",2,Ke],Cot:["Add",2,Ke],Sec:["Subtract",zi,Te],Csc:["Add",zi,Te]}],[[1,10],{Sin:["Divide",["Subtract",Ye,1],4],Cos:["Divide",["Sqrt",["Add",10,["Multiply",2,Ye]]],4],Tan:["Divide",["Sqrt",["Subtract",25,["Multiply",10,Ye]]],4],Cot:["Sqrt",["Add",5,["Multiply",2,Ye]]],Sec:["Divide",["Sqrt",["Subtract",50,["Multiply",10,Ye]]],5],Csc:["Add",1,Ye]}],[[1,8],{Sin:"$\\frac\\sqrt{2-\\sqrt2}{2}$",Cos:"$\\frac {\\sqrt {2+{\\sqrt {2}}}}{2}$",Tan:"$\\sqrt{2} - 1$",Cot:"$\\sqrt{2} + 1$",Sec:"$\\sqrt{ 4 - 2\\sqrt{2}$",Csc:"$\\sqrt{ 4 + 2\\sqrt{2}$"}],[[1,6],{Sin:"$\\frac{1}{2}$",Cos:"$\\frac{\\sqrt{3}}{2}$",Tan:"$\\frac{\\sqrt{3}}{3}$",Cot:"$\\frac{2\\sqrt{3}}{3}$",Sec:"$\\sqrt{3}$",Csc:2}],[[1,5],{Sin:"$\\frac{\\sqrt{10- 2\\sqrt{5}}} {4}$",Cos:"$\\frac{1+ \\sqrt{5}} {4}$",Tan:"$\\sqrt{5-2\\sqrt5}$",Cot:"$\\frac{\\sqrt{25+10\\sqrt5}} {5}$",Sec:"$\\sqrt{5} - 1$",Csc:"$\\frac{\\sqrt{50+10\\sqrt{5}}} {5}$"}],[[1,4],{Sin:["Divide",Te,2],Cos:["Divide",Te,2],Tan:1,Cot:1,Sec:Te,Csc:Te}],[[3,10],{Sin:"$\\frac{1+ \\sqrt{5}} {4}$",Cos:"$\\frac{\\sqrt{10- 2\\sqrt{5}}} {4}$",Tan:"$\\frac{\\sqrt{25+10\\sqrt5}} {5}$",Cot:"$\\sqrt{5-2\\sqrt5}$",Sec:"$$",Csc:"$\\frac{\\sqrt{50+10\\sqrt{5}}} {5}$"}],[[1,3],{Sin:["Divide",Ke,2],Cos:"Half",Tan:Ke,Cot:["Divide",Ke,3],Sec:2,Csc:["Divide",["Multiply",2,Ke],3]}],[[3,8],{Sin:"$\\frac{ \\sqrt{2 + \\sqrt{2}} } {2}$",Cos:"$\\frac{ \\sqrt{2 - \\sqrt{2}} } {2}$",Tan:"$\\sqrt{2} + 1$",Cot:"$\\sqrt{2} - 1$",Sec:"$\\sqrt{ 4 + 2 \\sqrt{2} }$",Csc:"$\\sqrt{ 4 - 2 \\sqrt{2} }$"}],[[2,5],{Sin:"$\\frac{\\sqrt{10+ 2\\sqrt{5}}} {4}$",Cos:"$\\frac{\\sqrt{5}-1} {4}$",Tan:"$\\sqrt{5+2\\sqrt{5}}$",Cot:"$\\frac{\\sqrt{25-10\\sqrt{5}}} {5}$",Sec:"$1 + \\sqrt{5}$",Csc:"$\\frac{\\sqrt{50-10\\sqrt{5}}} {5}$"}],[[5,12],{Sin:"$\\frac{\\sqrt{6} + \\sqrt{2}} {4}$",Cos:"$\\frac{ \\sqrt{6} - \\sqrt{2}} {4}$",Tan:"$2+\\sqrt{3}$",Cot:"$2-\\sqrt{3}$",Sec:"$\\sqrt{6}+\\sqrt{2}$",Csc:"$\\sqrt{6} - \\sqrt{2}$"}],[[1,2],{Sin:1,Cos:0,Tan:NaN,Cot:0,Sec:NaN,Csc:1}]],Js={Sin:[[1,"Sin"],[1,"Cos"],[-1,"Sin"],[-1,"Cos"]],Cos:[[1,"Cos"],[-1,"Sin"],[-1,"Cos"],[1,"Sin"]],Sec:[[1,"Sec"],[-1,"Csc"],[-1,"Sec"],[1,"Csc"]],Csc:[[1,"Csc"],[1,"Sec"],[-1,"Csc"],[-1,"Sec"]],Tan:[[1,"Tan"],[-1,"Cot"],[1,"Tan"],[-1,"Cot"]],Cot:[[1,"Cot"],[-1,"Tan"],[1,"Cot"],[-1,"Tan"]]};function ne(t,e,i){var a;if(!i||i.isMissing)return;const n=t.cache("constructible-trigonometric-values",()=>{var h;const l=[];for(const[d,y]of Ys){const N={};for(const x of Object.keys(y))N[x]=((h=t.parse(xi(y[x])))!=null?h:t.box(y[x])).canonical;l.push([d,N])}return l},l=>{for(const[h,d]of l)for(const y of Object.values(d))y._purge();return l});if(!(i=(a=i.numericValue)!=null?a:i).isLiteral)return;let r=i.asFloat;if(r===null)return;r%=2*Math.PI;const s=e!=="Cos"&&e!=="Sec"?Math.sign(r):1;r=Math.abs(r);const u=Math.floor(2*r/Math.PI);let o;r%=Math.PI/2,[o,e]=Js[e][u],o*=s;for(const[[l,h],d]of n)if(t.chop(r-Math.PI*l/h)===0)return o<0?se(d[e]):d[e]}function Vn(t,e){const i=e.op1.head;if(typeof i!="string")return e;const n={Sin:"Arcsin",Cos:"Arccos",Tan:"Arctan",Sec:"Arcsec",Csc:" Arccsc",Sinh:"Arsinh",Cosh:"Arcosh",Tanh:"Artanh",Sech:"Arcsech",Csch:"Arcsch",Arcosh:"Cosh",Arcos:"Cos",Arccsc:"Csc",Arcsch:"Csch",Arcsec:"Sec",Arcsin:"Sin",Arsinh:"Sinh",Arctan:"Tan",Artanh:"Tanh"}[i];return n?t._fn(n,[e.op1.op1]):e}function Ut(t){return Object.fromEntries(Object.entries(t).filter(([e,i])=>i!==void 0))}function fr(t){const e=z({},t);return t.zero||t.one||t.negativeOne?(e.number=!0,e.integer=!0,e.rational=!0,e.algebraic=!0,e.real=!0,e.extendedReal=!0,e.complex=!0,e.extendedComplex=!0,e.imaginary=!1,e.positive=!1,e.nonPositive=!0,e.negative=!1,e.nonNegative=!0,e.zero=t.zero,e.notZero=!t.zero,e.one=t.one,e.negativeOne=t.negativeOne,e.negativeOne=!1,e.infinity=!1,e.NaN=!1,e.finite=!0,e.even=t.one,e.odd=!t.one,e.prime=!1,e.composite=!1,e):(e.notZero===!0&&(e.imaginary||(e.real=!0),e.zero=!1),(e.positive||e.nonNegative)&&(e.negativeOne=!1),e.positive?(e.nonPositive=!1,e.negative=!1,e.nonNegative=!0):e.nonPositive?(e.positive=!1,e.negative=e.notZero,e.nonNegative=!e.zero):e.negative?(e.positive=!1,e.nonPositive=e.notZero,e.nonNegative=!1):e.nonNegative&&(e.positive=e.notZero,e.nonPositive=!e.zero,e.negative=!1),(e.positive||e.negative||e.nonPositive||e.nonNegative)&&(e.number=!0,e.finite?e.real=!0:e.finite||(e.complex=!0),e.imaginary=!1),e.infinity&&(e.finite=!1,e.NaN=!1),e.finite&&(e.number=!0,e.complex=!0,e.infinity=!1,e.NaN=!1),t.even&&(e.odd=!1),t.odd&&(e.even=!1),e.integer&&(e.rational=!0),e.rational&&(e.algebraic=!0),e.algebraic&&(e.real=!0),e.extendedReal&&(e.real=!0),e.real&&(e.complex=!0),e.imaginary&&(e.complex=!0),e.extendedComplex&&(e.complex=!0),e.complex&&(e.number=!0),e.real&&e.infinity&&(e.extendedReal=!0),e.complex&&e.infinity&&(e.extendedComplex=!0),(e.even||e.infinity||e.NaN||e.negative||e.imaginary||e.integer===!1)&&(e.prime=!1),e.number&&e.prime&&(e.composite=!1),e)}function ri(t){if(!t)return{};const e=t.domainExpression,i={};return t.isSubdomainOf("Number")?(i.number=!0,e==="Integer"&&(i.integer=!0),e==="RationalNumber"&&(i.rational=!0),e==="AlgebraicNumber"&&(i.algebraic=!0),e==="TranscendentalNumber"&&(i.algebraic=!1,i.real=!0),e==="ExtendedRealNumber"&&(i.extendedReal=!0),e==="RealNumber"&&(i.real=!0),e==="ImaginaryNumber"&&(i.imaginary=!0),e==="ExtendedComplexNumber"&&(i.extendedComplex=!0),e==="ComplexNumber"&&(i.complex=!0)):(i.number=!1,i.integer=!1,i.rational=!1,i.algebraic=!1,i.real=!1,i.extendedReal=!1,i.complex=!1,i.extendedComplex=!1,i.imaginary=!1,i.positive=!1,i.nonPositive=!1,i.negative=!1,i.nonNegative=!1,i.zero=!1,i.notZero=!1,i.one=!1,i.negativeOne=!1,i.infinity=!1,i.NaN=!1,i.odd=!1,i.even=!1,i.prime=!1,i.composite=!1),Ut(fr(i))}function _t(t){return Ut({number:(t=t.canonical).isNumber,integer:t.isInteger,rational:t.isRational,algebraic:t.isAlgebraic,real:t.isReal,extendedReal:t.isExtendedReal,complex:t.isComplex,extendedComplex:t.isExtendedComplex,imaginary:t.isImaginary,positive:t.isPositive,nonPositive:t.isNonPositive,negative:t.isNegative,nonNegative:t.isNonNegative,zero:t.isZero,notZero:t.isNotZero,one:t.isOne,negativeOne:t.isNegativeOne,infinity:t.isInfinity,NaN:t.isNaN,finite:t.isFinite,even:t.isEven,odd:t.isOdd,prime:t.isPrime,composite:t.isComposite})}class gr{constructor(e,i){var n,r;this._engine=e,this._def=i,this.scope=e.context,this.name=i.name,this.constant=(n=i.constant)!=null?n:!1,this.hold=(r=i.hold)!=null?r:!0,this._purge()}_purge(){var o,a,l,h;this._value=(o=this._value)==null?void 0:o._purge();const e=this._def,i=this._engine,n=Ut({description:e.description,wikidata:e.wikidata,number:e.number,integer:e.integer,rational:e.rational,algebraic:e.algebraic,real:e.real,extendedReal:e.extendedReal,complex:e.complex,zero:e.zero,notZero:e.notZero,one:e.one,negativeOne:e.negativeOne,infinity:e.infinity,NaN:e.NaN,finite:e.finite,even:e.even,odd:e.odd,prime:e.prime,composite:e.composite});if("value"in e&&typeof e.value=="number"){const d=i.number(e.value);let y;const N=e.domain?i.domain(e.domain):void 0;return y=N&&d.valueDomain.isSubdomainOf(N)?N:d.valueDomain,this._value=d,this._domain=y,this.setProps(_t(d)),this.setProps(ri(y)),void this.setProps(n)}let r,s;if(Ht(e.value)?r=i.parse(e.value):typeof e.value=="function"?r=i.box((a=e.value(i))!=null?a:"Undefined"):e.value&&(r=i.box(e.value)),!r&&e.hold===!1)throw Error(`Symbol definition "${e.name}": Expected a value "hold=false" `);r=r==null?void 0:r.canonical;const u=e.domain?i.domain(e.domain):void 0;if(s=!u||r&&!r.valueDomain.isSubdomainOf(u)?(h=(l=r==null?void 0:r.valueDomain)!=null?l:i.defaultDomain)!=null?h:i.domain("Anything"):u,!r)return this._value=void 0,this._domain=s,this.setProps(ri(s)),void this.setProps(n);this._value=r,this._domain=s,this.setProps(_t(r)),this.setProps(ri(s)),this.setProps(n)}get value(){return this._value}set value(e){if(this.constant)throw Error(`The value of the constant "${this.name}" cannot be changed`);typeof e=="number"&&(e=this._engine.box(e)),this._value=e,e&&this.setProps(_t(e))}get domain(){return this._domain}set domain(e){var n;if(!e)return void(this._domain=void 0);e=this._engine.domain(e);const i=(n=this.value)==null?void 0:n.valueDomain;i&&!i.isSubdomainOf(e)&&(e=i),this._domain=e,this.setProps(ri(e))}updateFlags(e){this.setProps(fr(e))}setProps(e){e.wikidata&&(this.wikidata=e.wikidata),e.description&&(this.description=e.description),e.number!==void 0&&(this._number=e.number),e.integer!==void 0&&(this._integer=e.integer),e.rational!==void 0&&(this._rational=e.rational),e.algebraic!==void 0&&(this._algebraic=e.algebraic),e.real!==void 0&&(this._real=e.real),e.extendedReal!==void 0&&(this._extendedReal=e.extendedReal),e.complex!==void 0&&(this._complex=e.complex),e.extendedComplex!==void 0&&(this._extendedComplex=e.extendedComplex),e.imaginary!==void 0&&(this._imaginary=e.imaginary),e.positive!==void 0&&(this._positive=e.positive),e.nonPositive!==void 0&&(this._nonPositive=e.nonPositive),e.negative!==void 0&&(this._negative=e.negative),e.nonNegative!==void 0&&(this._nonNegative=e.nonNegative),e.zero!==void 0&&(this._zero=e.zero),e.notZero!==void 0&&(this._notZero=e.notZero),e.one!==void 0&&(this._one=e.one),e.negativeOne!==void 0&&(this._negativeOne=e.negativeOne),e.infinity!==void 0&&(this._infinity=e.infinity),e.finite!==void 0&&(this._finite=e.finite),e.NaN!==void 0&&(this._NaN=e.NaN),e.even!==void 0&&(this._even=e.even),e.odd!==void 0&&(this._odd=e.odd),e.prime!==void 0&&(this._prime=e.prime),e.composite!==void 0&&(this._composite=e.composite)}get number(){return this._number}set number(e){this.updateFlags({number:e})}get integer(){return this._integer}set integer(e){this.updateFlags({integer:e})}get rational(){return this._rational}set rational(e){this.updateFlags({rational:e})}get algebraic(){return this._algebraic}set algebraic(e){this.updateFlags({algebraic:e})}get real(){return this._real}set real(e){this.updateFlags({real:e})}get extendedReal(){return this._extendedReal}set extendedReal(e){this.updateFlags({extendedReal:e})}get complex(){return this._complex}set complex(e){this.updateFlags({complex:e})}get extendedComplex(){return this._extendedComplex}set extendedComplex(e){this.updateFlags({extendedComplex:e})}get imaginary(){return this._imaginary}set imaginary(e){this.updateFlags({imaginary:e})}get positive(){return this._positive}set positive(e){this.updateFlags({positive:e})}get nonPositive(){return this._nonPositive}set nonPositive(e){this.updateFlags({nonPositive:e})}get negative(){return this._negative}set negative(e){this.updateFlags({negative:e})}get nonNegative(){return this._nonNegative}set nonNegative(e){this.updateFlags({nonNegative:e})}get zero(){return this._zero}set zero(e){this.updateFlags({zero:e})}get notZero(){return this._notZero}set notZero(e){this.updateFlags({notZero:e})}get one(){return this._one}set one(e){this.updateFlags({one:e})}get negativeOne(){return this._negativeOne}set negativeOne(e){this.updateFlags({negativeOne:e})}get infinity(){return this._infinity}set infinity(e){this.updateFlags({infinity:e})}get finite(){return this._finite}set finite(e){this.updateFlags({finite:e})}get NaN(){return this._NaN}set NaN(e){this.updateFlags({NaN:e})}get even(){return this._even}set even(e){this.updateFlags({even:e})}get odd(){return this._odd}set odd(e){this.updateFlags({odd:e})}get prime(){var e;if(this._prime===void 0&&((e=this._value)==null?void 0:e.isNumber))if(!this._value.isInteger||this._value.isNonPositive)this._prime=!1,this._composite=!1;else{const i=this._value.asFloat;i!==null?(this._prime=Lt(i),this._composite=!this._prime):(this._prime=void 0,this._composite=void 0)}return this._prime}set prime(e){this.updateFlags({prime:e})}get composite(){if(this._composite===void 0){const e=this.prime;this._composite=e===void 0?void 0:!e}return this._composite}set composite(e){this.updateFlags({composite:e})}}class Xs{constructor(e,i){var o,a,l,h,d,y,N,x,k,M;const n=i.domain?typeof i.domain=="function"?i.domain:e.domain(i.domain):e.domain("Function"),r=(o=i.hold)!=null?o:"none",s=(a=i.idempotent)!=null?a:!1,u=(l=i.involution)!=null?l:!1;if(s&&u)throw Error(`Function Definition "${i.name}": the 'idempotent' and 'involution' flags are mutually exclusive in function `);this.name=i.name,this.description=i.description,this.wikidata=i.wikidata,this.scope=e.context,this.threadable=(h=i.threadable)!=null?h:!1,this.associative=(d=i.associative)!=null?d:!1,this.commutative=(y=i.commutative)!=null?y:!1,this.idempotent=s,this.involution=u,this.inert=(N=i.inert)!=null?N:!1,this.pure=(x=i.pure)!=null?x:!0,this.complexity=(k=i.complexity)!=null?k:1e5,this.hold=r,this.sequenceHold=(M=i.sequenceHold)!=null?M:!1,this.range=i.range,this.domain=n,this.canonical=i.canonical,this.simplify=i.simplify,this.evaluate=i.evaluate?typeof i.evaluate=="function"?i.evaluate:e.box(i.evaluate).canonical:void 0,this.N=i.N,this.evalDimension=i.evalDimension,this.sgn=i.sgn,this.compile=i.compile}_purge(){}}function ea(t,e){return new Xs(t,e)}function Oe(t,e){const i=t.engine;return t.head==="Negate"&&e.head==="Negate"?Oe(t.op1,e.op1):t.head==="Negate"?se(Oe(t.op1,e)):e.head==="Negate"?se(Oe(t,e.op1)):t.head==="Add"?i.add(t.ops.map(n=>Oe(n,e))):e.head==="Add"?i.add(e.ops.map(n=>Oe(t,n))):i.mul([t,e])}function et(t,e){if(e===1)return t;const i=Oe(t,t);return e===2?i:e%2==0?et(i,e/2):Oe(et(i,Math.round(e/2)-1),t)}function pr(t="all"){if(t==="all")return pr(["domains","core","collections","algebra","arithmetic","calculus","combinatorics","dimensions","linear-algebra","logic","numeric","other","physics","polynomials","relop","statistics","trigonometry","units"]);const e=[];for(const i of t){const n=ia[i];n&&Array.isArray(n)?e.push(...n):n&&e.push(n)}return e}const ia={arithmetic:Ws,core:Us,collections:[{symbols:[{name:"EmptySet",domain:"Set",constant:!0,wikidata:"Q226183"}],functions:[{name:"Element",domain:"Predicate",complexity:11200},{name:"NotElement",domain:"Predicate",complexity:11200,canonical:(t,e)=>t.fn("Not",[t.fn("Element",e)])},{name:"Subset",domain:"Predicate",complexity:11200},{name:"NotSubset",domain:"Predicate",complexity:11200,canonical:(t,e)=>t.fn("Not",[t.fn("Subset",e)])},{name:"Superset",domain:"Predicate",complexity:11200},{name:"SupersetEqual",domain:"Predicate",complexity:11200},{name:"NotSuperset",domain:"Predicate",complexity:11200,canonical:(t,e)=>t.fn("Not",[t.fn("Superset",e)])},{name:"NotSupersetEqual",domain:"Predicate",complexity:11200,canonical:(t,e)=>t.fn("Not",[t.fn("SupersetEqual",e)])},{name:"SubsetEqual",domain:"Predicate",complexity:11200},{name:"NotSubsetNotEqual",domain:"Predicate",complexity:11200,canonical:(t,e)=>t.fn("Not",[t.fn("SubsetEqual",e)])},{name:"CartesianProduct",domain:["Function",["Some","Set"],"Set"],wikidata:"Q173740"},{name:"Complement",domain:["Function","Set","Set"],wikidata:"Q242767"},{name:"Intersection",domain:["Function",["Some","Set"],"Set"],wikidata:"Q185837",threadable:!0,associative:!0,commutative:!0,involution:!0,evaluate:function(t,e){return t.symbol("EmptySet")}},{name:"Union",domain:["Function",["Some","Set"],"Set"],wikidata:"Q185359",threadable:!0,associative:!0,commutative:!0,involution:!0,evaluate:function(t,e){return t.symbol("False")}},{name:"Set",domain:["Function",["Some","Anything"],"Set"]},{name:"SetMinus",domain:["Function","Set","Expresison","Set"],wikidata:"Q18192442",evaluate:function(t,e){return t.symbol("EmptySet")}},{name:"SymmetricDifference",domain:["Function",["Some","Set"],"Set"],wikidata:"Q1147242"}]},{functions:[{name:"Sequence"}]}],logic:Qs,relop:{functions:[{name:"Equal",domain:"RelationalOperator",commutative:!0,complexity:11e3,evaluate:(t,e)=>{if(e.length<2)return t.symbol("True");let i;for(const n of e)if(i){if(i.isEqual(n)===!1)return t.symbol("False")}else i=n;return t.symbol("True")}},{name:"NotEqual",wikidata:"Q28113351",commutative:!0,complexity:11e3,domain:"RelationalOperator",evaluate:(t,e)=>{if(e.length<2)return t.symbol("False");let i;for(const n of e)if(i){if(i.isEqual(n)===!0)return t.symbol("False")}else i=n;return t.symbol("True")}},{name:"Less",complexity:11e3,domain:"RelationalOperator",evaluate:(t,e)=>{if(e.length<2)return t.symbol("True");let i;for(const n of e){if(!n.isNumber)return;if(i){const r=t.fn("Subtract",[n,i]).N().sgn;if(r==null)return;if(r<=0)return t.symbol("False");i=n}else i=n}return t.symbol("True")}},{name:"NotLess",complexity:11e3,domain:"RelationalOperator",canonical:(t,e)=>t._fn("Not",[t._fn("Less",e)])},{name:"Greater",complexity:11e3,domain:"RelationalOperator",canonical:(t,e)=>t._fn("Less",e.reverse()),evaluate:(t,e)=>{if(e.length<2)return t.symbol("True");let i;for(const n of e){if(!n.isNumber)return;if(i){const r=t.fn("Subtract",[n,i]).N().sgn;if(r==null)return;if(r>=0)return t.symbol("False");i=n}else i=n}return t.symbol("True")}},{name:"NotGreater",complexity:11e3,domain:"RelationalOperator",canonical:(t,e)=>t._fn("Not",[t._fn("Greater",e)])},{name:"LessEqual",complexity:11e3,domain:"RelationalOperator",evaluate:(t,e)=>{if(e.length<2)return t.symbol("True");let i;for(const n of e){if(!n.isNumber)return;if(i){const r=t.fn("Subtract",[n,i]).N().sgn;if(r==null)return;if(r<0)return t.symbol("False");i=n}else i=n}return t.symbol("True")}},{name:"NotLessNotEqual",complexity:11e3,domain:"RelationalOperator",canonical:(t,e)=>t._fn("Not",[t._fn("LessEqual",e)])},{name:"GreaterEqual",complexity:11e3,domain:"RelationalOperator",canonical:(t,e)=>t._fn("LessEqual",e.reverse()),evaluate:(t,e)=>{if(e.length<2)return t.symbol("True");let i;for(const n of e){if(!n.isNumber)return;if(i){const r=t.fn("Subtract",[n,i]).N().sgn;if(r==null)return;if(r>0)return t.symbol("False");i=n}else i=n}return t.symbol("True")}},{name:"NotGreaterNotEqual",complexity:11e3,domain:"RelationalOperator",canonical:(t,e)=>t._fn("Not",[t._fn("GreaterEqual",e)])},{name:"TildeFullEqual",description:"Indicate isomorphism, congruence and homotopic equivalence",domain:"RelationalOperator"},{name:"NotTildeFullEqual",complexity:11100,domain:"RelationalOperator",canonical:(t,e)=>t._fn("Not",[t._fn("TildeFullEqual",e)])},{name:"TildeEqual",description:"Approximately or asymptotically equal",domain:"RelationalOperator",complexity:11e3},{name:"NotTildeEqual",complexity:11100,domain:"RelationalOperator",canonical:(t,e)=>t._fn("Not",[t._fn("TildeEqual",e)])},{name:"Approx",complexity:11100,domain:"RelationalOperator"},{name:"NotApprox",complexity:11100,domain:"RelationalOperator",canonical:(t,e)=>t._fn("Not",[t._fn("Approx",e)])},{name:"ApproxEqual",complexity:11100,domain:"RelationalOperator"},{name:"NotApproxEqual",complexity:11100,domain:"RelationalOperator",canonical:(t,e)=>t._fn("Not",[t._fn("ApproxEqual",e)])},{name:"ApproxNotEqual",domain:"RelationalOperator",complexity:11100},{name:"NotApproxNotEqual",complexity:11100,domain:"RelationalOperator",canonical:(t,e)=>t._fn("Not",[t._fn("ApproxNotEqual",e)])},{name:"Precedes",complexity:11100,domain:"RelationalOperator"},{name:"NotPrecedes",complexity:11100,domain:"RelationalOperator",canonical:(t,e)=>t._fn("Not",[t._fn("Precedes",e)])},{name:"Succeeds",domain:"RelationalOperator"},{name:"NotSucceeds",complexity:11100,domain:"RelationalOperator",canonical:(t,e)=>t._fn("Not",[t._fn("Succeeds",e)])}]},polynomials:[{functions:[{name:"Expand",description:"Expand out products and positive integer powers",evaluate:(t,e)=>e[0]?function(i){if((i=i.simplify()).head==="Multiply")return i.nops===2?Oe(i.op1,i.op2):i.ops.reduce((n,r)=>Oe(n,r),i.engine.ONE);if(i.head==="Power"){const n=i.op1.head;if(n==="Multiply")return i.engine.mul(i.op1.ops.map(r=>i.engine.power(r,i.op2)));if(n==="Negate"){const r=i.op2.asSmallInteger;if(r!==null&&r>0)return r%2==0?i.engine.power(i.op1.op1,i.op2):i.engine.negate(i.engine.power(i.op1.op1,i.op2))}if(n==="Add"){const r=i.op2.asSmallInteger;if(r!==null)return r>0?et(i.op1,r):i.engine.inverse(et(i.op1,-r))}}return i}(e[0]):t.symbol("Nothing")}]}],physics:{symbols:[{name:"Mu-0",description:"Vaccum permeability",constant:!0,wikidata:"Q1515261",domain:"RealNumber",value:125663706212e-17}]},trigonometry:Ks};function Cn(t,e){if(typeof e!="object"||!("name"in e)||!e.name)throw Error("Missing name for definition "+JSON.stringify(e));if(!/[A-Za-z][A-Za-z0-9-]*/.test(e.name)&&e.name.length!==1)throw Error("Invalid definition name "+e.name)}function dr(t,e){if(e===void 0)return;if(Array.isArray(e)){for(const n of e)dr(t,n);return}t.context.dictionary||(t.context.dictionary={symbols:new Map,functions:new Map,symbolWikidata:new Map,functionWikidata:new Map});const i=t.context.dictionary;if(e.symbols)for(const n of e.symbols){Cn(0,n);const r=new gr(t,n);if(n.wikidata){if(i.symbolWikidata.has(n.wikidata))throw Error(`Duplicate symbol with wikidata ${n.wikidata}, ${n.name} and ${i.symbolWikidata.get(n.wikidata).name}`);i.symbolWikidata.set(n.wikidata,r)}if(i.symbols.has(n.name))throw Error(`Duplicate symbol definition ${n.name}:
${JSON.stringify(i.symbols.get(n.name))}
${JSON.stringify(n)}`);i.symbols.set(n.name,r)}if(e.functions)for(const n of e.functions){Cn(0,n);const r=ea(t,n);if(i.functions.has(n.name)?i.functions.set(n.name,[...i.functions.get(n.name),r]):i.functions.set(n.name,[r]),n.wikidata){if(i.functionWikidata.has(n.wikidata))throw Error(`Duplicate function with wikidata ${n.wikidata}, ${n.name} and ${i.functionWikidata.get(n.wikidata).name}`);i.functionWikidata.set(n.wikidata,r)}}}function pi(t){return Number.isInteger(t)?Math.floor(Math.log2(Math.abs(t))/Math.log2(10))+(t>0?1:2):2}const Dn=function t(e){var n,r;if(e.symbol)return 1;if(e.isLiteral){if(e.isZero)return 1;if(e.isInteger&&e.asFloat!==null)return pi(e.asFloat);const[s,u]=e.rationalValue;if(s!==null&&u!==null)return pi(s)+pi(u)+1;if(e.complexValue){const o=e.complexValue;return pi(o.re)+pi(o.im)+1}if(e.isNumber)return 2}const i=e.head;return(typeof i=="string"?1:t(i))+((r=(n=e.ops)==null?void 0:n.reduce((s,u)=>s+t(u),0))!=null?r:0)};class _i{constructor(e){this._items=e?e instanceof _i?new Map(e._items):new Map(e):new Map}has(e){for(const i of this._items.keys())if(i.isSame(e))return!0;return!1}get(e){for(const[i,n]of this._items)if(i.isSame(e))return n}clear(){this._items.clear()}set(e,i){for(const n of this._items.keys())if(n.isSame(e))return void this._items.set(n,i);this._items.set(e,i)}delete(e){this._items.delete(e)}[Symbol.iterator](){return this._items.entries()}entries(){return this._items.entries()}}class Si extends ye{constructor(e,i,n){super(e,n),this._pattern=Ht(i)?e.parse(i):e.box(i),this._pattern.isCanonical&&(this._canonicalPattern=this._pattern)}get hash(){return be("Pattern")^this._pattern.hash}_purge(){var e;this._pattern._purge(),(e=this._canonicalPattern)==null||e._purge()}get json(){return G(this.engine,"Pattern",[this._pattern])}get head(){return"Pattern"}get valueDomain(){return this.engine.domain("Pattern")}get isCanonical(){return!0}set isCanonical(e){}isSame(e){return this===e||e instanceof Si&&this._pattern.isSame(e._pattern)}isEqual(e){return e instanceof Si&&this._pattern.isEqual(e._pattern)}match(e,i){var r,s;let n=this._pattern;return i!=null&&i.exact||(this._canonicalPattern||(this._canonicalPattern=this._pattern.canonical),n=this._canonicalPattern),function(u,o,a){var l;return Je(u,o,{},{numericTolerance:(l=a==null?void 0:a.numericTolerance)!=null?l:1e-10})||null}(e,n,{recursive:(r=i==null?void 0:i.recursive)!=null?r:!1,numericTolerance:(s=i==null?void 0:i.numericTolerance)!=null?s:0})}test(e,i){return this.match(e,i)!==null}count(e,i){let n=0;for(const r of e)this.match(r,i)!==null&&(n+=1);return n}subs(e){return new Si(this.engine,this._pattern.subs(e).canonical)}}function $i(t,e,i){const n=function(r){const s=r.match(/^__?_?([a-zA-Z0-9]+)/);return s===null?"":s[1]}(t);return n===""?i:i[n]?e.isSame(i[n])?i:null:(i[n]=e,i)}function Je(t,e,i,n){const r=t.engine;if(e instanceof J)return t instanceof J?n.numericTolerance===0?e.isSame(t)?i:null:e.isEqualWithTolerance(t,n.numericTolerance)?i:null:null;const s=e.string;if(s!==null)return t.string===s?i:null;const u=e.symbol;if(u!==null)return u.startsWith("_")?$i(u,t,i):u===t.symbol?i:null;if(e.nops!==t.nops)return null;const o=e.keys;if(o!==null){const a=t.keys;if(a===null)return null;for(const l of o){const h=Je(a[l],o[l],i,n);if(h===null)return null;i=h}return i}if(e.ops){const a=e.head;if(typeof a=="string"&&a.startsWith("_"))return $i(a,r.box(t.head),i);{const N=Je(r.box(t.head),r.pattern(a),i,n);if(N===null)return null;i=N}const l=t.ops;let h=z({},i),d=0;const y=e.ops.map(N=>r.pattern(N));for(;d<e.nops;){const N=y[d],x=N.symbol;if(x!==null)if(x.startsWith("__")){let k=0;if(y[d+1]===void 0)k=l.length+1;else{let M=!1;for(;!M&&k<l.length;)M=Je(l[k],y[d+1],i,n)!==null,k+=1;if(!M)return null}if(!x.startsWith("___")&&k<=1)return null;h=$i(x,r.fn("Sequence",l.splice(0,k-1)),h)}else if(x.startsWith("_"))h=$i(x,l.shift(),h);else{const k=Je(l.shift(),N,i,n);if(k===null)return null;h=z(z({},h),k)}else{const k=Je(l.shift(),N,i,n);if(k===null)return null;h=z(z({},h),k)}if(h===null)return null;d+=1}return h}return null}class oi extends ye{constructor(e,i,n){if(super(e,n),this._name=i.normalize(),r=this._name,/[\u0000-\u0020\u0022\u0060\ufffe\uffff]/.test(r)||/^[\u0021\u0022\u0024-\u002e\u003a\u003f\u0040\u005b\u005d\u005e\u007b\u007d\u007e]$/.test(r[0]))throw Error(`The name "${this._name}" cannot be used as a symbol name`);var r;this._repairDefinition(),e._register(this)}get hash(){return this._hash===void 0&&(this._hash=be(this._name)),this._hash}_purge(){var e;return(e=this._def)==null?void 0:e._purge()}get isPure(){var e,i,n;return(n=((e=this._def)==null?void 0:e.constant)&&((i=this._def.value)==null?void 0:i.isPure))!=null?n:!1}get isCanonical(){return!0}set isCanonical(e){}get wikidata(){var e,i,n;return(n=(i=this._wikidata)!=null?i:(e=this._def)==null?void 0:e.wikidata)!=null?n:""}get description(){return this._def&&this._def.description?typeof this._def.description=="string"?[this._def.description]:this._def.description:[]}get url(){var e,i;return(i=(e=this._def)==null?void 0:e.url)!=null?i:""}get complexity(){return 7}get head(){return"Symbol"}get symbol(){return this._name}get isMissing(){return this._name==="Missing"}get isLiteral(){return!1}get symbolDefinition(){return this._def}_repairDefinition(){if(this._name[0]==="_")return;let e;this._wikidata&&(e=this.engine.getSymbolDefinition("",this._wikidata)),e||(e=this.engine.getSymbolDefinition(this._name),e&&e.wikidata&&this._wikidata&&e.wikidata!==this._wikidata&&(e=void 0)),e?(this._name=e.name,this._def=e):this.engine.defaultDomain!==null?(this._def=this.engine.defineSymbol(z({name:this._name,wikidata:this._wikidata,domain:this.engine.defaultDomain},ri(this.engine.defaultDomain))),this._name=this._def.name):this._def=void 0}get value(){var e;return(e=this._def)==null?void 0:e.value}set value(e){var n,r;if(this._name[0]==="_")throw Error(`The value of the wildcard "${this._name}" cannot be changed`);let i;if(this.engine.forget(this._name),e!==void 0){const s=this.engine.box(e);i=(n=s.value)!=null?n:s.evaluate()}this._def?this._def.value=i:this._def=this.engine.defineSymbol({name:this._name,value:i,domain:(r=this.engine.defaultDomain)!=null?r:this.engine.domain("Anything")})}get numericValue(){var e,i;return(i=(e=this._def)==null?void 0:e.value)==null?void 0:i.numericValue}get domain(){var e,i,n;return typeof((e=this._def)==null?void 0:e.domain)=="function"?this.engine.domain(this._def.domain(this.engine,[])):(n=(i=this._def)==null?void 0:i.domain)!=null?n:this.engine.domain("Anything")}set domain(e){if(this._name[0]==="_")throw Error(`The domain of the wildcard "${this._name}" cannot be changed`);this._def?this._def.domain=e:this._def=this.engine.defineSymbol(z({name:this._name,domain:e},ri(e)))}get json(){return at(this.engine,this._name,{wikidata:this._wikidata})}get sgn(){var i,n,r,s;const e=(i=this.value)==null?void 0:i.sgn;return e!==void 0?e:((n=this._def)==null?void 0:n.zero)===!0?0:((r=this._def)==null?void 0:r.positive)===!0?1:((s=this._def)==null?void 0:s.negative)===!0?-1:void 0}has(e){return typeof e=="string"?this._name===e:e.includes(this._name)}isSame(e){return e instanceof oi&&this._name===e._name}match(e,i){return e instanceof oi&&this._name===e._name?{}:null}isEqual(e){var n;if(this===e)return!0;if(e.symbol!==null)return e.symbol===this._name;const i=(n=this._def)==null?void 0:n.value;if(i)return i.isEqual(e);if(e.isZero){if(this.isZero)return!0;if(this.isNotZero)return!1}return this.isZero&&e.isNotZero||this.engine.ask(["NotEqual",this,e]).length,!1}isLess(e){if(e.symbol!==null&&e.symbol===this._name)return!1;if(e.isZero){const i=this.sgn;if(i===null)return!1;if(i!==void 0)return i<0}}isLessEqual(e){if(e.symbol!==null&&e.symbol===this._name)return!0;if(e.isZero){const i=this.sgn;if(i===null)return!1;if(i!==void 0)return i<=0}return this.isLess(e)||this.isEqual(e)}isGreater(e){if(e.symbol!==null&&e.symbol===this._name)return!1;if(e.isZero){const i=this.sgn;if(i===null)return!1;if(i!==void 0)return i>0}}isGreaterEqual(e){if(e.symbol!==null&&e.symbol===this._name)return!0;if(e.isZero){const i=this.sgn;if(i===null)return!1;if(i!==void 0)return i>=0}return this.isGreater(e)||this.isEqual(e)}get isZero(){var e,i,n,r;return(r=(e=this._def)==null?void 0:e.zero)!=null?r:(n=(i=this._def)==null?void 0:i.value)==null?void 0:n.isZero}get isNotZero(){var n;const e=(n=this._def)==null?void 0:n.notZero;if(typeof e=="boolean")return e;const i=this.sgn;return typeof i=="number"?i!==0:void 0}get isOne(){var e;return(e=this._def)==null?void 0:e.one}get isNegativeOne(){var e;return(e=this._def)==null?void 0:e.negativeOne}get isOdd(){var e;return(e=this._def)==null?void 0:e.odd}get isEven(){var e;return(e=this._def)==null?void 0:e.even}get isPrime(){var e;return(e=this._def)==null?void 0:e.prime}get isComposite(){var e;return(e=this._def)==null?void 0:e.composite}get isInfinity(){var e;return(e=this._def)==null?void 0:e.infinity}get isNaN(){var e;return(e=this._def)==null?void 0:e.NaN}get isPositive(){var e;return(e=this._def)==null?void 0:e.positive}get isNonPositive(){var e;return(e=this._def)==null?void 0:e.nonPositive}get isNegative(){var e;return(e=this._def)==null?void 0:e.negative}get isNonNegative(){var e;return(e=this._def)==null?void 0:e.nonNegative}get isNumber(){var e;return(e=this._def)==null?void 0:e.number}get isInteger(){var e;return(e=this._def)==null?void 0:e.integer}get isRational(){var e;return(e=this._def)==null?void 0:e.rational}get isAlgebraic(){var e;return(e=this._def)==null?void 0:e.rational}get isReal(){var e;return(e=this._def)==null?void 0:e.real}get isExtendedReal(){var e;return(e=this._def)==null?void 0:e.extendedReal}get isComplex(){var e;return(e=this._def)==null?void 0:e.complex}get isImaginary(){var e;return(e=this._def)==null?void 0:e.imaginary}get canonical(){var e,i,n,r,s,u;return((e=this._def)==null?void 0:e.hold)===!1?(u=(s=(n=(i=this._def)==null?void 0:i.value)==null?void 0:n.value)!=null?s:(r=this._def)==null?void 0:r.value)!=null?u:this:this}simplify(e){var n,r;const i=e!=null&&e.rules?(n=this.replace(e.rules))!=null?n:this:this;if(((r=i.symbolDefinition)==null?void 0:r.hold)===!1){const s=i.value;if(s)return s.simplify(e)}return i}evaluate(e){var i,n,r,s;return((i=this.symbolDefinition)==null?void 0:i.hold)===!0?this:(s=(r=(n=this._def)==null?void 0:n.value)==null?void 0:r.evaluate(e))!=null?s:this}N(e){var n,r,s,u;const i=(n=this._def)==null?void 0:n.value;return(u=(s=(r=i==null?void 0:i.N(e))!=null?r:i==null?void 0:i.evaluate(e))!=null?s:i)!=null?u:this}replace(e,i){return lr(this,e,i)}subs(e){var i;return(i=e[this._name])!=null?i:this}}class qe extends ye{constructor(e,i,n){super(e,n),this._value=i}get domainExpression(){return this._value}get hash(){return this._hash===void 0&&(this._hash=br(this._value)),this._hash}get isCanonical(){return!0}isEqual(e){return!1}isSame(e){return!1}isSubdomainOf(e){return function(i,n){const r=n instanceof qe?n._value:n,s=i instanceof qe?i._value:i;if(typeof s=="string"&&typeof r=="string"){const u=wt(s,r);if(typeof u=="boolean")return u}return!0}(this,e)}isMemberOf(e){return!1}get json(){return typeof this._value=="string"?at(this.engine,this._value,{wikidata:this._wikidata}):["Domain",this._value]}match(e,i){return e instanceof qe&&this.isSame(e)?{}:null}get head(){return"Domain"}get domain(){return this.engine.domain("Domain")}get codomain(){return typeof this._value=="string"||this._value[0]!=="Function"?null:this.engine.domain(this._value[this._value.length-1])}is(e){return this.isSame(e)}get isNothing(){return this._value==="Nothing"}get isFunction(){return typeof this._value!="string"&&this._value[0]==="Function"}get isPredicate(){if(typeof this._value=="string"||this._value[0]!=="Function")return!1;const e=this._value[this._value.length];return e instanceof qe&&e.isBoolean}get isNumericFunction(){if(typeof this._value=="string"||this._value[0]!=="Function")return!1;for(const e of this._value)if(!wt(e,"Number"))return!1;return!0}get isBoolean(){return di(this._value)}get isRealFunction(){if(typeof this._value=="string"||this._value[0]!=="Function")return!1;for(const e of this._value)if(!wt(e,"ExtendedRealNumber"))return!1;return!0}get isNumeric(){return this.isSubdomainOf("Number")}get isLogicOperator(){return!(typeof this._value=="string"||this._value[0]!=="Function"||this._value.length<2||this._value.length>3||!di(this._value[this._value.length-1])||!di(this._value[1])||this._value.length===3&&!di(this._value[2]))}get isRelationalOperator(){return typeof this._value!="string"&&this._value[0]==="Function"&&this._value.length===3&&!!di(this._value[this._value.length-1])}}function St(t,e,i){if(e instanceof qe)return e;let n;if(!n&&typeof e=="string"){const r={Function:["Function",["Optional",["Some","Anything"]],"Anything"],NumericFunction:["Function",["Optional",["Some","Number"]],"Number"],RealFunction:["Function",["Optional",["Some","ExtendedRealNumber"]],"ExtendedRealNumber"],TrigonometricFunction:["Function","Number","Number"],HyperbolicFunction:["Function","Number","Number"],LogicOperator:["Function","MaybeBoolean",["Optional","MaybeBoolean"],"MaybeBoolean"],Predicate:["Function",["Optional",["Some","Anything"]],"MaybeBoolean"],RelationalOperator:["Function","Anything","Anything","MaybeBoolean"]}[e];r&&(n=new qe(t,r,i))}return n||(n=new qe(t,e,i)),n}function wt(t,e){var i,n;return typeof t=="string"&&((n=(i={Number:["Number","ExtendedComplexNumber","ExtendedRealNumber","ComplexNumber","ImaginaryNumber","RealNumber","TranscendentalNumber","AlgebraicNumber","RationalNumber","Integer","NegativeInteger","NegativeNumber","NonNegativeNumber","NonNegativeInteger","NonPositiveNumber","NonPositiveInteger","PositiveInteger","PositiveNumber"],ExtendedComplexNumber:["Number","ExtendedRealNumber","ComplexNumber","ImaginaryNumber","RealNumber","TranscendentalNumber","AlgebraicNumber","RationalNumber","Integer","NegativeInteger","NegativeNumber","NonNegativeNumber","NonNegativeInteger","NonPositiveNumber","NonPositiveInteger","PositiveInteger","PositiveNumber"],ExtendedRealNumber:["ExtendedRealNumber","RealNumber","TranscendentalNumber","AlgebraicNumber","RationalNumber","Integer","NegativeInteger","NegativeNumber","NonNegativeNumber","NonNegativeInteger","NonPositiveNumber","NonPositiveInteger","PositiveInteger","PositiveNumber"],ComplexNumber:["ComplexNumber","ImaginaryNumber"],ImaginaryNumber:["ImaginaryNumber"],RealNumber:["RealNumber","TranscendentalNumber","AlgebraicNumber","RationalNumber","Integer","NegativeInteger","NegativeNumber","NonNegativeNumber","NonNegativeInteger","NonPositiveNumber","NonPositiveInteger","PositiveInteger","PositiveNumber"],TranscendentalNumber:["TranscendentalNumber"],AlgebraicNumber:["AlgebraicNumber","RationalNumber","Integer","NegativeInteger","NonNegativeInteger","NonPositiveInteger","PositiveInteger"],RationalNumber:["RationalNumber","Integer","NegativeInteger","NonNegativeInteger","NonPositiveInteger","PositiveInteger"],Integer:["Integer","NegativeInteger","NonNegativeInteger","NonPositiveInteger","PositiveInteger"],NegativeNumber:["NegativeNumber","NegativeInteger"],NonNegativeNumber:["NonNegativeNumber","PositiveNumber","NonNegativeInteger","PositiveInteger"],NonPositiveNumber:["NonPositiveNumber","NegativeNumber","NegativeInteger"],PositiveNumber:["PositiveNumber","PositiveInteger"],NegativeInteger:["NegativeInteger"],PositiveInteger:["PositiveInteger"],NonNegativeInteger:["NonNegativeInteger","PositiveInteger"],NonPositiveInteger:["NegativeInteger"]}[e])==null?void 0:i.includes(t))!=null?n:void 0)}function di(t){return typeof t=="string"&&["Boolean","MaybeBoolean","True","False","Maybe"].includes(t)}function br(t){if(typeof t=="string")return be("domain:"+t);let e="";for(const i of t)e+=""+br(i);return be(e)}class Qt{constructor(e){var n,r,s,u,o;this._cache={},this._commonSymbols={True:null,False:null,Maybe:null,All:null,Missing:null,Nothing:null,None:null,Undefined:null,Pi:null,ImaginaryUnit:null},this._commonNumbers={0:null,1:null,2:null,3:null,4:null,5:null,6:null,7:null,8:null,9:null,10:null},this._commonDomains={Anything:null,Nothing:null,Boolean:null,MaybeBoolean:null,String:null,Domain:null,Symbol:null,Integer:null,RationalNumber:null,AlgebraicNumber:null,RealNumber:null,ExtendedRealNumber:null,ImaginaryNumber:null,ComplexNumber:null,ExtendedComplexNumber:null,Number:null,PositiveInteger:null,TranscendentalNumber:null,PositiveNumber:null,Function:null,NumericFunction:null,RealFunction:null,TrigonometricFunction:null,HyperbolicFunction:null,LogicOperator:null,Predicate:null,RelationalOperator:null,Expression:null,BooleanExpression:null,NumericExpression:null},this._latexDictionary=e==null?void 0:e.latexDictionary,this._jsonSerializationOptions={exclude:[],shorthands:["function","symbol","string","dictionary","number"],metadata:[],repeatingDecimal:!0},this._stats={highwaterMark:0,symbols:new Set,expressions:new Set},this._defaultDomain=null,this._numericMode=(n=e==null?void 0:e.numericMode)!=null?n:"auto",this._precision=Math.max((r=e==null?void 0:e.numericPrecision)!=null?r:100,Math.floor(yi)),this._decimal=Q.exports.Decimal.clone({precision:this._precision}),this.decimal=a=>new this._decimal(a),this.complex=(a,l)=>new B.exports.Complex(a,l),this.tolerance=(s=e==null?void 0:e.tolerance)!=null?s:1e-10,this.ZERO=new J(this,0),this.ONE=new J(this,1),this.TWO=new J(this,2),this.HALF=new J(this,[1,2]),this.NEGATIVE_ONE=new J(this,-1),this.I=new J(this,B.exports.Complex.I),this.NAN=new J(this,NaN),this.POSITIVE_INFINITY=new J(this,1/0),this.NEGATIVE_INFINITY=new J(this,-1/0),this.COMPLEX_INFINITY=new J(this,B.exports.Complex.INFINITY),this.purge();const i=(u=e==null?void 0:e.dictionaries)!=null?u:Qt.getDictionaries();this.pushScope({dictionary:i,scope:{warn:a=>{for(const l of a)l.message},timeLimit:2,memoryLimit:1,recursionLimit:1024}}),(e==null?void 0:e.assumptions)===null?this.pushScope():this.pushScope({assumptions:e==null?void 0:e.assumptions});for(const a of Object.keys(this._commonDomains))this._commonDomains[a]&&!this._commonDomains[a].symbolDefinition&&this._commonDomains[a]._repairDefinition();for(const a of Object.keys(this._commonSymbols))this._commonSymbols[a]&&!this._commonSymbols[a].symbolDefinition&&this._commonSymbols[a]._repairDefinition();this._defaultDomain=(e==null?void 0:e.defaultDomain)===null?null:this.domain((o=e==null?void 0:e.defaultDomain)!=null?o:"ExtendedRealNumber")}static getDictionaries(e="all"){return pr(e)}purge(){var r,s;this.DECIMAL_NEGATIVE_ONE=this.decimal(-1),this.DECIMAL_NAN=this.decimal(NaN),this.DECIMAL_ZERO=this.decimal(0),this.DECIMAL_ONE=this.decimal(1),this.DECIMAL_TWO=this.decimal(2),this.DECIMAL_HALF=this.DECIMAL_ONE.div(this.DECIMAL_TWO),this.DECIMAL_PI=this.DECIMAL_NEGATIVE_ONE.acos();const e=this._stats.symbols.values(),i=this._stats.expressions.values();this._stats.symbols=new Set,this._stats.expressions=new Set;for(const u of e)u._purge();for(const u of i)u._purge();for(const u of Object.values(this._commonDomains))u==null||u._purge();for(const u of Object.values(this._commonSymbols))u==null||u._purge();let n=this.context;for(;n;){if((r=n.dictionary)!=null&&r.functions)for(const[u,o]of n.dictionary.functions)for(const a of o)a._purge();if((s=n.dictionary)!=null&&s.symbols)for(const[u,o]of n.dictionary.symbols)o._purge();n=n.parentScope}for(const u of Object.keys(this._cache))this._cache[u].value&&(this._cache[u].purge?this._cache[u].value=this._cache[u].purge(this._cache[u].value):delete this._cache[u])}_register(e){this._stats.highwaterMark+=1}_unregister(e){}get stats(){const e=this._stats.expressions;return this._stats.expressions=null,this._stats.expressions=e,z({},this._stats)}get precision(){return this._precision}set precision(e){const i=this._precision;e==="machine"&&(e=Math.floor(yi)),e!==i&&(this._latexSyntax&&this.latexSyntax.updateOptions({precision:e,avoidExponentsInRange:[-6,e]}),this._precision=Math.max(e,Math.floor(yi)),this._decimal=this._decimal.config({precision:this._precision}),this.purge())}get numericMode(){return this._numericMode}set numericMode(e){e!==this._numericMode&&(this._numericMode=e,e!=="complex"&&e!=="machine"||(this._precision=Math.floor(yi)),this._latexSyntax&&this.latexSyntax.options.precision>this._precision&&this.latexSyntax.updateOptions({precision:this._precision}),this.purge())}get timeLimit(){let e=this.context;for(;e;){if(e.timeLimit!==void 0)return e.timeLimit;e=e.parentScope}return 2}get iterationLimit(){let e=this.context;for(;e;){if(e.iterationLimit!==void 0)return e.iterationLimit;e=e.parentScope}return 1024}get recursionLimit(){let e=this.context;for(;e;){if(e.recursionLimit!==void 0)return e.recursionLimit;e=e.parentScope}return 1024}get defaultDomain(){return this._defaultDomain}set defaultDomain(e){this._defaultDomain=e===null?null:this.domain(e)}get tolerance(){return this._tolerance}set tolerance(e){this._tolerance=typeof e=="number"&&Number.isFinite(e)?Math.max(e,0):1e-10,this._decimalTolerance=this.decimal(this._tolerance)}chop(e){return typeof e=="number"&&Math.abs(e)<=this._tolerance||e instanceof Q.exports.Decimal&&e.abs().lte(this._decimalTolerance)||e instanceof B.exports.Complex&&Math.abs(e.re)<=this._tolerance&&Math.abs(e.im)<=this._tolerance?0:e}get latexSyntax(){return this._latexSyntax||(this._latexSyntax=new Ji({computeEngine:this,dictionary:this._latexDictionary,precision:this.precision,avoidExponentsInRange:[-6,this.precision],onError:e=>{throw Error(e[0].message.toString())}})),this._latexSyntax}static getLatexDictionary(e="all"){return Ji.getDictionary(e)}set costFunction(e){typeof e!="function"&&(this._cost=Dn),this._cost=e}get costFunction(){var e;return(e=this._cost)!=null?e:Dn}getSymbolDefinition(e,i){var s,u,o;let n,r=this.context;if(i)for(;r&&!n;)n=(s=r.dictionary)==null?void 0:s.symbolWikidata.get(i),r=r.parentScope;for(;r&&!n;)i&&(n=(u=r.dictionary)==null?void 0:u.symbolWikidata.get(i)),n||(n=(o=r.dictionary)==null?void 0:o.symbols.get(e)),r=r.parentScope;return n}getFunctionDefinition(e,i){var s,u;if(!i){let o=this.context;for(;o;){const a=(s=o.dictionary)==null?void 0:s.functions.get(e);if(a)return a[0];o=o.parentScope}return}const n=this.domain(["Function",...i==null?void 0:i.map(o=>o.domain.json)]);let r=this.context;for(;r;){const o=(u=r.dictionary)==null?void 0:u.functions.get(e);if(o){for(const a of o)if(a.domain){if(typeof a.domain=="function"){const l=this.domain(a.domain(this,i));if(l&&n.isSubdomainOf(l))return a}else if(n.isSubdomainOf(a.domain))return a}}r=r.parentScope}}defineSymbol(e){const i=new gr(this,e);return this.context.dictionary||(this.context.dictionary={symbols:new Map,functions:new Map,symbolWikidata:new Map,functionWikidata:new Map}),e.name&&this.context.dictionary.symbols.set(e.name,i),e.wikidata&&this.context.dictionary.symbolWikidata.set(e.wikidata,i),i}pushScope(e){var i;if(this.context=ee(z({},e==null?void 0:e.scope),{parentScope:this.context,assumptions:this.context?new _i(this.context.assumptions):new _i}),dr(this,e==null?void 0:e.dictionary),(e==null?void 0:e.assumptions)!==void 0)for(const n of e.assumptions)this.assume((i=this.parse(xi(n)))!=null?i:n)}popScope(){var i;const e=(i=this.context)==null?void 0:i.parentScope;if(this.context.warnings){const n=[...this.context.warnings];this.context.warnings=[],this.context.warn&&this.context.warn(n)}e&&this.context.warnings&&this.context.warnings.length>0&&(e.warnings?e.warnings=[...e.warnings,...this.context.warnings]:e.warnings=[...this.context.warnings]),this.context=e}get assumptions(){return this.context.assumptions||(this.context.assumptions=new _i),this.context.assumptions}shouldContinueExecution(){return this.deadline===void 0||this.deadline>=Date.now()}checkContinueExecution(){if(!this.shouldContinueExecution())throw Error("timeout")}assert(e,i,n,r){e||this.signal(i,n,r)}signal(e,i,n){typeof e=="object"&&"message"in e?n=e.message:e.latex,n===void 0||typeof n=="string"||Array.isArray(n)&&n.map(r=>r.toString()).join(", ")}cache(e,i,n){var r;if(this._cache[e]===void 0)try{this._cache[e]={build:i,purge:n,value:i()}}catch{}return(r=this._cache[e])==null?void 0:r.value}box(e){return ge(this,e)}fn(e,i,n){var r,s,u,o,a,l,h,d,y;if(e==="Hold")return this._fn("Hold",i,n);if(i=i.map(N=>N.canonical),e==="String")return this.string(i.map(N=>{var x;return(x=N.string)!=null?x:N.latex}).join(""),n);if(e==="Symbol")return this.symbol(i.map(N=>{var x;return(x=N.string)!=null?x:N.latex}).join(""),n);if((e==="Divide"||e==="Rational")&&i.length===2){const N=i[0].asSmallInteger,x=i[1].asSmallInteger;if(N!==null&&x!==null&&Number.isInteger(N)&&Number.isInteger(x))return this.number([N,x])}if(e==="Number"){if(i.length===1){const N=i[0],x=(s=(r=N.decimalValue)!=null?r:N.complexValue)!=null?s:N.machineValue;if(x!==null)return this.number(x);const[k,M]=N.rationalValue;if(k!==null&&M!==null)return this.number([k,M])}return this.NAN}if(e==="Complex"){if(i.length===1){const N=i[0].asFloat;return N!==null?this.number(this.complex(0,N)):this.mul([i[0],this.I])}if(i.length===2){const N=i[0].asFloat,x=i[1].asFloat;return N!==null&&x!==null&&this.number(this.complex(N,x)),x===0?i[0]:this.add([i[0],this.mul([i[1],this.I])],n)}}if(e==="Negate"&&i.length===1)return se((u=i[0])!=null?u:this.symbol("Missing"),n);if(e==="Single"||e==="Pair"||e==="Triple"||e==="KeyValuePair")return this.tuple(i,n);if(e==="Dictionary"){const N={};for(const x of i)if(x.head==="Tuple"){const k=x.op1;if(!k.isMissing){x.op2;let M=(o=k.symbol)!=null?o:k.string;if(!M&&k.isLiteral){const P=(a=k.machineValue)!=null?a:k.asSmallInteger;P&&Number.isFinite(P)&&Number.isInteger(P)&&(M=P.toString())}M&&N[M]}}return new _e(this,N,n)}return e==="Add"?this.add(i,n):e==="Multiply"?this.mul(i,n):e==="Divide"?this.divide((l=i[0])!=null?l:this.symbol("Missing"),(h=i[1])!=null?h:this.symbol("Missing"),n):e==="Power"?this.power((d=i[0])!=null?d:this.symbol("Missing"),(y=i[1])!=null?y:this.symbol("Missing"),n):new Ve(this,e,i,n).canonical}_fn(e,i,n){const r=new Ve(this,e,i,n);return r.isCanonical=!0,r}error(e,i,n){return this._fn("Error",[e,this.string(i),this.box(n)])}add(e,i){const n=Rt(this,e);return i!=null&&i.latex&&(n.latex=i.latex),i!=null&&i.wikidata&&(n.wikidata=i.wikidata),n}mul(e,i){const n=hr(this,e);return i!=null&&i.latex&&(n.latex=i.latex),i!=null&&i.wikidata&&(n.wikidata=i.wikidata),n}power(e,i,n){var s;let r=null;if(typeof i=="number"?r=i:Array.isArray(i)&&i[1]===1&&(r=i[0]),r===1)return e;if(r===-1&&e.isLiteral){const[u,o]=e.rationalValue;if(u!==null&&o!==null)return this.number([o,u]);const a=e.asSmallInteger;if(a!==null)return this.number([1,a])}return(typeof i=="number"||Array.isArray(i))&&(i=this.number(i)),(s=ni(this,e,i,n))!=null?s:this._fn("Power",[e,i],n)}inverse(e,i){var r;let n=this.NEGATIVE_ONE;if(e.head==="Power"){if(e.op2.isNegativeOne)return e.op1;n=se(e.op2),e=e.op1}return(r=ni(this,e,n,i))!=null?r:this._fn("Power",[e,n],i)}negate(e,i){return se(e,i)}divide(e,i,n){const r=zt(this,e,i);return n!=null&&n.latex&&(r.latex=n.latex),n!=null&&n.wikidata&&(r.wikidata=n.wikidata),r}pair(e,i,n){return this._fn("Tuple",[e,i],n)}tuple(e,i){return this._fn("Tuple",e,i)}string(e,i){return new Re(this,e,i)}symbol(e,i){if(e==="Infinity")return this.POSITIVE_INFINITY;if(e==="+Infinity")return this.POSITIVE_INFINITY;if(e==="-Infinity")return this.NEGATIVE_INFINITY;if(e==="Half")return this.HALF;let n=this._commonSymbols[e];return n?(i==null?void 0:i.wikidata)&&n.wikidata&&n.wikidata!==i.wikidata?new oi(this,e,i):n:n===null?(n=new oi(this,e),this._commonSymbols[e]=n,n):new oi(this,e,i)}domain(e,i){return e instanceof qe?e:(e instanceof ye&&e.symbol&&(e=e.symbol),typeof e=="string"&&(this._commonDomains[e]===null&&(this._commonDomains[e]=St(this,e,i)),this._commonDomains[e]&&this._commonDomains[e]),e instanceof ye?St(this,"Anything"):St(this,e,i))}number(e,i){var n,r;if(Array.isArray(e)&&e[1]===1&&(e=e[0]),typeof e=="number"){if(e===-1)return this.NEGATIVE_ONE;if(this._commonNumbers[e]===null&&(this._commonNumbers[e]=(n=En(this,e))!=null?n:null),this._commonNumbers[e])return this._commonNumbers[e]}return(r=En(this,e,i))!=null?r:this.NAN}rules(e){return or(this,e)}pattern(e){return new Si(this,e)}parse(e){var i;return e===null?null:this.box(this.latexSyntax.parse((i=xi(e))!=null?i:e))}serialize(e){return typeof e=="object"&&"json"in e?this.latexSyntax.serialize(e.json):this.latexSyntax.serialize(e)}get latexOptions(){return z(z({},this.latexSyntax.options),this.latexSyntax.serializer.options)}set latexOptions(e){this.latexSyntax.updateOptions(e)}get jsonSerializationOptions(){return this._jsonSerializationOptions}set jsonSerializationOptions(e){e.exclude&&(this._jsonSerializationOptions.exclude=[...e.exclude]),e.shorthands&&(e.shorthands==="all"||e.shorthands.includes("all")?this._jsonSerializationOptions.shorthands=["function","symbol","string","dictionary","number"]:this._jsonSerializationOptions.shorthands=[...e.shorthands]),e.metadata&&(e.metadata==="all"||e.metadata.includes("all")?this._jsonSerializationOptions.metadata=["latex","wikidata"]:this._jsonSerializationOptions.metadata=[...e.metadata])}ask(e){const i=this.pattern(e),n=[];for(const[r,s]of this.assumptions){const u=i.match(r,{numericTolerance:this._tolerance});u!==null&&s===!0&&n.push(u)}return n}assume(e,i){try{const n=xi(e);let r=n?this.parse(n):this.box(e);return i&&(r=this.box(["Element",e,this.domain(i)])),"not-a-predicate"}catch{return"internal-error"}}forget(e){var i;if(e!==void 0){if(Array.isArray(e))for(const n of e)this.forget(n);else if(typeof e=="string"){(i=this.context.dictionary)==null||i.symbols.delete(e);for(const[n,r]of this.assumptions)Ii(n).includes(e)&&this.assumptions.delete(n)}}else this.assumptions.clear()}}const ta="0.6.0";var na=Object.freeze(Object.defineProperty({__proto__:null,ComputeEngine:Qt,getVars:Ii,isEnvironmentEntry:Wn,isInfixEntry:ji,isMatchfixEntry:Zi,isPostfixEntry:At,isPrefixEntry:It,isSymbolEntry:kt,version:ta},Symbol.toStringTag,{value:"Module"}));const Ae=ps([]);function ra(t){let e,i,n,r,s,u,o,a,l,h;function d(k){t[6](k)}function y(k){t[8](k)}let N={class:"p-2 bg-transparent",noBorderOutline:!0,config:{autoCommands:"theta sqrt sum pi prod",autoOperatorNames:"sin cos tan arcsin arccos arctan"}};t[0].focused!==void 0&&(N.focused=t[0].focused),t[0].content!==void 0&&(N.latex=t[0].content),i=new vs({props:N}),Fe.push(()=>si(i,"focused",d)),t[7](i),Fe.push(()=>si(i,"latex",y)),i.$on("deleteOutOf",t[9]),i.$on("outOfOnly",t[10]),i.$on("enter",t[11]);let x=t[0].content&&t[0].result&&Ln(t);return{c(){e=we("div"),Gi(i.$$.fragment),s=we("br"),u=$t(),x&&x.c(),this.h()},l(k){e=Ee(k,"DIV",{class:!0});var M=ze(e);Hi(i.$$.fragment,M),s=Ee(M,"BR",{}),u=Zt(M),x&&x.l(M),M.forEach(ue),this.h()},h(){de(e,"class",o="mb-4 p-2 border border-black ring-blue-700 rounded-md "+(t[0].focused?"ring":""))},m(k,M){je(k,e,M),Bi(i,e,null),Pe(e,s),Pe(e,u),x&&x.m(e,null),a=!0,l||(h=wi(e,"click",function(){var P,I;hs((P=t[0].element)==null?void 0:P.focus())&&((I=t[0].element)==null||I.focus().apply(this,arguments))}),l=!0)},p(k,M){t=k;const P={};!n&&M&1&&(n=!0,P.focused=t[0].focused,ai(()=>n=!1)),!r&&M&1&&(r=!0,P.latex=t[0].content,ai(()=>r=!1)),i.$set(P),t[0].content&&t[0].result?x?(x.p(t,M),M&1&&he(x,1)):(x=Ln(t),x.c(),he(x,1),x.m(e,null)):x&&(rt(),ve(x,1,1,()=>{x=null}),st()),(!a||M&1&&o!==(o="mb-4 p-2 border border-black ring-blue-700 rounded-md "+(t[0].focused?"ring":"")))&&de(e,"class",o)},i(k){a||(he(i.$$.fragment,k),he(x),a=!0)},o(k){ve(i.$$.fragment,k),ve(x),a=!1},d(k){k&&ue(e),t[7](null),Wi(i),x&&x.d(),l=!1,h()}}}function sa(t){let e,i,n;return{c(){e=we("input"),this.h()},l(r){e=Ee(r,"INPUT",{placeholder:!0}),this.h()},h(){de(e,"placeholder","Enter text...")},m(r,s){je(r,e,s),Ui(e,t[0].content),i||(n=wi(e,"input",t[5]),i=!0)},p(r,s){s&1&&e.value!==r[0].content&&Ui(e,r[0].content)},i:li,o:li,d(r){r&&ue(e),i=!1,n()}}}function Ln(t){let e,i,n,r,s;i=new ln({props:{latex:"="}});function u(a){t[12](a)}let o={};return t[0].result!==void 0&&(o.latex=t[0].result),n=new ln({props:o}),Fe.push(()=>si(n,"latex",u)),{c(){e=we("div"),Gi(i.$$.fragment),Gi(n.$$.fragment),this.h()},l(a){e=Ee(a,"DIV",{class:!0});var l=ze(e);Hi(i.$$.fragment,l),Hi(n.$$.fragment,l),l.forEach(ue),this.h()},h(){de(e,"class","inline-block p-2 bg-gray-100 rounded-sm m-2")},m(a,l){je(a,e,l),Bi(i,e,null),Bi(n,e,null),s=!0},p(a,l){const h={};!r&&l&1&&(r=!0,h.latex=a[0].result,ai(()=>r=!1)),n.$set(h)},i(a){s||(he(i.$$.fragment,a),he(n.$$.fragment,a),s=!0)},o(a){ve(i.$$.fragment,a),ve(n.$$.fragment,a),s=!1},d(a){a&&ue(e),Wi(i),Wi(n)}}}function aa(t){let e,i,n,r;const s=[sa,ra],u=[];function o(a,l){return a[0].type=="text"?0:a[0].type=="math"?1:-1}return~(e=o(t))&&(i=u[e]=s[e](t)),{c(){i&&i.c(),n=on()},l(a){i&&i.l(a),n=on()},m(a,l){~e&&u[e].m(a,l),je(a,n,l),r=!0},p(a,[l]){let h=e;e=o(a),e===h?~e&&u[e].p(a,l):(i&&(rt(),ve(u[h],1,1,()=>{u[h]=null}),st()),~e?(i=u[e],i?i.p(a,l):(i=u[e]=s[e](a),i.c()),he(i,1),i.m(n.parentNode,n)):i=null)},i(a){r||(he(i),r=!0)},o(a){ve(i),r=!1},d(a){~e&&u[e].d(a),a&&ue(n)}}}function oa(t,e,i){let n;Hn(t,Ae,I=>i(3,n=I));const{ComputeEngine:r}=na,s=new r;let{section:u}=e,{piece:o}=e,{pieces:a}=e,{pieceIndex:l}=e;function h(){o.content=this.value,i(0,o)}function d(I){t.$$.not_equal(o.focused,I)&&(o.focused=I,i(0,o))}function y(I){Fe[I?"unshift":"push"](()=>{o.element=I,i(0,o)})}function N(I){t.$$.not_equal(o.content,I)&&(o.content=I,i(0,o))}const x=async()=>{var I;a.length!==1&&(i(1,a=a.filter((D,V)=>l!==V)),Ae.set(n),await Et(),(I=a[Math.max(l-1,0)].element)==null||I.focus())},k=async I=>{var D,V;I.detail=="U"||I.detail=="L"?l===0||(D=a[l-1].element)==null||D.focus():l+1!==a.length&&((V=a[l+1].element)==null||V.focus())},M=async()=>{var I;(a.length===1||a[a.length-1].content)&&i(1,a=[...a,{type:"math",content:""}]),Ae.set(n),await Et(),(I=a[Math.min(l+1,a.length-1)].element)==null||I.focus()};function P(I){t.$$.not_equal(o.result,I)&&(o.result=I,i(0,o))}return t.$$set=I=>{"section"in I&&i(4,u=I.section),"piece"in I&&i(0,o=I.piece),"pieces"in I&&i(1,a=I.pieces),"pieceIndex"in I&&i(2,l=I.pieceIndex)},t.$$.update=()=>{var I;if(t.$$.dirty&1&&o.type=="math"&&o.content)try{const D=s.parse(o.content);i(0,o.result=(I=D.evaluate().simplify().latex)!=null?I:void 0,o)}catch{i(0,o.result="\\text{An unknown error has occured}",o)}},[o,a,l,n,u,h,d,y,N,x,k,M,P]}class la extends it{constructor(e){super(),tt(this,e,oa,aa,nt,{section:4,piece:0,pieces:1,pieceIndex:2})}}function Tn(t,e,i){const n=t.slice();return n[8]=e[i],n[9]=e,n[10]=i,n}function Rn(t,e,i){const n=t.slice();return n[11]=e[i],n[12]=e,n[13]=i,n}function zn(t){let e,i,n,r,s;function u(h){t[5](h,t[8],t[9],t[10])}function o(h){t[6](h,t[11],t[12],t[13])}function a(h){t[7](h,t[8])}let l={pieceIndex:t[13]};return t[8]!==void 0&&(l.section=t[8]),t[11]!==void 0&&(l.piece=t[11]),t[8].pieces!==void 0&&(l.pieces=t[8].pieces),e=new la({props:l}),Fe.push(()=>si(e,"section",u)),Fe.push(()=>si(e,"piece",o)),Fe.push(()=>si(e,"pieces",a)),{c(){Gi(e.$$.fragment)},l(h){Hi(e.$$.fragment,h)},m(h,d){Bi(e,h,d),s=!0},p(h,d){t=h;const y={};!i&&d&1&&(i=!0,y.section=t[8],ai(()=>i=!1)),!n&&d&1&&(n=!0,y.piece=t[11],ai(()=>n=!1)),!r&&d&1&&(r=!0,y.pieces=t[8].pieces,ai(()=>r=!1)),e.$set(y)},i(h){s||(he(e.$$.fragment,h),s=!0)},o(h){ve(e.$$.fragment,h),s=!1},d(h){Wi(e,h)}}}function $n(t){let e,i,n=t[9],r=t[10],s,u,o,a,l,h;const d=()=>t[2](i,n,r),y=()=>t[2](null,n,r);function N(){t[3].call(i,t[9],t[10])}function x(...I){return t[4](t[8],t[10],...I)}let k=t[8].pieces,M=[];for(let I=0;I<k.length;I+=1)M[I]=zn(Rn(t,k,I));const P=I=>ve(M[I],1,1,()=>{M[I]=null});return{c(){e=we("div"),i=we("input"),u=$t(),o=we("div");for(let I=0;I<M.length;I+=1)M[I].c();this.h()},l(I){e=Ee(I,"DIV",{class:!0});var D=ze(e);i=Ee(D,"INPUT",{placeholder:!0,class:!0}),u=Zt(D),o=Ee(D,"DIV",{class:!0});var V=ze(o);for(let C=0;C<M.length;C+=1)M[C].l(V);V.forEach(ue),D.forEach(ue),this.h()},h(){de(i,"placeholder","Section Name"),de(i,"class","text-bold text-lg"),de(o,"class","border-l border-gray-300 p-4 hover:cursor-text"),de(e,"class","block")},m(I,D){je(I,e,D),Pe(e,i),d(),Ui(i,t[8].name),Pe(e,u),Pe(e,o);for(let V=0;V<M.length;V+=1)M[V].m(o,null);a=!0,l||(h=[ms(s=xs.call(null,i)),wi(i,"input",N),wi(i,"keydown",x)],l=!0)},p(I,D){if(t=I,(n!==t[9]||r!==t[10])&&(y(),n=t[9],r=t[10],d()),D&1&&i.value!==t[8].name&&Ui(i,t[8].name),D&1){k=t[8].pieces;let V;for(V=0;V<k.length;V+=1){const C=Rn(t,k,V);M[V]?(M[V].p(C,D),he(M[V],1)):(M[V]=zn(C),M[V].c(),he(M[V],1),M[V].m(o,null))}for(rt(),V=k.length;V<M.length;V+=1)P(V);st()}},i(I){if(!a){for(let D=0;D<k.length;D+=1)he(M[D]);a=!0}},o(I){M=M.filter(Boolean);for(let D=0;D<M.length;D+=1)ve(M[D]);a=!1},d(I){I&&ue(e),y(),Bn(M,I),l=!1,fs(h)}}}function ua(t){let e,i,n,r,s,u,o,a=t[0],l=[];for(let d=0;d<a.length;d+=1)l[d]=$n(Tn(t,a,d));const h=d=>ve(l[d],1,1,()=>{l[d]=null});return{c(){e=we("div");for(let d=0;d<l.length;d+=1)l[d].c();i=$t(),n=we("button"),r=jn("Add Section"),this.h()},l(d){e=Ee(d,"DIV",{class:!0});var y=ze(e);for(let x=0;x<l.length;x+=1)l[x].l(y);i=Zt(y),n=Ee(y,"BUTTON",{class:!0});var N=ze(n);r=Gn(N,"Add Section"),N.forEach(ue),y.forEach(ue),this.h()},h(){de(n,"class","print:hidden mt-4 px-4 py-2 rounded-full border border-black"),de(e,"class","m-8")},m(d,y){je(d,e,y);for(let N=0;N<l.length;N+=1)l[N].m(e,null);Pe(e,i),Pe(e,n),Pe(n,r),s=!0,u||(o=wi(n,"click",t[1]),u=!0)},p(d,[y]){if(y&1){a=d[0];let N;for(N=0;N<a.length;N+=1){const x=Tn(d,a,N);l[N]?(l[N].p(x,y),he(l[N],1)):(l[N]=$n(x),l[N].c(),he(l[N],1),l[N].m(e,i))}for(rt(),N=a.length;N<l.length;N+=1)h(N);st()}},i(d){if(!s){for(let y=0;y<a.length;y+=1)he(l[y]);s=!0}},o(d){l=l.filter(Boolean);for(let y=0;y<l.length;y+=1)ve(l[y]);s=!1},d(d){d&&ue(e),Bn(l,d),u=!1,o()}}}function ca(t,e,i){let n;Hn(t,Ae,d=>i(0,n=d));async function r(){gs(Ae,n=[...n,{name:"New Section",pieces:[{type:"math",content:""}]}],n)}function s(d,y,N){Fe[d?"unshift":"push"](()=>{y[N].title=d,Ae.set(n)})}function u(d,y){d[y].name=this.value,Ae.set(n)}const o=(d,y,N)=>{var x,k;if(N.key=="Enter"||N.key=="ArrowDown")(x=d.pieces[0].element)==null||x.focus();else if(N.key=="ArrowUp"&&y!==0){const M=n[y-1];(k=M.pieces[M.pieces.length-1].element)==null||k.focus()}};function a(d,y,N,x){N[x]=d,Ae.set(n)}function l(d,y,N,x){N[x]=d,Ae.set(n)}function h(d,y){t.$$.not_equal(y.pieces,d)&&(y.pieces=d,Ae.set(n))}return[n,r,s,u,o,a,l,h]}class ga extends it{constructor(e){super(),tt(this,e,ca,ua,nt,{})}}export{ga as default};
